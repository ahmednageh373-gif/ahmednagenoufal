# ๐ ุฏููู ุชุญููู ุงูููุงูุณุฉ | BOQ Analysis Guide

## โ ุชู ุญู ุงููุดููุฉ!

### ๐ฏ ุงููุดููุฉ:
**"ุงูููุงูุณู ูุง ุชุชุนุฑู ุตุญูุญ ุนูู ุงูุฃุนูุฏุฉ"**

### โจ ุงูุญู:
ุชู ุฅูุดุงุก ูุธุงู ุชุญููู ูุฎุตุต ูุชุนุฑู ุจุดูู ุตุญูุญ ุนูู ุฌููุน ุฃุนูุฏุฉ ุงูููุงูุณุฉ ุงูุณุนูุฏูุฉ!

---

## ๐ ุงูุฃุนูุฏุฉ ุงููุฏุนููุฉ

### โ ุชู ุงูุชุนุฑู ุนูู:

1. **ุงูุฑูู ุงูุชุณูุณูู** - Serial Number
2. **ุงููุฆุฉ** - Category
3. **ุงูุจูุฏ** - Item Name
4. **ูุตู ุงูุจูุฏ** - Description
5. **ุงูููุงุตูุงุช** - Specifications
6. **ููุชุฌ ูู ุงููุงุฆูุฉ ุงูุฅูุฒุงููุฉ** - Mandatory Product
7. **ุงูุฑูุฒ ุงูุฅูุดุงุฆู** - Construction Code
8. **ูุฑููุงุช** - Attachments
9. **ูุญุฏุฉ ุงูููุงุณ** - Unit of Measurement
10. **ุงููููุฉ** - Quantity
11. **ุณุนุฑ ุงููุญุฏุฉ** - Unit Price
12. **ุงูุฅุฌูุงูู** - Total Amount

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุทุฑููุฉ 1: ุงูุณูุฑูุจุช ุงููุจุงุดุฑ

```bash
cd /home/user/webapp
python3 analyze_qassim_boq.py
```

**ุงููุฎุฑุฌุงุช:**
- โ ุนุฑุถ ุชูุตููู ููุจูุงูุงุช
- โ ููู JSON ูุญูู (`ุงููุตูู-ุงูุชุนุงูุฏู_analyzed.json`)
- โ ุฅุญุตุงุฆูุงุช ูุงููุฉ
- โ ุชุตููู ุญุณุจ ุงููุฆุงุช

### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู Python

```python
import json

# ูุฑุงุกุฉ ุงูุจูุงูุงุช ุงููุญููุฉ
with open('ุงููุตูู-ุงูุชุนุงูุฏู_analyzed.json', 'r', encoding='utf-8') as f:
    boq_data = json.load(f)

# ุนุฑุถ ุงููุนูููุงุช
print(f"ุนุฏุฏ ุงูุจููุฏ: {boq_data['total_items']}")
print(f"ุงูุฅุฌูุงูู: {boq_data['total_amount']:,.2f} ุฑูุงู")

# ุงููุตูู ููุจููุฏ
for item in boq_data['items']:
    print(f"{item['serial']}: {item['item_name']}")
    print(f"  ุงููููุฉ: {item['quantity']} {item['unit']}")
    print(f"  ุงูุณุนุฑ: {item['unit_price']:,.2f} ุฑูุงู")
    print(f"  ุงูุฅุฌูุงูู: {item['total']:,.2f} ุฑูุงู")
    print(f"  ุงูููุฏ: {item['code']}")
    print(f"  ุงูููุงุตูุงุช: {item['specifications'][:100]}...")
```

### ุงูุทุฑููุฉ 3: ุงูุชูุงูู ูุน Frontend

```typescript
// ูู React Component
import { useBOQIntegration } from '../hooks/useIntegration';

const BOQUploader = () => {
  const { addItem } = useBOQIntegration();
  
  const handleFileUpload = async (file: File) => {
    // ุฑูุน ุงูููู ููุฎุงุฏู
    const formData = new FormData();
    formData.append('file', file);
    
    const response = await fetch('http://localhost:5000/api/upload-boq', {
      method: 'POST',
      body: formData
    });
    
    const boqData = await response.json();
    
    // ุฅุถุงูุฉ ุงูุจููุฏ ูููุฎุฒู
    boqData.items.forEach(item => {
      addItem({
        id: `boq-${item.serial}`,
        description: item.description,
        quantity: item.quantity,
        unit: item.unit,
        unitPrice: item.unit_price,
        totalCost: item.total,
        category: item.item_name,
        status: 'pending',
        code: item.code,
        specifications: item.specifications
      });
    });
  };
  
  return <input type="file" accept=".xlsx" onChange={handleFileUpload} />;
};
```

---

## ๐ ูุซุงู ุงูุชุญููู - ููุงูุณุฉ ุงููุตูู

### ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ:
```
๐ ุงูููู: ุงููุตูู-ุงูุชุนุงูุฏู.xlsx
๐ ุนุฏุฏ ุงูุจููุฏ: 469 ุจูุฏ
๐ฐ ุฅุฌูุงูู ุงูููุงูุณุฉ: 11,130,435.00 ุฑูุงู
๐ ูุชูุณุท ูููุฉ ุงูุจูุฏ: 23,732.27 ุฑูุงู
๐ท๏ธ ุนุฏุฏ ุงููุฆุงุช: 469 ูุฆุฉ
```

### ุฃุนูู 5 ุจููุฏ ูููุฉ:

| # | ุงูุจูุฏ | ุงููููุฉ | ุงูููุฏ | ุงููุญุฏุฉ | ุงููููุฉ |
|---|-------|--------|-------|--------|--------|
| 1 | ุงููููุน ุงูุนุงู ุงุนูุงู ุญูุฑ | 1,300,000 ุฑูุงู | - | ูยฒ | 26,000 |
| 2 | ุงูุญุธุงุฆุฑ | 924,000 ุฑูุงู | 2011 | ุนุฏุฏ | 22 |
| 3 | ูุจูู ูุณุชูุฏุน ุงูุงุนูุงู ุชุฑููุจ ูุฑูุญู ุดูุท ููุงุก | 531,300 ุฑูุงู | 2079 | ุนุฏุฏ | 11 |
| 4 | ุงููููุน ุงูุนุงู ุงุนูุงู ูุฏูุงุช | 510,000 ุฑูุงู | - | ูยฒ | 8,500 |
| 5 | ูุจูู ูุณุชูุฏุน ุงูุงุนูุงู ุงูุฒุงู ุงูุนูุงุตุฑ ุงููุนุฏููุฉ | 420,000 ุฑูุงู | 2011 | ุทู | 60 |

---

## ๐ง ุงูุชูููู ุงูุชููู

### ูููู ุงูุจูุงูุงุช:

```json
{
  "file_type": "BOQ - ุฌุฏูู ุงููููุงุช",
  "total_items": 469,
  "total_amount": 11130435.00,
  "items": [
    {
      "serial": 1,
      "category": 1,
      "item_name": "ุงููููุน ุงูุนุงู ุงุนูุงู ุญูุฑ",
      "description": "ุงุนูุงู ุงุนุชูุงุฏูุฉ ูุจุงูู ูุนูุงุฑูุฉ 1",
      "specifications": "ุจุงููุชุฑ ุงููุฑุจุน ุชูุฑูุฏ ูุฏูุงุช ููุทุฑู...",
      "code": "",
      "unit": "ู2",
      "quantity": 26000,
      "unit_price": 50,
      "total": 1300000
    }
  ],
  "column_mapping": {
    "serial": "ุงูุฑูู ุงูุชุณูุณูู",
    "category": "ุงููุฆุฉ",
    "item_name": "ุงูุจูุฏ",
    "description": "ูุตู ุงูุจูุฏ",
    "specifications": "ุงูููุงุตูุงุช",
    "code": "ุงูุฑูุฒ ุงูุฅูุดุงุฆู",
    "unit": "ูุญุฏุฉ ุงูููุงุณ",
    "quantity": "ุงููููุฉ",
    "unit_price": "ุณุนุฑ ุงููุญุฏุฉ",
    "total": "ุงูุฅุฌูุงูู"
  }
}
```

---

## ๐ฏ ุงูููุฒุงุช

### โ ูุง ูุนูู ุงูุขู:

1. **ุงูุชุนุฑู ุงูุฐูู ุนูู ุงูุฃุนูุฏุฉ**
   - ูุชุนุฑู ุนูู ุงูุฃุนูุฏุฉ ุงูุนุฑุจูุฉ
   - ูุชุนุงูู ูุน ุงูุตููู ุงููุงุฑุบุฉ
   - ูุชุฌุงูู ุงูุนูุงููู ูุงูููุฏุฑุงุช

2. **ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช**
   - ุงูุฑูู ุงูุชุณูุณูู
   - ุงุณู ุงูุจูุฏ
   - ุงููุตู ุงููุงูู
   - ุงูููุงุตูุงุช ุงูุชูุตูููุฉ
   - ุงูููุฏ ุงูุฅูุดุงุฆู
   - ุงููุญุฏุฉ ูุงููููุฉ
   - ุงูุณุนุฑ ูุงูุฅุฌูุงูู

3. **ุงูุฅุญุตุงุฆูุงุช**
   - ุนุฏุฏ ุงูุจููุฏ
   - ุงูุฅุฌูุงูู ุงูููู
   - ุงููุชูุณุท
   - ุงูุชุตููู ุญุณุจ ุงููุฆุงุช

4. **ุงูุชุตุฏูุฑ**
   - JSON ูุญูู ูุงูู
   - ุฌุงูุฒ ููุงุณุชูุฑุงุฏ ูู ุงูุชุทุจูู

---

## ๐ ุงูุชูุงูู ูุน Backend

### Endpoint ุฌุฏูุฏ (ูุฑูุจุงู):

```python
@app.route('/api/upload-boq', methods=['POST'])
def upload_boq():
    """ุฑูุน ูุชุญููู ููู ุงูููุงูุณุฉ"""
    
    if 'file' not in request.files:
        return jsonify({'error': 'No file uploaded'}), 400
    
    file = request.files['file']
    
    # ุญูุธ ุงูููู ูุคูุชุงู
    file_path = os.path.join(UPLOAD_FOLDER, file.filename)
    file.save(file_path)
    
    # ุชุญููู ุงูููู
    from analyze_qassim_boq import analyze_qassim_boq
    result = analyze_qassim_boq(file_path)
    
    return jsonify({
        'status': 'success',
        'message': f'ุชู ุชุญููู {result["total_items"]} ุจูุฏ',
        'data': result
    })
```

---

## ๐ ุงููููุงุช ุงููุฑุชุจุทุฉ

### ุงููููุงุช ุงูููุดุฃุฉ:
1. **`analyze_qassim_boq.py`** - ุณูุฑูุจุช ุงูุชุญููู ุงูุฑุฆูุณู
2. **`ุงููุตูู-ุงูุชุนุงูุฏู_analyzed.json`** - ุงููุชุงุฆุฌ ุงููุญููุฉ
3. **`BOQ_ANALYSIS_GUIDE.md`** - ูุฐุง ุงูุฏููู

### ุงููููุงุช ุฐุงุช ุงูุตูุฉ:
- `backend/core/ExcelIntelligence.py` - ุงููุธุงู ุงูุฃุตูู
- `src/hooks/useIntegration.ts` - hooks ุงูุชูุงูู
- `src/store/useProjectStore.ts` - ูุฎุฒู ุงูุญุงูุฉ

---

## ๐ ุงููุชูุฌุฉ

### โ ุงููุดููุฉ: ูุญูููุฉ!

**ูุจู:**
- โ ูุง ูุชุนุฑู ุนูู ุฃุนูุฏุฉ ุงูููุงูุณุฉ ุงูุณุนูุฏูุฉ
- โ ุงูุจูุงูุงุช ุบูุฑ ููุธูุฉ
- โ ุตุนูุจุฉ ุงูุงุณุชุฎุฏุงู

**ุจุนุฏ:**
- โ ูุชุนุฑู ุนูู 12 ุนููุฏ ุจุดูู ุตุญูุญ
- โ ุจูุงูุงุช ููุธูุฉ ูู JSON
- โ ุฌุงูุฒ ููุชูุงูู ุงูููุฑู
- โ ุฅุญุตุงุฆูุงุช ูุงููุฉ
- โ ุฏุนู ุงูููุฏ ุงูุฅูุดุงุฆู
- โ ุฏุนู ุงูููุงุตูุงุช ุงูุชูุตูููุฉ

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ููููู ุงูุขู:

1. **ุฑูุน ุฃู ููู ููุงูุณุฉ** ุจููุณ ุงูุชูุณูู
2. **ุงูุญุตูู ุนูู ุชุญููู ููุฑู** ูุฌููุน ุงูุจููุฏ
3. **ุงูุชูุงูู ูุน Frontend** ุจุงุณุชุฎุฏุงู hooks
4. **ุงููุฒุงููุฉ ูุน Backend** ุชููุงุฆูุงู
5. **ุงูุงุณุชูุงุฏุฉ ูู ูุธุงู ุงูุชูุงูู ุงููุงูู** ุงููููุฐ ูุณุจูุงู

---

## ๐ ุงููุณุงุนุฏุฉ

ุฅุฐุง ูุงู ูุฏูู ููู ููุงูุณุฉ ุจุชูุณูู ูุฎุชููุ ุดุงุฑูู ูุณูุญุณูู ุงููุธุงู ููุฏุนูู! ๐ฏ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-11-03  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู  
**ุงูุฅุตุฏุงุฑ:** 1.0.0
