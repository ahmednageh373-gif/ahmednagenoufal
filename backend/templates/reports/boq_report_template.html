{% extends "base_template.html" %}

{% block content %}

<!-- Executive Summary -->
<div class="section">
    <h2 class="section-title">๐ ุงูููุฎุต ุงูุชูููุฐู</h2>
    
    <div class="card-grid">
        <div class="card">
            <div class="card-icon">๐</div>
            <div class="card-title">ุฅุฌูุงูู ุงูุจููุฏ</div>
            <div class="card-value">{{ total_items }}</div>
            <div class="card-unit">ุจูุฏ</div>
        </div>
        
        <div class="card">
            <div class="card-icon">๐</div>
            <div class="card-title">ุฅุฌูุงูู ุงููููุงุช</div>
            <div class="card-value">{{ total_quantity|round(2) }}</div>
            <div class="card-unit">{{ total_unit }}</div>
        </div>
        
        <div class="card">
            <div class="card-icon">โ</div>
            <div class="card-title">ุจููุฏ ูุชูุงููุฉ SBC</div>
            <div class="card-value">{{ compliant_items }}</div>
            <div class="card-unit">ุจูุฏ</div>
        </div>
        
        <div class="card">
            <div class="card-icon">โ๏ธ</div>
            <div class="card-title">ูุถุงูุง ุญุฑุฌุฉ</div>
            <div class="card-value">{{ critical_issues }}</div>
            <div class="card-unit">ูุถูุฉ</div>
        </div>
    </div>
</div>

<!-- BOQ Items Table -->
<div class="section">
    <h2 class="section-title">๐ ุชูุงุตูู ุงููููุงุช</h2>
    
    <table>
        <thead>
            <tr>
                <th>ุฑูู ุงูุจูุฏ</th>
                <th>ุงููุตู</th>
                <th>ุงููุญุฏุฉ</th>
                <th>ุงููููุฉ ุงููุญุณูุจุฉ</th>
                <th>ุตูุบุฉ ุงูุญุณุงุจ</th>
                <th>ูุฑุฌุน ุงูุฑุณู</th>
            </tr>
        </thead>
        <tbody>
            {% for item in boq_items %}
            <tr>
                <td>{{ item.item_number }}</td>
                <td>{{ item.description }}</td>
                <td>{{ item.unit }}</td>
                <td><strong>{{ item.calculated_quantity|round(2) }}</strong></td>
                <td style="font-family: monospace; font-size: 12px;">{{ item.calculation_formula }}</td>
                <td>{{ item.drawing_ref or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- SBC Compliance -->
{% if validation_results %}
<div class="section">
    <h2 class="section-title">โ๏ธ ุงูุชุญูู ูู ุงูุงูุชุซุงู ูููุฏ ุงูุจูุงุก ุงูุณุนูุฏู (SBC 303)</h2>
    
    <table>
        <thead>
            <tr>
                <th>ุฑูู ุงูุจูุฏ</th>
                <th>ุงููุตู</th>
                <th>ุงููุดููุฉ</th>
                <th>ุงูุฎุทูุฑุฉ</th>
                <th>ููุฏ SBC</th>
            </tr>
        </thead>
        <tbody>
            {% for validation in validation_results %}
            <tr>
                <td>{{ validation.item_number }}</td>
                <td>{{ validation.description }}</td>
                <td>{{ validation.issue }}</td>
                <td>
                    {% if validation.severity == 'critical' %}
                    <span class="status-critical">ุญุฑุฌ</span>
                    {% elif validation.severity == 'warning' %}
                    <span class="status-warning">ุชุญุฐูุฑ</span>
                    {% else %}
                    <span class="status-info">ูุนูููุฉ</span>
                    {% endif %}
                </td>
                <td>{{ validation.sbc_code }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- Categories Breakdown -->
<div class="section">
    <h2 class="section-title">๐ ุชูุฒูุน ุงููููุงุช ุญุณุจ ุงููุฆุฉ</h2>
    
    <table>
        <thead>
            <tr>
                <th>ุงููุฆุฉ</th>
                <th>ุนุฏุฏ ุงูุจููุฏ</th>
                <th>ุฅุฌูุงูู ุงููููุฉ</th>
                <th>ุงููุณุจุฉ</th>
            </tr>
        </thead>
        <tbody>
            {% for category in categories %}
            <tr>
                <td><strong>{{ category.name }}</strong></td>
                <td>{{ category.count }}</td>
                <td>{{ category.total_quantity|round(2) }} {{ category.unit }}</td>
                <td>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="flex: 1; background: #e0e0e0; border-radius: 4px; height: 20px; overflow: hidden;">
                            <div style="width: {{ category.percentage }}%; background: linear-gradient(90deg, #366092, #4a7eb8); height: 100%;"></div>
                        </div>
                        <span>{{ category.percentage|round(1) }}%</span>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- SBC Standards Reference -->
<div class="section">
    <h2 class="section-title">๐ ูุฑุฌุน ูุนุงููุฑ ููุฏ ุงูุจูุงุก ุงูุณุนูุฏู (SBC 303)</h2>
    
    <h3 class="section-subtitle">ููุฉ ุงูุฎุฑุณุงูุฉ ุงูุฏููุง (MPa)</h3>
    <table>
        <thead>
            <tr>
                <th>ุงูุนูุตุฑ ุงูุฅูุดุงุฆู</th>
                <th>ุงูุญุฏ ุงูุฃุฏูู</th>
                <th>ุงูููุตู ุจู</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ุงูุฃุณุงุณุงุช</td>
                <td>25 MPa</td>
                <td>30 MPa</td>
            </tr>
            <tr>
                <td>ุงูุฃุนูุฏุฉ</td>
                <td>30 MPa</td>
                <td>35 MPa</td>
            </tr>
            <tr>
                <td>ุงูููุฑุงุช</td>
                <td>25 MPa</td>
                <td>30 MPa</td>
            </tr>
            <tr>
                <td>ุงูุจูุงุทุงุช</td>
                <td>20 MPa</td>
                <td>25 MPa</td>
            </tr>
        </tbody>
    </table>
    
    <h3 class="section-subtitle">ุงูุฃุจุนุงุฏ ุงูุฏููุง (mm)</h3>
    <table>
        <thead>
            <tr>
                <th>ุงูุนูุตุฑ</th>
                <th>ุงูุจูุนุฏ ุงูุฃุฏูู</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ุณูุงูุฉ ุงูุจูุงุทุงุช</td>
                <td>150 mm</td>
            </tr>
            <tr>
                <td>ุนุฑุถ ุงูููุฑุงุช</td>
                <td>200 mm</td>
            </tr>
            <tr>
                <td>ุนูู ุงูููุฑุงุช</td>
                <td>300 mm</td>
            </tr>
            <tr>
                <td>ุฃุจุนุงุฏ ุงูุฃุนูุฏุฉ</td>
                <td>250 ร 250 mm</td>
            </tr>
            <tr>
                <td>ุณูุงูุฉ ุงูุฌุฏุฑุงู</td>
                <td>150 mm</td>
            </tr>
        </tbody>
    </table>
    
    <h3 class="section-subtitle">ุญุฏูุฏ ุงูุชุณููุญ</h3>
    <ul class="info-list">
        <li><strong>ุงูุญุฏ ุงูุฃุฏูู ูููุทุฑ:</strong> 8 mm</li>
        <li><strong>ุงูุญุฏ ุงูุฃูุตู ูููุทุฑ:</strong> 40 mm</li>
        <li><strong>ุฃูุตู ูุณุงูุฉ ูู ุงูุจูุงุทุงุช:</strong> 300 mm</li>
        <li><strong>ุฃูุตู ูุณุงูุฉ ูู ุงูููุฑุงุช:</strong> 250 mm</li>
        <li><strong>ุฃูุตู ูุณุงูุฉ ูู ุงูุฃุนูุฏุฉ:</strong> 200 mm</li>
    </ul>
</div>

<!-- Recommendations -->
<div class="section">
    <h2 class="section-title">๐ฏ ุงูุชูุตูุงุช</h2>
    
    <ul class="info-list">
        {% if critical_issues > 0 %}
        <li><strong>โ๏ธ ุญุฑุฌ:</strong> ูุนุงูุฌุฉ {{ critical_issues }} ูุถูุฉ ุญุฑุฌุฉ ูู ุงูุงูุชุซุงู ูููุฏ ุงูุจูุงุก ุงูุณุนูุฏู ูุจู ุจุฏุก ุงูุชูููุฐ</li>
        {% endif %}
        
        {% if warnings > 0 %}
        <li><strong>โน๏ธ ุชุญุฐูุฑ:</strong> ูุฑุงุฌุนุฉ {{ warnings }} ุชุญุฐูุฑ ูุงูุชุฃูุฏ ูู ูุทุงุจูุชูุง ูููุนุงููุฑ</li>
        {% endif %}
        
        <li><strong>๐ ุงูุชูุซูู:</strong> ุงูุชุฃูุฏ ูู ุฑุจุท ุฌููุน ุงูุจููุฏ ุจุงูุฑุณููุงุช ุงูููุฏุณูุฉ ุงููุฑุฌุนูุฉ</li>
        <li><strong>๐ ุงููุฑุงุฌุนุฉ:</strong> ูุฑุงุฌุนุฉ ุฏูุฑูุฉ ูููููุงุช ูุน ุชูุฏู ุงูุนูู</li>
        <li><strong>โ ุงูุฌูุฏุฉ:</strong> ุงูุงูุชุฒุงู ุจูุนุงููุฑ SBC 303 ูู ุฌููุน ุฃุนูุงู ุงูุชูููุฐ</li>
        <li><strong>๐ ุงูุชุญุฏูุซ:</strong> ุชุญุฏูุซ ุฌุฏุงูู ุงููููุงุช ุนูุฏ ุฃู ุชุนุฏูู ูู ุงูุฑุณููุงุช</li>
    </ul>
</div>

<!-- Notes -->
<div class="section">
    <h2 class="section-title">๐ ููุงุญุธุงุช</h2>
    
    <ul class="info-list">
        <li><strong>ุงููููุฌูุฉ:</strong> ุชู ุญุณุงุจ ุงููููุงุช ุจูุงุกู ุนูู ุงูุฃุจุนุงุฏ ุงููุณุชุฎุฑุฌุฉ ูู ุฌุฏุงูู ุงููููุงุช ุงูุฃูููุฉ</li>
        <li><strong>ุงููุญุฏุงุช:</strong> ุฌููุน ุงูุฃุจุนุงุฏ ุจุงููุชุฑ (m) ูุง ูู ูุฐูุฑ ุฎูุงู ุฐูู</li>
        <li><strong>ุงูุฏูุฉ:</strong> ุชู ุงุณุชุฎุฏุงู ุฑูููู ุนุดุฑููู ูููููุงุช ุงูููุงุฆูุฉ</li>
        <li><strong>ุงูุชุญูู:</strong> ุฌููุน ุงูุจููุฏ ุชู ุงูุชุญูู ูููุง ุชููุงุฆูุงู ุถุฏ ููุฏ ุงูุจูุงุก ุงูุณุนูุฏู SBC 303</li>
        <li><strong>ุงููุตุฏุฑ:</strong> ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุฑูุฑ ุจูุงุณุทุฉ NOUFAL Engineering System</li>
    </ul>
</div>

{% endblock %}
