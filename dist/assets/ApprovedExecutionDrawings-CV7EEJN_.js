var Q=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var R=(r,i,c)=>i in r?Q(r,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):r[i]=c,b=(r,i)=>{for(var c in i||(i={}))ee.call(i,c)&&R(r,c,i[c]);if(S)for(var c of S(i))te.call(i,c)&&R(r,c,i[c]);return r},j=(r,i)=>X(r,Y(i));var E=(r,i,c)=>new Promise((f,h)=>{var y=x=>{try{g(c.next(x))}catch(u){h(u)}},N=x=>{try{g(c.throw(x))}catch(u){h(u)}},g=x=>x.done?f(x.value):Promise.resolve(x.value).then(y,N);g((c=c.apply(r,i)).next())});import{r as d,j as e}from"./react-vendor-D4cZjflF.js";import{aI as $,U as se,b as P,F as ae,a3 as T,a2 as U,s as D,bk as B,an as re,B as le,b4 as ne,Z as ie,$ as ce,aq as de,ae as oe,a1 as xe,ay as z,ah as I}from"./icons-lib-DeXvYHHd.js";import"./vendor-DhnXlGBj.js";const pe=()=>{const[r,i]=d.useState([]),[c,f]=d.useState("all"),[h,y]=d.useState("grid"),[N,g]=d.useState(!1),[x,u]=d.useState(""),[M,C]=d.useState(!1),F=d.useRef(null),A=d.useRef(null),k=[{id:"all",name:"الكل",icon:B,color:"bg-gray-500"},{id:"architectural",name:"معماري",icon:re,color:"bg-blue-500"},{id:"structural",name:"إنشائي",icon:le,color:"bg-green-500"},{id:"mechanical",name:"ميكانيكا",icon:ne,color:"bg-orange-500"},{id:"electrical",name:"كهرباء",icon:ie,color:"bg-yellow-500"}],q=d.useCallback(t=>{t.preventDefault(),t.stopPropagation(),g(!0)},[]),O=d.useCallback(t=>{t.preventDefault(),t.stopPropagation(),g(!1)},[]),_=d.useCallback(t=>{t.preventDefault(),t.stopPropagation()},[]),V=d.useCallback(t=>{t.preventDefault(),t.stopPropagation(),g(!1);const a=Array.from(t.dataTransfer.files);v(a)},[]),W=t=>{const a=t.toLowerCase();return a.includes("arch")||a.includes("معماري")?"architectural":a.includes("struct")||a.includes("إنشائي")?"structural":a.includes("mech")||a.includes("ميكانيكا")?"mechanical":a.includes("elec")||a.includes("كهرباء")?"electrical":"architectural"},v=t=>{const a=t.filter(l=>{var m;const s=(m=l.name.split(".").pop())==null?void 0:m.toLowerCase();return s==="dwg"||s==="dxf"||s==="pdf"});if(a.length===0){alert("يرجى رفع ملفات AutoCAD (.dwg, .dxf) أو PDF فقط");return}const n=a.map(l=>{var s;return{id:`file_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:l.name,type:(s=l.name.split(".").pop())==null?void 0:s.toLowerCase(),size:l.size,category:W(l.name),file:l,status:"uploading",uploadedAt:new Date}});i(l=>[...n,...l]),n.forEach(l=>G(l))},G=t=>E(null,null,function*(){i(a=>a.map(n=>n.id===t.id?j(b({},n),{status:"processing"}):n));try{yield new Promise(n=>setTimeout(n,3e3));const a={title:t.type==="pdf"?"مخطط تنفيذي - الدور الأرضي":"Ground Floor Layout",description:"مخطط تفصيلي للدور الأرضي يتضمن توزيع الغرف والمرافق الرئيسية",elements:["غرف نوم (4)","صالة رئيسية","مطبخ","حمامات (3)","مدخل رئيسي","مواقف سيارات (2)"],layers:["Walls","Doors","Windows","Furniture","Dimensions","Text","Electrical","Plumbing"],dimensions:{length:15.5,width:12.3,height:3.2},issues:["بعض الأبعاد غير واضحة في الزاوية الشمالية","تعارض محتمل بين أنابيب المياه والكهرباء في منطقة المطبخ","عرض الممر الرئيسي أقل من المطلوب (100 سم بدلاً من 120 سم)"],recommendations:["مراجعة وتوضيح الأبعاد في الزاوية الشمالية","التنسيق بين المعماري والكهروميكانيكي لحل التعارضات","توسيع الممر الرئيسي ليصبح 120 سم","إضافة مخرج طوارئ إضافي حسب كود البناء"],tableData:t.type==="pdf"?[{item:"أعمال الحفر",unit:"م³",quantity:150.5,rate:45,amount:6772.5},{item:"أعمال الخرسانة المسلحة",unit:"م³",quantity:85.3,rate:850,amount:72505},{item:"أعمال البلوك",unit:"م²",quantity:320,rate:65,amount:20800}]:void 0};i(n=>n.map(l=>l.id===t.id?j(b({},l),{status:"completed",analysis:a}):l))}catch(a){i(n=>n.map(l=>l.id===t.id?j(b({},l),{status:"error"}):l))}}),Z=t=>{const a=t.target.files;a&&v(Array.from(a))},H=t=>{const a=t.target.files;a&&v(Array.from(a))},L=t=>{i(a=>a.filter(n=>n.id!==t))},J=()=>{C(!0)},K=()=>{const t=`
تقرير المخططات التنفيذية المعتمدة
====================================
التاريخ: ${new Date().toLocaleDateString("ar-SA")}
عدد المخططات: ${r.length}

المخططات حسب التخصص:
- معماري: ${r.filter(s=>s.category==="architectural").length}
- إنشائي: ${r.filter(s=>s.category==="structural").length}
- ميكانيكا: ${r.filter(s=>s.category==="mechanical").length}
- كهرباء: ${r.filter(s=>s.category==="electrical").length}

${r.map((s,m)=>`
مخطط ${m+1}: ${s.name}
---------------------------
التصنيف: ${s.category==="architectural"?"معماري":s.category==="structural"?"إنشائي":s.category==="mechanical"?"ميكانيكا":"كهرباء"}
النوع: ${s.type.toUpperCase()}
الحجم: ${(s.size/1024/1024).toFixed(2)} MB
الحالة: ${s.status==="completed"?"مكتمل":"قيد المعالجة"}

${s.analysis?`
التحليل:
${s.analysis.description}

العناصر الرئيسية:
${s.analysis.elements.map(o=>`• ${o}`).join(`
`)}

الأبعاد:
- الطول: ${s.analysis.dimensions.length} م
- العرض: ${s.analysis.dimensions.width} م
${s.analysis.dimensions.height?`- الارتفاع: ${s.analysis.dimensions.height} م`:""}

المشاكل:
${s.analysis.issues.map(o=>`⚠️ ${o}`).join(`
`)}

التوصيات:
${s.analysis.recommendations.map(o=>`✓ ${o}`).join(`
`)}

${s.analysis.tableData?`
بيانات الجداول:
${s.analysis.tableData.map(o=>`${o.item}: ${o.quantity} ${o.unit} × ${o.rate} = ${o.amount} ريال`).join(`
`)}
`:""}
`:"التحليل قيد التقدم..."}
`).join(`
==============================
`)}
    `,a=new Blob([t],{type:"text/plain;charset=utf-8"}),n=URL.createObjectURL(a),l=document.createElement("a");l.href=n,l.download=`execution_drawings_report_${Date.now()}.txt`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)},w=r.filter(t=>{const a=c==="all"||t.category===c,n=t.name.toLowerCase().includes(x.toLowerCase());return a&&n}),p={total:r.length,completed:r.filter(t=>t.status==="completed").length,processing:r.filter(t=>t.status==="processing").length,architectural:r.filter(t=>t.category==="architectural").length,structural:r.filter(t=>t.category==="structural").length,mechanical:r.filter(t=>t.category==="mechanical").length,electrical:r.filter(t=>t.category==="electrical").length};return e.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2 flex items-center gap-3",children:[e.jsx($,{className:"w-8 h-8"}),"المخططات التنفيذية المعتمدة"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"رفع وتحليل مخططات AutoCAD و PDF بالذكاء الاصطناعي"})]}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 mb-6 transition-colors ${N?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800"}`,onDragEnter:q,onDragOver:_,onDragLeave:O,onDrop:V,children:e.jsxs("div",{className:"text-center",children:[e.jsx(se,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"اسحب وأفلت الملفات هنا"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"أو انقر لاختيار الملفات (AutoCAD: .dwg, .dxf | PDF)"}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsxs("button",{onClick:()=>{var t;return(t=F.current)==null?void 0:t.click()},className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(P,{className:"w-5 h-5"}),"رفع ملفات"]}),e.jsxs("button",{onClick:()=>{var t;return(t=A.current)==null?void 0:t.click()},className:"flex items-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx($,{className:"w-5 h-5"}),"رفع مجلد كامل"]})]})]})}),e.jsx("input",{ref:F,type:"file",multiple:!0,accept:".dwg,.dxf,.pdf",onChange:Z,className:"hidden"}),e.jsx("input",{ref:A,type:"file",multiple:!0,webkitdirectory:"",directory:"",onChange:H,className:"hidden"}),r.length>0&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"إجمالي المخططات"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:p.total})]}),e.jsx(ae,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"قيد المعالجة"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:p.processing})]}),e.jsx(T,{className:"w-8 h-8 text-yellow-500 animate-spin"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"مكتمل"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p.completed})]}),e.jsx(U,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4",children:e.jsxs("button",{onClick:J,className:"w-full h-full flex flex-col items-center justify-center hover:bg-gray-50 dark:hover:bg-gray-700 rounded transition-colors",children:[e.jsx(D,{className:"w-8 h-8 text-purple-500 mb-1"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"عرض 3D"})]})})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md mb-6 p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(t=>{const a=t.icon,n=t.id==="all"?p.total:p[t.id];return e.jsxs("button",{onClick:()=>f(t.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${c===t.id?`${t.color} text-white`:"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[e.jsx(a,{className:"w-5 h-5"}),e.jsx("span",{children:t.name}),e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded-full text-xs",children:n})]},t.id)})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"بحث...",value:x,onChange:t=>u(t.target.value),className:"pr-10 pl-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{className:"flex gap-1 bg-gray-100 dark:bg-gray-700 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>y("grid"),className:`p-2 rounded ${h==="grid"?"bg-white dark:bg-gray-600 text-blue-600":"text-gray-600 dark:text-gray-400"}`,children:e.jsx(B,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>y("list"),className:`p-2 rounded ${h==="list"?"bg-white dark:bg-gray-600 text-blue-600":"text-gray-600 dark:text-gray-400"}`,children:e.jsx(de,{className:"w-5 h-5"})})]}),r.length>0&&e.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(oe,{className:"w-5 h-5"}),"تحميل التقرير"]})]})]})}),w.length>0?h==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(t=>{var l,s;const a=((l=k.find(m=>m.id===t.category))==null?void 0:l.icon)||P,n=((s=k.find(m=>m.id===t.category))==null?void 0:s.color)||"bg-gray-500";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:`${n} p-4 text-white`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(a,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs font-semibold px-2 py-1 bg-white/20 rounded",children:t.type.toUpperCase()})]}),e.jsx("h3",{className:"font-bold truncate",children:t.name}),e.jsxs("p",{className:"text-xs opacity-90",children:[(t.size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"تحليل مكتمل"})]}),t.status==="processing"&&e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-5 h-5 text-yellow-500 animate-spin"}),e.jsx("span",{className:"text-sm font-medium text-yellow-600",children:"جاري التحليل..."})]}),t.status==="error"&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:"خطأ في التحليل"})]})]}),t.analysis&&e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white mb-1",children:t.analysis.title}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:t.analysis.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:"الأبعاد:"}),e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.analysis.dimensions.length," × ",t.analysis.dimensions.width,t.analysis.dimensions.height&&` × ${t.analysis.dimensions.height}`," م"]})]}),t.analysis.issues.length>0&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 rounded p-2",children:e.jsxs("p",{className:"text-xs font-medium text-red-600 dark:text-red-400 mb-1",children:["⚠️ مشاكل (",t.analysis.issues.length,")"]})})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"عرض"})]}),e.jsx("button",{onClick:()=>L(t.id),className:"flex items-center justify-center gap-2 px-3 py-2 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:e.jsx(I,{className:"w-4 h-4"})})]})]})]},t.id)})}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"الاسم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"التصنيف"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"النوع"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"الحجم"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"الحالة"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"إجراءات"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:w.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:t.category==="architectural"?"معماري":t.category==="structural"?"إنشائي":t.category==="mechanical"?"ميكانيكا":"كهرباء"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:t.type.toUpperCase()}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400",children:[(t.size/1024/1024).toFixed(2)," MB"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${t.status==="completed"?"bg-green-100 text-green-800":t.status==="processing"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status==="completed"?"مكتمل":t.status==="processing"?"قيد المعالجة":"خطأ"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>L(t.id),className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:e.jsx(I,{className:"w-4 h-4"})})]})})]},t.id))})]})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-12 text-center",children:[e.jsx($,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"لا توجد مخططات بعد"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"ابدأ برفع المخططات التنفيذية المعتمدة للحصول على تحليل شامل"})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-6xl h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6"}),"عرض المبنى ثلاثي الأبعاد"]}),e.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:"×"})]}),e.jsx("div",{className:"flex-1 bg-gray-100 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-600 dark:text-gray-400",children:[e.jsx(D,{className:"w-24 h-24 mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-lg font-medium",children:"عرض 3D قيد التطوير"}),e.jsx("p",{className:"text-sm mt-2",children:"سيتم دمج Three.js لعرض تفاعلي ثلاثي الأبعاد"})]})})]})})]})};export{pe as ApprovedExecutionDrawings,pe as default};
