var H=Object.defineProperty,Z=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var R=(p,a,s)=>a in p?H(p,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[a]=s,D=(p,a)=>{for(var s in a||(a={}))K.call(a,s)&&R(p,s,a[s]);if(X)for(var s of X(a))J.call(a,s)&&R(p,s,a[s]);return p},A=(p,a)=>Z(p,z(a));var q=(p,a,s)=>new Promise((n,t)=>{var i=o=>{try{c(s.next(o))}catch(u){t(u)}},l=o=>{try{c(s.throw(o))}catch(u){t(u)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(i,l);c((s=s.apply(p,a)).next())});import{r as w,j as e}from"./react-vendor-ITqvX6Xp.js";import{a0 as Y,a6 as T,as as ee,aT as te,F as se,Q as ae,Z as _,a7 as re,aU as ne,aV as ie,U as le,T as oe,ax as W,a2 as U,a9 as V,D as ce,aI as de}from"./icons-lib-BklrIGsN.js";import"./vendor-8CkhJSGZ.js";class L{static performCPM(a,s){const n=this.cloneActivities(a);this.forwardPass(n,s);const t=this.backwardPass(n),{criticalPath:i,floatAnalysis:l}=this.calculateFloatAndCriticalPath(n),c=this.addDays(s,t),o=n.filter(u=>i.includes(u.id));return{criticalPath:i,projectDuration:t,projectStart:s.toISOString().split("T")[0],projectFinish:c.toISOString().split("T")[0],criticalActivities:o,floatAnalysis:l}}static forwardPass(a,s){const n=this.topologicalSort(a);for(const t of n){let i=s;if(t.dependencies.length>0)for(const c of t.dependencies){const o=a.find(y=>y.id===c.predecessorId);if(!o)continue;let u;switch(c.type){case"FS":u=this.parseDate(o.earlyFinish),u=this.addDays(u,c.lag);break;case"SS":u=this.parseDate(o.earlyStart),u=this.addDays(u,c.lag);break;case"FF":u=this.parseDate(o.earlyFinish),u=this.addDays(u,c.lag-t.duration);break;case"SF":u=this.parseDate(o.earlyStart),u=this.addDays(u,c.lag-t.duration);break;default:u=s}u>i&&(i=u)}const l=this.addDays(i,t.duration);t.earlyStart=i.toISOString().split("T")[0],t.earlyFinish=l.toISOString().split("T")[0],t.startDate=t.earlyStart,t.endDate=t.earlyFinish}}static backwardPass(a){var l;let s=new Date(0);for(const c of a){const o=this.parseDate(c.earlyFinish);o>s&&(s=o)}const n=this.parseDate(a.reduce((c,o)=>o.earlyStart<c?o.earlyStart:c,((l=a[0])==null?void 0:l.earlyStart)||"")),t=Math.ceil((s.getTime()-n.getTime())/(1e3*60*60*24)),i=this.topologicalSort(a).reverse();for(const c of i){let o=s;const u=a.filter(b=>b.dependencies.some(m=>m.predecessorId===c.id));if(u.length>0)for(const b of u){const m=b.dependencies.find(g=>g.predecessorId===c.id);if(!m)continue;let h;switch(m.type){case"FS":h=this.parseDate(b.lateStart),h=this.addDays(h,-m.lag);break;case"SS":h=this.parseDate(b.lateStart),h=this.addDays(h,-m.lag),h=this.addDays(h,-c.duration);break;case"FF":h=this.parseDate(b.lateFinish),h=this.addDays(h,-m.lag);break;case"SF":h=this.parseDate(b.lateFinish),h=this.addDays(h,-m.lag),h=this.addDays(h,-c.duration);break;default:h=s}h<o&&(o=h)}const y=this.addDays(o,-c.duration);c.lateFinish=o.toISOString().split("T")[0],c.lateStart=y.toISOString().split("T")[0]}return t}static calculateFloatAndCriticalPath(a){const s=[],n=[];for(const t of a){const i=this.parseDate(t.lateStart),l=this.parseDate(t.earlyStart),c=Math.round((i.getTime()-l.getTime())/(1e3*60*60*24));let o=c;const u=a.filter(y=>y.dependencies.some(b=>b.predecessorId===t.id));if(u.length>0){const y=Math.min(...u.map(m=>this.parseDate(m.earlyStart).getTime())),b=this.parseDate(t.earlyFinish).getTime();o=Math.round((y-b)/(1e3*60*60*24))}t.totalFloat=c,t.freeFloat=o,t.isCritical=c===0,t.isCritical&&s.push(t.id),n.push({activityId:t.id,totalFloat:c,freeFloat:o})}return{criticalPath:s,floatAnalysis:n}}static topologicalSort(a){const s=[],n=new Set,t=new Set,i=l=>{if(!t.has(l.id)&&!n.has(l.id)){t.add(l.id);for(const c of l.dependencies){const o=a.find(u=>u.id===c.predecessorId);o&&i(o)}t.delete(l.id),n.add(l.id),s.push(l)}};for(const l of a)n.has(l.id)||i(l);return s}static cloneActivities(a){return a.map(s=>D({},s))}static parseDate(a){return a?new Date(a):new Date}static addDays(a,s){const n=new Date(a);return n.setDate(n.getDate()+s),n}static autoGenerateDependencies(a){const s=new Map;for(const n of a){const t=n.wbsCode.split(".").slice(0,-1).join(".");s.has(t)||s.set(t,[]),s.get(t).push(n)}s.forEach(n=>{const t=n.sort((i,l)=>i.wbsCode.localeCompare(l.wbsCode));for(let i=1;i<t.length;i++){const l=t[i],c=t[i-1];l.dependencies.some(o=>o.predecessorId===c.id)||l.dependencies.push({predecessorId:c.id,type:"FS",lag:0}),c.successors.includes(l.id)||c.successors.push(l.id)}}),this.addConstructionLogicDependencies(a)}static addConstructionLogicDependencies(a){const s=[{before:"Formwork",after:"Rebar",type:"FS"},{before:"Rebar",after:"Concrete Pour",type:"FS"},{before:"Concrete Pour",after:"Curing",type:"FS"},{before:"Curing",after:"Formwork Stripping",type:"FS"},{before:"Blockwork",after:"Plastering",type:"FS"},{before:"Plastering",after:"Tiling",type:"FS"},{before:"Plastering",after:"Painting",type:"FS"}];for(const n of s){const t=a.filter(l=>l.name.includes(n.before)||l.description.includes(n.before)),i=a.filter(l=>l.name.includes(n.after)||l.description.includes(n.after));for(const l of t)for(const c of i)(l.boqItemId===c.boqItemId||this.areWBSCodesAdjacent(l.wbsCode,c.wbsCode))&&(c.dependencies.some(o=>o.predecessorId===l.id)||c.dependencies.push({predecessorId:l.id,type:n.type,lag:0}),l.successors.includes(c.id)||l.successors.push(c.id))}}static areWBSCodesAdjacent(a,s){const n=a.split("."),t=s.split(".");return n.slice(0,-1).join(".")===t.slice(0,-1).join(".")}}const E=class E{static checkCompliance(a){const s=[];for(const n of this.codes)for(const t of n.requirements)if(t.applicableActivities.some(l=>a.name.toLowerCase().includes(l.toLowerCase())||a.description.toLowerCase().includes(l.toLowerCase())||a.category.toLowerCase().includes(l.toLowerCase()))){let l=!0,c="";t.minimumDuration&&a.duration<t.minimumDuration&&(l=!1,c=`Duration ${a.duration} days is less than required ${t.minimumDuration} days`),s.push({code:t.ruleId,description:`${t.descriptionAr} | ${t.description}`,minimumDuration:t.minimumDuration,requiredInspections:t.requiredInspections,complianceNotes:c||"Activity meets SBC requirements",isCompliant:l})}return s}static applyComplianceAdjustments(a){for(const s of a){const n=this.checkCompliance(s);s.sbcRequirements=n;for(const t of n)!t.isCompliant&&t.minimumDuration&&s.duration<t.minimumDuration&&(s.duration=t.minimumDuration)}}static getAllCodes(){return this.codes}static getCodeRequirements(a){return this.codes.find(s=>s.code===a)||null}static generateComplianceReport(a){let s=0;const n=[];for(const l of a){const c=l.sbcRequirements||this.checkCompliance(l);c.some(u=>!u.isCompliant)?n.push({activityId:l.id,activityName:l.name,violations:c.filter(u=>!u.isCompliant)}):c.length>0&&s++}const t=s+n.length,i=t>0?s/t*100:100;return{totalActivities:a.length,compliantActivities:s,nonCompliantActivities:n.length,compliancePercentage:i,violations:n}}static getInspectionSchedule(a){const s=[];for(const n of a){const t=n.sbcRequirements||this.checkCompliance(n);for(const i of t)if(i.requiredInspections)for(const l of i.requiredInspections){const c=n.startDate;s.push({activityId:n.id,activityName:n.name,inspectionDate:c,inspectionType:l,sbcReference:i.code})}}return s}};E.codes=[{code:"SBC-301",title:"Concrete Structures",titleAr:"Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø®Ø±Ø³Ø§Ù†ÙŠØ©",requirements:[{ruleId:"SBC-301-7.1",description:"Minimum curing period for concrete: 7 days",descriptionAr:"ÙØªØ±Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©: 7 Ø£ÙŠØ§Ù… ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:7,requiredInspections:["Concrete Strength Test","Curing Verification"],applicableActivities:["Concrete Curing","Curing","Ù…Ø¹Ø§Ù„Ø¬Ø©"],compliance:"Mandatory"},{ruleId:"SBC-301-6.3",description:"Formwork removal: Minimum 7 days for slabs, 3 days for walls/columns",descriptionAr:"ÙÙƒ Ø§Ù„Ù†Ø¬Ø§Ø±Ø©: 7 Ø£ÙŠØ§Ù… Ù„Ù„Ø¨Ù„Ø§Ø·Ø§ØªØŒ 3 Ø£ÙŠØ§Ù… Ù„Ù„Ø¬Ø¯Ø±Ø§Ù† ÙˆØ§Ù„Ø£Ø¹Ù…Ø¯Ø©",minimumDuration:3,requiredInspections:["Concrete Strength Verification"],applicableActivities:["Formwork Stripping","Stripping","ÙÙƒ Ø§Ù„Ù†Ø¬Ø§Ø±Ø©"],compliance:"Mandatory"},{ruleId:"SBC-301-5.2",description:"Concrete placement must be continuous without cold joints",descriptionAr:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø© Ù…ØªÙˆØ§ØµÙ„Ø§Ù‹ Ø¨Ø¯ÙˆÙ† ÙˆØµÙ„Ø§Øª Ø¨Ø§Ø±Ø¯Ø©",requiredInspections:["Pour Inspection","Quality Control"],applicableActivities:["Concrete Pour","ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©"],compliance:"Mandatory"},{ruleId:"SBC-301-4.1",description:"Concrete temperature during placement: 10-32Â°C",descriptionAr:"Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØµØ¨: 10-32 Ø¯Ø±Ø¬Ø© Ù…Ø¦ÙˆÙŠØ©",requiredInspections:["Temperature Monitoring"],applicableActivities:["Concrete Pour"],compliance:"Mandatory"}]},{code:"SBC-304",title:"Steel Reinforcement",titleAr:"Ø­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠØ­",requirements:[{ruleId:"SBC-304-7.2",description:"Minimum concrete cover for reinforcement: 40mm for foundations, 20mm for slabs",descriptionAr:"Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ø®Ø±Ø³Ø§Ù†ÙŠ Ù„Ù„Ø­Ø¯ÙŠØ¯: 40Ù…Ù… Ù„Ù„Ø£Ø³Ø§Ø³Ø§ØªØŒ 20Ù…Ù… Ù„Ù„Ø¨Ù„Ø§Ø·Ø§Øª",requiredInspections:["Cover Verification","Pre-pour Inspection"],applicableActivities:["Rebar Installation","ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø­Ø¯ÙŠØ¯"],compliance:"Mandatory"},{ruleId:"SBC-304-6.1",description:"Rebar must be clean and free from rust, oil, or loose scale",descriptionAr:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø­Ø¯ÙŠØ¯ Ù†Ø¸ÙŠÙØ§Ù‹ ÙˆØ®Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„ØµØ¯Ø£ ÙˆØ§Ù„Ø²ÙŠÙˆØª",requiredInspections:["Material Inspection"],applicableActivities:["Rebar Installation"],compliance:"Mandatory"},{ruleId:"SBC-304-5.3",description:"Minimum lap splice length: 40 times bar diameter",descriptionAr:"Ø·ÙˆÙ„ Ø§Ù„ÙˆØµÙ„Ø©: 40 Ø¶Ø¹Ù Ù‚Ø·Ø± Ø§Ù„Ø³ÙŠØ® ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",requiredInspections:["Rebar Inspection"],applicableActivities:["Rebar Installation"],compliance:"Mandatory"}]},{code:"SBC-306",title:"Masonry Construction",titleAr:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡",requirements:[{ruleId:"SBC-306-4.2",description:"Block minimum compressive strength: 7 MPa",descriptionAr:"Ù…Ù‚Ø§ÙˆÙ…Ø© Ø§Ù„Ø¶ØºØ· Ù„Ù„Ø¨Ù„ÙˆÙƒ: 7 Ù…ÙŠØ¬Ø§ Ø¨Ø§Ø³ÙƒØ§Ù„ ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",requiredInspections:["Material Testing","Block Strength Test"],applicableActivities:["Blockwork","Ø§Ù„Ø¨Ù†Ø§Ø¡","Masonry"],compliance:"Mandatory"},{ruleId:"SBC-306-5.1",description:"Maximum water absorption for blocks: 10%",descriptionAr:"Ø£Ù‚ØµÙ‰ Ø§Ù…ØªØµØ§Øµ Ù„Ù„Ù…Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¨Ù„ÙˆÙƒ: 10%",requiredInspections:["Material Testing"],applicableActivities:["Blockwork"],compliance:"Mandatory"},{ruleId:"SBC-306-6.3",description:"Curing of masonry: Minimum 7 days",descriptionAr:"Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡: 7 Ø£ÙŠØ§Ù… ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:7,requiredInspections:["Curing Verification"],applicableActivities:["Blockwork","Masonry"],compliance:"Recommended"}]},{code:"SBC-308",title:"Tiles and Wall Finishes",titleAr:"Ø§Ù„Ø¨Ù„Ø§Ø· ÙˆØ§Ù„ØªØ´Ø·ÙŠØ¨Ø§Øª",requirements:[{ruleId:"SBC-308-3.1",description:"Minimum curing time for tile adhesive: 24 hours",descriptionAr:"ÙˆÙ‚Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ù„Ø§ØµÙ‚ Ø§Ù„Ø¨Ù„Ø§Ø·: 24 Ø³Ø§Ø¹Ø© ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:1,requiredInspections:["Adhesive Inspection"],applicableActivities:["Tiling","Ø§Ù„Ø¨Ù„Ø§Ø·","Tile"],compliance:"Mandatory"},{ruleId:"SBC-308-4.2",description:"Grouting should be done 24-48 hours after tile installation",descriptionAr:"ÙŠØ¬Ø¨ Ø¹Ù…Ù„ Ø§Ù„ÙÙˆØ§ØµÙ„ Ø¨Ø¹Ø¯ 24-48 Ø³Ø§Ø¹Ø© Ù…Ù† ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¨Ù„Ø§Ø·",requiredInspections:["Grouting Inspection"],applicableActivities:["Tiling"],compliance:"Mandatory"}]},{code:"SBC-403",title:"Painting and Coating",titleAr:"Ø§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø§Ø¡",requirements:[{ruleId:"SBC-403-5.1",description:"Surface must be clean, dry, and free from dust before painting",descriptionAr:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø³Ø·Ø­ Ù†Ø¸ÙŠÙØ§Ù‹ ÙˆØ¬Ø§ÙØ§Ù‹ ÙˆØ®Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„ØºØ¨Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ù‡Ø§Ù†",requiredInspections:["Surface Preparation Check"],applicableActivities:["Painting","Ø§Ù„Ø¯Ù‡Ø§Ù†","Paint"],compliance:"Mandatory"},{ruleId:"SBC-403-6.2",description:"Minimum drying time between coats: 24 hours",descriptionAr:"ÙˆÙ‚Øª Ø§Ù„Ø¬ÙØ§Ù Ø¨ÙŠÙ† Ø§Ù„Ø·Ø¨Ù‚Ø§Øª: 24 Ø³Ø§Ø¹Ø© ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:1,requiredInspections:["Coating Inspection"],applicableActivities:["Painting"],compliance:"Mandatory"},{ruleId:"SBC-403-4.3",description:"Ambient temperature during painting: 10-35Â°C",descriptionAr:"Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø­ÙŠØ·Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¯Ù‡Ø§Ù†: 10-35 Ø¯Ø±Ø¬Ø© Ù…Ø¦ÙˆÙŠØ©",requiredInspections:["Environmental Conditions Check"],applicableActivities:["Painting"],compliance:"Recommended"}]}];let $=E;class G{static generateSCurve(a,s,n){const t=[],i=this.calculateTotalCost(a),l=new Date(s);let c=0,o=0;for(;l<=n;){const u=l.toISOString().split("T")[0],{progress:y,cost:b}=this.calculatePlannedAtDate(a,l);c+=y,o+=b;const{actualProgress:m,actualCost:h}=this.calculateActualAtDate(a,l),g=m/100*i;t.push({date:u,plannedProgress:Math.min(100,c),actualProgress:Math.min(100,m),plannedCost:o,actualCost:h,earnedValue:g}),l.setDate(l.getDate()+1)}return t}static calculatePlannedAtDate(a,s){let n=0,t=0;for(const i of a){const l=new Date(i.startDate),c=new Date(i.endDate);if(s>=l&&s<=c){const o=i.duration||1,u=100/o/a.length;n+=u;const y=this.calculateActivityCost(i);t+=y/o}}return{progress:n,cost:t}}static calculateActualAtDate(a,s){let n=0,t=0;for(const i of a)if(i.actualStart){const l=new Date(i.actualStart);s>=l&&(n+=(i.progress||0)/a.length,t+=this.calculateActivityCost(i)*((i.progress||0)/100))}return{actualProgress:n,actualCost:t}}static calculateTotalCost(a){return a.reduce((s,n)=>s+this.calculateActivityCost(n),0)}static calculateActivityCost(a){let s=0;for(const n of a.resources)n.dailyRate&&(s+=n.quantity*n.dailyRate*a.duration);return s||a.duration*1e3}static calculatePerformanceMetrics(a,s){const n=this.calculateTotalCost(a),{plannedProgress:t,plannedCost:i}=this.calculatePlannedAtDate(a,s),{actualProgress:l,actualCost:c}=this.calculateActualAtDate(a,s),o=l/100*n,u=t/100*n,y=u>0?o/u:1,b=c>0?o/c:1,m=o-u,h=o-c,g=b>0?n/b:n,r=y>0?this.getProjectDuration(a)/y:this.getProjectDuration(a),d=new Date(s);return d.setDate(d.getDate()+r),{spi:y,cpi:b,sv:m,cv:h,estimatedCompletion:d.toISOString().split("T")[0],estimatedCost:g}}static getProjectDuration(a){if(a.length===0)return 0;const s=a.map(l=>new Date(l.startDate)),n=a.map(l=>new Date(l.endDate)),t=new Date(Math.min(...s.map(l=>l.getTime()))),i=new Date(Math.max(...n.map(l=>l.getTime())));return Math.ceil((i.getTime()-t.getTime())/(1e3*60*60*24))}}class O{static exportToExcel(a,s,n){const t=XLSX.utils.book_new(),i=a.map(m=>({"Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·":m.id,"ÙƒÙˆØ¯ WBS":m.wbsCode,"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·":m.name,Ø§Ù„ÙˆØµÙ:m.description,"Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)":m.duration,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡":m.startDate,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡":m.endDate,"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±":m.earlyStart,"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±":m.earlyFinish,"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±":m.lateStart,"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±":m.lateFinish,"Float Ø§Ù„ÙƒÙ„ÙŠ":m.totalFloat,"Float Ø§Ù„Ø­Ø±":m.freeFloat,Ø­Ø±Ø¬:m.isCritical?"Ù†Ø¹Ù…":"Ù„Ø§","Ø§Ù„ØªÙ‚Ø¯Ù… %":m.progress,Ø§Ù„Ø­Ø§Ù„Ø©:m.status,"ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©":G.calculateActivityCost(m)})),l=XLSX.utils.json_to_sheet(i);XLSX.utils.book_append_sheet(t,l,"Ø§Ù„Ø£Ù†Ø´Ø·Ø©");const c=s.map(m=>({"ÙƒÙˆØ¯ WBS":m.code,Ø§Ù„Ù…Ø³ØªÙˆÙ‰:m.level,Ø§Ù„Ø§Ø³Ù…:m.name,"Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù†Ø´Ø·Ø©":m.activities.length,"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©":m.totalDuration,"Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©":m.totalCost})),o=XLSX.utils.json_to_sheet(c);XLSX.utils.book_append_sheet(t,o,"WBS");const y=a.filter(m=>m.isCritical).map(m=>({"Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·":m.id,"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·":m.name,Ø§Ù„Ù…Ø¯Ø©:m.duration,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡":m.startDate,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡":m.endDate})),b=XLSX.utils.json_to_sheet(y);XLSX.utils.book_append_sheet(t,b,"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬"),XLSX.writeFile(t,`${n}_Schedule_${new Date().toISOString().split("T")[0]}.xlsx`)}static exportToPrimavera(a,s){const n=a.map(o=>({activityId:`A${o.id}`,activityName:o.name,originalDuration:o.duration,remainingDuration:o.duration*(1-o.progress/100),percentComplete:o.progress,startDate:o.startDate,finishDate:o.endDate,calendarId:"STD",wbsId:o.wbsCode,predecessors:o.dependencies.map(u=>({predecessorActivityId:`A${u.predecessorId}`,type:`PR_${u.type}`,lag:u.lag}))}));let t=`<?xml version="1.0" encoding="UTF-8"?>
`;t+=`<Project>
`,t+=`  <ProjectName>${s}</ProjectName>
`,t+=`  <Activities>
`;for(const o of n){if(t+=`    <Activity>
`,t+=`      <ActivityId>${o.activityId}</ActivityId>
`,t+=`      <ActivityName><![CDATA[${o.activityName}]]></ActivityName>
`,t+=`      <Duration>${o.originalDuration}</Duration>
`,t+=`      <PercentComplete>${o.percentComplete}</PercentComplete>
`,t+=`      <StartDate>${o.startDate}</StartDate>
`,t+=`      <FinishDate>${o.finishDate}</FinishDate>
`,t+=`      <WBSCode>${o.wbsId}</WBSCode>
`,o.predecessors.length>0){t+=`      <Predecessors>
`;for(const u of o.predecessors)t+=`        <Predecessor>
`,t+=`          <ActivityId>${u.predecessorActivityId}</ActivityId>
`,t+=`          <Type>${u.type}</Type>
`,t+=`          <Lag>${u.lag}</Lag>
`,t+=`        </Predecessor>
`;t+=`      </Predecessors>
`}t+=`    </Activity>
`}t+=`  </Activities>
`,t+="</Project>";const i=new Blob([t],{type:"application/xml"}),l=URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.download=`${s}_Primavera_${new Date().toISOString().split("T")[0]}.xml`,c.click(),URL.revokeObjectURL(l)}static generatePDFContent(a,s){let n=`
            <html>
            <head>
                <title>${s} - Schedule</title>
                <style>
                    body { font-family: Arial, sans-serif; direction: rtl; }
                    h1 { text-align: center; color: #333; }
                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: right; }
                    th { background-color: #4CAF50; color: white; }
                    .critical { background-color: #ffcccc; }
                </style>
            </head>
            <body>
                <h1>Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹: ${s}</h1>
                <table>
                    <thead>
                        <tr>
                            <th>Ø±Ù‚Ù…</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·</th>
                            <th>Ø§Ù„Ù…Ø¯Ø©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                            <th>Float</th>
                            <th>Ø­Ø±Ø¬</th>
                        </tr>
                    </thead>
                    <tbody>
        `;return a.forEach(t=>{const i=t.isCritical?"critical":"";n+=`
                <tr class="${i}">
                    <td>${t.id}</td>
                    <td>${t.name}</td>
                    <td>${t.duration} ÙŠÙˆÙ…</td>
                    <td>${t.startDate}</td>
                    <td>${t.endDate}</td>
                    <td>${t.totalFloat}</td>
                    <td>${t.isCritical?"â˜…":""}</td>
                </tr>
            `}),n+=`
                    </tbody>
                </table>
            </body>
            </html>
        `,n}static printPDF(a,s){const n=this.generatePDFContent(a,s),t=window.open("","","width=800,height=600");t&&(t.document.write(n),t.document.close(),t.print())}}class ue{static exportSchedule(a,s,n={}){const t=D({includeGantt:!0,includeProgress:!0,includeResources:!0,colorByStatus:!0,colorByCritical:!0},n),i=XLSX.utils.book_new();this.addScheduleSheet(i,a,t),this.addSummarySheet(i,a,s),this.addCriticalPathSheet(i,a),t.includeResources&&this.addResourceSheet(i,a);const l=`${s}_Schedule_${new Date().toISOString().split("T")[0]}.xlsx`;XLSX.writeFile(i,l)}static addScheduleSheet(a,s,n){const t=[],i=["WBS","Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ù„Ù†ÙˆØ¹","Ø§Ù„ÙØ¦Ø©","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡","Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)","Ø§Ù„ØªÙ‚Ø¯Ù… %","Ø§Ù„Ø­Ø§Ù„Ø©","Ø­Ø±Ø¬ØŸ","Ø§Ù„Ø£Ø³Ø¨Ù‚ÙŠØ§Øª","Ø§Ù„Ù…ÙˆØ§Ø±Ø¯","Ø§Ù„ØªÙƒÙ„ÙØ©"];t.push(i),[...s].sort((o,u)=>o.wbsCode.localeCompare(u.wbsCode)).forEach(o=>{var y,b;const u=[o.wbsCode,o.id,o.name,this.getTypeNameAr(o.type),o.category,o.startDate.toLocaleDateString("ar-SA"),o.endDate.toLocaleDateString("ar-SA"),o.duration,o.progress,this.getStatusNameAr(o.status),o.isCritical?"Ù†Ø¹Ù…":"Ù„Ø§",((y=o.dependencies)==null?void 0:y.join(", "))||"-",((b=o.resources)==null?void 0:b.join(", "))||"-",o.cost?`${o.cost.toLocaleString()} Ø±ÙŠØ§Ù„`:"-"];t.push(u)});const c=XLSX.utils.aoa_to_sheet(t);c["!cols"]=[{wch:12},{wch:12},{wch:40},{wch:15},{wch:20},{wch:15},{wch:15},{wch:12},{wch:10},{wch:12},{wch:8},{wch:15},{wch:20},{wch:18}],XLSX.utils.book_append_sheet(a,c,"Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ")}static addSummarySheet(a,s,n){const t=[];t.push(["Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"]),t.push(["Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹",n]),t.push(["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡",new Date().toLocaleDateString("ar-SA")]),t.push([]),t.push(["Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª"]),t.push(["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©",s.length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©",s.filter(h=>h.isCritical).length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©",s.filter(h=>h.progress===100).length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",s.filter(h=>h.progress>0&&h.progress<100).length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© ØºÙŠØ± Ø§Ù„Ù…Ø¨Ø¯ÙˆØ¡Ø©",s.filter(h=>h.progress===0).length]),t.push([]);const i=s.map(h=>h.startDate.getTime()),l=s.map(h=>h.endDate.getTime()),c=new Date(Math.min(...i)),o=new Date(Math.max(...l)),u=Math.ceil((o.getTime()-c.getTime())/(1e3*60*60*24));t.push(["Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ"]),t.push(["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",c.toLocaleDateString("ar-SA")]),t.push(["ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©",o.toLocaleDateString("ar-SA")]),t.push(["Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©",`${u} ÙŠÙˆÙ…`]),t.push([]),t.push(["Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©"]);const y={};s.forEach(h=>{y[h.category]=(y[h.category]||0)+1}),Object.entries(y).forEach(([h,g])=>{t.push([h,g])}),t.push([]),t.push(["Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹"]);const b={};s.forEach(h=>{const g=this.getTypeNameAr(h.type);b[g]=(b[g]||0)+1}),Object.entries(b).forEach(([h,g])=>{t.push([h,g])});const m=XLSX.utils.aoa_to_sheet(t);m["!cols"]=[{wch:25},{wch:20}],XLSX.utils.book_append_sheet(a,m,"Ø§Ù„Ù…Ù„Ø®Øµ")}static addCriticalPathSheet(a,s){const n=[];n.push(["Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹"]),n.push([]),n.push(["WBS","Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡","Ø§Ù„Ù…Ø¯Ø©","Ø§Ù„ØªÙ‚Ø¯Ù… %","Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ"]);const t=s.filter(l=>l.isCritical);t.forEach(l=>{n.push([l.wbsCode,l.id,l.name,l.startDate.toLocaleDateString("ar-SA"),l.endDate.toLocaleDateString("ar-SA"),l.duration,l.progress,l.totalFloat||0])}),n.push([]),n.push(["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©",t.length]),n.push(["Ù†Ø³Ø¨Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©",`${(t.length/s.length*100).toFixed(1)}%`]);const i=XLSX.utils.aoa_to_sheet(n);i["!cols"]=[{wch:12},{wch:12},{wch:40},{wch:15},{wch:15},{wch:10},{wch:10},{wch:12}],XLSX.utils.book_append_sheet(a,i,"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬")}static addResourceSheet(a,s){const n=[];n.push(["ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"]),n.push([]);const t=s.map(h=>h.startDate.getTime()),i=s.map(h=>h.endDate.getTime()),l=new Date(Math.min(...t)),c=new Date(Math.max(...i)),o=[];let u=new Date(l);for(;u<=c;)o.push(new Date(u)),u.setDate(u.getDate()+7);const y=["Ø§Ù„ÙØ¦Ø©","Ø§Ù„Ù†ÙˆØ¹"];o.forEach((h,g)=>{y.push(`Ø£Ø³Ø¨ÙˆØ¹ ${g+1}`)}),n.push(y);const b={};s.forEach(h=>{b[h.category]||(b[h.category]=new Array(o.length).fill(0)),o.forEach((g,r)=>{const d=new Date(g);d.setDate(d.getDate()+7),h.startDate<=d&&h.endDate>=g&&(b[h.category][r]+=1)})}),Object.entries(b).forEach(([h,g])=>{const r=[h,""];r.push(...g.map(d=>d.toString())),n.push(r)});const m=XLSX.utils.aoa_to_sheet(n);XLSX.utils.book_append_sheet(a,m,"Ø§Ù„Ù…ÙˆØ§Ø±Ø¯")}static getTypeNameAr(a){return{excavation:"Ø­ÙØ±",concrete:"Ø®Ø±Ø³Ø§Ù†Ø©",reinforcement:"Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­",formwork:"Ø´Ø¯Ø© Ø®Ø´Ø¨ÙŠØ©",masonry:"Ù…Ø¨Ø§Ù†ÙŠ",waterproofing:"Ø¹Ø²Ù„",backfill:"Ø±Ø¯Ù…",painting:"Ø¯Ù‡Ø§Ù†",installation:"ØªØ±ÙƒÙŠØ¨",supply:"ØªÙˆØ±ÙŠØ¯",other:"Ø£Ø®Ø±Ù‰"}[a]||a}static getStatusNameAr(a){return{not_started:"Ù„Ù… ÙŠØ¨Ø¯Ø£",in_progress:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",completed:"Ù…ÙƒØªÙ…Ù„",delayed:"Ù…ØªØ£Ø®Ø±",on_hold:"Ù…Ø¹Ù„Ù‚"}[a]||a}}const me=({activities:p,projectName:a,projectStart:s,projectEnd:n})=>{const[t,i]=w.useState("weeks"),[l,c]=w.useState(!1),[o,u]=w.useState("all"),y=w.useMemo(()=>{const r=new Set(p.map(d=>d.category));return Array.from(r).sort()},[p]),b=w.useMemo(()=>{let r=p;return l&&(r=r.filter(d=>d.isCritical)),o!=="all"&&(r=r.filter(d=>d.category===o)),r.sort((d,x)=>d.startDate.getTime()-x.startDate.getTime())},[p,l,o]),m=w.useMemo(()=>{const r=n.getTime()-s.getTime(),d=Math.ceil(r/(1e3*60*60*24));let x=[],j;if(t==="days"){for(let f=0;f<=d;f+=1){const v=new Date(s);v.setDate(v.getDate()+f),x.push(v)}j=f=>`${f.getDate()}/${f.getMonth()+1}`}else if(t==="weeks"){for(let f=0;f<=d;f+=7){const v=new Date(s);v.setDate(v.getDate()+f),x.push(v)}j=f=>`W${Math.ceil((f.getTime()-s.getTime())/(10080*60*1e3))}`}else{let f=new Date(s);for(;f<=n;)x.push(new Date(f)),f.setMonth(f.getMonth()+1);j=v=>`${v.toLocaleDateString("ar-SA",{month:"short",year:"2-digit"})}`}return{intervals:x,intervalLabel:j,totalDays:d}},[s,n,t]),h=w.useMemo(()=>{const r=n.getTime()-s.getTime();return b.map((d,x)=>{const j=d.startDate.getTime(),v=d.endDate.getTime()-j,S=(j-s.getTime())/r*100,k=v/r*100;let N="#3b82f6";return d.isCritical?N="#ef4444":d.progress===100?N="#10b981":d.progress>0?N="#f59e0b":N={excavation:"#8b5cf6",concrete:"#64748b",reinforcement:"#f97316",waterproofing:"#06b6d4",backfill:"#84cc16",painting:"#ec4899",formwork:"#eab308",masonry:"#d97706",installation:"#0ea5e9",supply:"#6366f1"}[d.type]||N,{activity:d,startPos:Math.max(0,S),width:Math.min(100-S,k),color:N,row:x}})},[b,s,n]),g=()=>{alert("ØªØµØ¯ÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±")};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Y,{className:"w-6 h-6 text-indigo-600"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Ù…Ø®Ø·Ø· Ø¬Ø§Ù†Øª - ",a]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.toLocaleDateString("ar-SA")," - ",n.toLocaleDateString("ar-SA")]})]})]}),e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(T,{className:"w-4 h-4"}),"ØªØµØ¯ÙŠØ± ØµÙˆØ±Ø©"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 p-4 bg-gray-50 dark:bg-slate-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø¹Ø±Ø¶:"}),e.jsxs("select",{value:t,onChange:r=>i(r.target.value),className:"px-3 py-1 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"days",children:"Ø£ÙŠØ§Ù…"}),e.jsx("option",{value:"weeks",children:"Ø£Ø³Ø§Ø¨ÙŠØ¹"}),e.jsx("option",{value:"months",children:"Ø£Ø´Ù‡Ø±"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ÙØ¦Ø©:"}),e.jsxs("select",{value:o,onChange:r=>u(r.target.value),className:"px-3 py-1 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"all",children:"Ø§Ù„ÙƒÙ„"}),y.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:r=>c(r.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø© ÙÙ‚Ø·"})]}),e.jsxs("div",{className:"mr-auto text-sm text-gray-600",children:["Ø¹Ø±Ø¶ ",b.length," Ù…Ù† ",p.length," Ù†Ø´Ø§Ø·"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ø­Ø±Ø¬"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ù…ÙƒØªÙ…Ù„"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ù…Ø®Ø·Ø·"})]})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("div",{className:"min-w-[1200px]",children:[e.jsxs("div",{className:"flex border-b bg-gray-100 dark:bg-slate-800",children:[e.jsx("div",{className:"w-64 p-3 border-l font-bold",children:"Ø§Ù„Ù†Ø´Ø§Ø·"}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("div",{className:"flex",children:m.intervals.map((r,d)=>e.jsx("div",{className:"flex-1 p-2 border-l text-center text-sm font-medium",style:{minWidth:"60px"},children:m.intervalLabel(r)},d))})})]}),h.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙÙ„ØªØ±"}):h.map((r,d)=>e.jsxs("div",{className:"flex border-b hover:bg-gray-50 dark:hover:bg-slate-800/50",children:[e.jsxs("div",{className:"w-64 p-3 border-l",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r.activity.isCritical&&e.jsx("span",{className:"text-red-500 font-bold",children:"âš ï¸"}),e.jsx("span",{className:"text-sm truncate",title:r.activity.name,children:r.activity.name})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[r.activity.duration," ÙŠÙˆÙ… | ",r.activity.progress,"%"]})]}),e.jsx("div",{className:"flex-1 relative p-2",children:e.jsxs("div",{className:"absolute top-2 h-8 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition-shadow",style:{right:`${r.startPos}%`,width:`${r.width}%`,backgroundColor:r.color,minWidth:"4px"},title:`${r.activity.name}
${r.activity.startDate.toLocaleDateString("ar-SA")} - ${r.activity.endDate.toLocaleDateString("ar-SA")}`,children:[r.activity.progress>0&&e.jsx("div",{className:"h-full bg-black/20 rounded-lg",style:{width:`${r.activity.progress}%`}}),r.width>5&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-medium px-2",children:[r.activity.progress,"%"]})]})})]},d))]})}),e.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©:"}),e.jsx("span",{className:"font-bold mr-2",children:p.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©:"}),e.jsx("span",{className:"font-bold mr-2 text-red-600",children:p.filter(r=>r.isCritical).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:"}),e.jsx("span",{className:"font-bold mr-2 text-green-600",children:p.filter(r=>r.progress===100).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°:"}),e.jsx("span",{className:"font-bold mr-2 text-orange-600",children:p.filter(r=>r.progress>0&&r.progress<100).length})]})]})})]})},he=({activities:p,wbs:a,projectName:s})=>{var g;const[n,t]=w.useState("activities"),[i,l]=w.useState(null),c=w.useMemo(()=>{if(p.length===0)return null;const r=new Date(Math.min(...p.map(d=>new Date(d.startDate).getTime())));return L.performCPM(p,r)},[p]),o=w.useMemo(()=>{if(p.length===0)return[];const r=new Date(Math.min(...p.map(x=>new Date(x.startDate).getTime()))),d=new Date(Math.max(...p.map(x=>new Date(x.endDate).getTime())));return G.generateSCurve(p,r,d)},[p]),u=w.useMemo(()=>$.generateComplianceReport(p),[p]),y=w.useMemo(()=>{if(p.length===0)return{start:new Date,end:new Date};const r=new Date(Math.min(...p.map(x=>new Date(x.startDate).getTime()))),d=new Date(Math.max(...p.map(x=>new Date(x.endDate).getTime())));return{start:r,end:d}},[p]),b=()=>{ue.exportSchedule(p,s,{includeResources:!0,includeProjectInfo:!0})},m=()=>{O.exportToPrimavera(p,s)},h=()=>{O.printPDF(p,s)};return p.length===0?e.jsx("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ. Ù‚Ù… Ø¨ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Ø¹Ø§Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700",children:[e.jsx(T,{className:"w-4 h-4"})," Excel"]}),e.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700",children:[e.jsx(T,{className:"w-4 h-4"})," Primavera"]}),e.jsxs("button",{onClick:h,className:"flex items-center gap-2 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700",children:[e.jsx(se,{className:"w-4 h-4"})," PDF"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.length})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:p.filter(r=>r.isCritical).length})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[(c==null?void 0:c.projectDuration)||0," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„ÙƒÙˆØ¯"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[u.compliancePercentage.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700 p-4",children:[{key:"activities",label:"Ø§Ù„Ø£Ù†Ø´Ø·Ø©"},{key:"wbs",label:"WBS"},{key:"critical",label:"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬"},{key:"gantt",label:"Ù…Ø®Ø·Ø· Ø¬Ø§Ù†Øª"},{key:"scurve",label:"Ù…Ù†Ø­Ù†Ù‰ S"},{key:"compliance",label:"Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ SBC"}].map(r=>e.jsx("button",{onClick:()=>t(r.key),className:`px-4 py-2 rounded-lg font-semibold ${n===r.key?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:r.label},r.key))}),e.jsxs("div",{className:"p-6",children:[n==="activities"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-right",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800",children:e.jsx("tr",{children:["ID","WBS","Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ù„Ù…Ø¯Ø©","Ø§Ù„Ø¨Ø¯Ø¡","Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡","Float","Ø­Ø±Ø¬"].map(r=>e.jsx("th",{className:"p-3 text-sm font-medium",children:r},r))})}),e.jsx("tbody",{children:p.map(r=>e.jsxs("tr",{className:`border-b hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer ${r.isCritical?"bg-red-50 dark:bg-red-900/20":""}`,onClick:()=>l(r),children:[e.jsx("td",{className:"p-2",children:r.id}),e.jsx("td",{className:"p-2 text-xs",children:r.wbsCode}),e.jsx("td",{className:"p-2 font-medium",children:r.name}),e.jsxs("td",{className:"p-2",children:[r.duration," ÙŠÙˆÙ…"]}),e.jsx("td",{className:"p-2 text-sm",children:r.startDate}),e.jsx("td",{className:"p-2 text-sm",children:r.endDate}),e.jsx("td",{className:"p-2",children:r.totalFloat}),e.jsx("td",{className:"p-2 text-center",children:r.isCritical&&e.jsx("span",{className:"text-red-600",children:"â˜…"})})]},r.id))})]})}),n==="wbs"&&e.jsx("div",{className:"space-y-3",children:a.map(r=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-bold",children:r.name}),e.jsx("span",{className:"text-sm text-gray-500",children:r.code})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø©:"}),e.jsx("span",{className:"font-semibold mr-2",children:r.activities.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ø§Ù„Ù…Ø¯Ø©:"}),e.jsxs("span",{className:"font-semibold mr-2",children:[r.totalDuration," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ø§Ù„ØªÙƒÙ„ÙØ©:"}),e.jsxs("span",{className:"font-semibold mr-2",children:[r.totalCost.toLocaleString()," Ø±ÙŠØ§Ù„"]})]})]})]},r.code))}),n==="critical"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-red-600",children:"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬ - Critical Path"}),e.jsx("div",{className:"space-y-2",children:p.filter(r=>r.isCritical).map(r=>e.jsxs("div",{className:"border-l-4 border-red-500 p-4 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:r.name}),e.jsxs("span",{className:"text-sm",children:[r.duration," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[r.startDate," â†’ ",r.endDate]})]},r.id))})]}),n==="gantt"&&e.jsx(me,{activities:p,projectName:s,projectStart:y.start,projectEnd:y.end}),n==="scurve"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Ù…Ù†Ø­Ù†Ù‰ S - Progress Tracking"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ",o.length," | Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø®Ø·Ø·: ",(g=o[o.length-1])==null?void 0:g.plannedProgress.toFixed(1),"%"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsx("p",{className:"text-center text-gray-500",children:"ØªØµÙˆØ± Ù…Ù†Ø­Ù†Ù‰ S (ÙŠØªØ·Ù„Ø¨ Ù…ÙƒØªØ¨Ø© Recharts Ù„Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ù…Ù„)"})})]}),n==="compliance"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:"Ø£Ù†Ø´Ø·Ø© Ù…Ù…ØªØ«Ù„Ø©"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:u.compliantActivities})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:"Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:u.nonCompliantActivities})]})]}),u.violations.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-red-600 flex items-center",children:[e.jsx(ae,{className:"w-4 h-4 ml-2"}),"Ø§Ù„Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§"]}),u.violations.map(r=>e.jsxs("div",{className:"border-l-4 border-red-500 p-4 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsx("p",{className:"font-semibold",children:r.activityName}),e.jsx("ul",{className:"text-sm mt-2 space-y-1",children:r.violations.map((d,x)=>e.jsxs("li",{className:"text-red-700 dark:text-red-300",children:["â€¢ ",d.code,": ",d.complianceNotes]},x))})]},r.activityId))]})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>l(null),children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",onClick:r=>r.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:i.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"WBS:"})," ",i.wbsCode]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ù…Ø¯Ø©:"})," ",i.duration," ÙŠÙˆÙ…"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±:"})," ",i.earlyStart]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±:"})," ",i.earlyFinish]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±:"})," ",i.lateStart]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±:"})," ",i.lateFinish]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Float Ø§Ù„ÙƒÙ„ÙŠ:"})," ",i.totalFloat," ÙŠÙˆÙ…"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Float Ø§Ù„Ø­Ø±:"})," ",i.freeFloat," ÙŠÙˆÙ…"]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("strong",{children:"Ø­Ø±Ø¬:"})," ",i.isCritical?"â˜… Ù†Ø¹Ù…":"Ù„Ø§"]})]}),i.sbcRequirements&&i.sbcRequirements.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ:"}),e.jsx("div",{className:"space-y-2",children:i.sbcRequirements.map((r,d)=>e.jsxs("div",{className:`p-2 rounded text-sm ${r.isCompliant?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[r.code,":"]})," ",r.description]}),r.minimumDuration&&e.jsxs("p",{className:"text-xs mt-1",children:["Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: ",r.minimumDuration," ÙŠÙˆÙ…"]})]},d))})]}),e.jsx("button",{onClick:()=>l(null),className:"mt-4 w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700",children:"Ø¥ØºÙ„Ø§Ù‚"})]})})]})};class pe{static parseExcelWithSpecs(a){return new Promise((s,n)=>{const t=new FileReader;t.onload=i=>{var l;try{const c=new Uint8Array((l=i.target)==null?void 0:l.result),o=XLSX.read(c,{type:"array"}),u=o.SheetNames[0],y=o.Sheets[u],b=XLSX.utils.sheet_to_json(y,{header:1,defval:""}),m=[];let h=-1;for(let d=0;d<Math.min(20,b.length);d++){const x=b[d],j=x.join(" ").toLowerCase();if((j.includes("Ø±Ù‚Ù…")||j.includes("ØªØ³Ù„Ø³Ù„"))&&j.includes("Ø¨Ù†Ø¯")){h=d,console.log(`âœ“ ÙˆØ¬Ø¯Øª ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø³Ø·Ø± ${d+1}`),console.log("Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙ:",x.filter(f=>f).slice(0,10));break}}if(h===-1)throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ù„Ù");console.log(`âœ“ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø³Ø·Ø± ${h+1}`);const g=b[h],r={};for(let d=0;d<g.length;d++){const x=String(g[d]).toLowerCase().trim();x.includes("Ø±Ù‚Ù…")&&x.includes("ØªØ³Ù„Ø³Ù„")||x==="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ"?r.serialNumber=d:x.includes("ÙØ¦Ø©")||x.includes("category")?r.category=d:x==="Ø§Ù„Ø¨Ù†Ø¯"||x.includes("item name")||x==="item"?r.itemName=d:x.includes("ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯")||x.includes("ÙˆØµÙ")||x.includes("description")?r.description=d:x==="Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"||x.includes("Ù…ÙˆØ§ØµÙØ§Øª")||x.includes("specification")?r.specifications=d:x.includes("ÙˆØ­Ø¯Ø©")||x.includes("unit")?r.unit=d:x.includes("ÙƒÙ…ÙŠØ©")||x.includes("quantity")?r.quantity=d:x.includes("Ø³Ø¹Ø±")||x==="Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©"||x.includes("unit price")?r.unitPrice===void 0&&(r.unitPrice=d):(x.includes("Ø¥Ø¬Ù…Ø§Ù„ÙŠ")||x.includes("total"))&&r.total===void 0&&(r.total=d)}if(console.log("âœ… Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:",r),console.log("ğŸ“Š Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙƒØªØ´ÙØ©:",{serialNumber:r.serialNumber!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.serialNumber+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",category:r.category!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.category+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",itemName:r.itemName!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.itemName+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",description:r.description!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.description+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",specifications:r.specifications!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.specifications+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",unit:r.unit!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.unit+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",quantity:r.quantity!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.quantity+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",unitPrice:r.unitPrice!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${r.unitPrice+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"}),r.serialNumber===void 0||r.itemName===void 0){const d=[];throw r.serialNumber===void 0&&d.push("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ"),r.itemName===void 0&&d.push("Ø§Ù„Ø¨Ù†Ø¯"),new Error(`Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: ${d.join(", ")}

Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${g.filter(x=>x).join(", ")}`)}for(let d=h+1;d<b.length;d++){const x=b[d],j=String(x[r.serialNumber]||"").trim(),f=String(x[r.itemName]||"").trim();if(!j||!f||j==="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ"||f==="Ø§Ù„Ø¨Ù†Ø¯")continue;const v=String(x[r.category]||"").trim(),S=r.description!==void 0?String(x[r.description]||"").trim():"",k=r.specifications!==void 0?String(x[r.specifications]||"").trim():"",N=r.unit!==void 0?String(x[r.unit]||"").trim():"",C=r.quantity!==void 0?this.parseNumber(x[r.quantity]):0,P=r.unitPrice!==void 0?this.parseNumber(x[r.unitPrice]):0,I=r.total!==void 0&&this.parseNumber(x[r.total])||C*P;f&&C>0&&m.push({serialNumber:j,category:v,itemName:f,description:S,specifications:k||S||f,unit:N,quantity:C,unitPrice:P,total:I})}if(m.length===0)throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨Ù†ÙˆØ¯ ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù");console.log(`âœ… ØªÙ… Ù‚Ø±Ø§Ø¡Ø© ${m.length} Ø¨Ù†Ø¯ Ø¨Ù†Ø¬Ø§Ø­`),s(m)}catch(c){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù:",c),n(new Error(`ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù Excel: ${c.message}`))}},t.onerror=()=>n(new Error("ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù")),t.readAsArrayBuffer(a)})}static parseNumber(a){if(typeof a=="number")return a;if(typeof a=="string"){const s=a.replace(/[,ØŒ\s]/g,""),n=parseFloat(s);return isNaN(n)?0:n}return 0}static convertToFinancialItems(a){return a.map(s=>({id:`BOQ-${s.serialNumber}`,item:s.itemName,unit:s.unit,quantity:s.quantity,unitPrice:s.unitPrice,total:s.total}))}}const B=class B{static analyzeSpecifications(a,s,n,t,i,l,c,o){const u={id:`BOQ-${a}`,item:n,unit:l,quantity:c,unitPrice:o,total:c*o},y=this.extractActivitiesFromSpecs(i,n,l,c);return{originalItem:u,serialNumber:a,category:s,itemName:n,description:t,fullSpecifications:i,extractedActivities:y}}static extractActivitiesFromSpecs(a,s,n,t){const i=[],l=a.toLowerCase();for(const c of this.activityPatterns)if(c.keywords.some(u=>l.includes(u.toLowerCase()))){const u=this.extractRelevantSentences(a,c.keywords);i.push({name:`${c.activityName} - ${s}`,description:u,type:c.type,keywords:c.keywords,estimatedQuantity:this.estimateActivityQuantity(t,n,c.type),unit:this.determineActivityUnit(n,c.type),sequence:c.sequence,parentItemName:s})}return i.sort((c,o)=>c.sequence-o.sequence),i.length===0&&i.push({name:s,description:a,type:"other",keywords:[],estimatedQuantity:t,unit:n,sequence:50,parentItemName:s}),i}static extractRelevantSentences(a,s){const n=a.split(/[.ØŒØ›]/).map(i=>i.trim()),t=[];for(const i of n){const l=i.toLowerCase();s.some(c=>l.includes(c.toLowerCase()))&&t.push(i)}return t.length>0?t.join(". "):a.substring(0,200)+"..."}static estimateActivityQuantity(a,s,n){switch(n){case"excavation":return a;case"concrete":return a;case"reinforcement":return s.includes("Ù…")?a*.12:a;case"formwork":return s.includes("Ù…")?a*6:a;case"waterproofing":return a*.5;case"backfill":return a*.8;default:return a}}static determineActivityUnit(a,s){switch(s){case"excavation":case"concrete":case"backfill":return"Ù…3";case"reinforcement":return"Ø·Ù†";case"formwork":case"waterproofing":case"painting":return"Ù…2";case"installation":case"supply":return a;default:return a}}static convertToScheduleActivities(a,s){const n=[];let t=1,i=new Date(s);for(const l of a){const c=`${l.category}.${l.serialNumber}`;for(let o=0;o<l.extractedActivities.length;o++){const u=l.extractedActivities[o],y=this.calculateActivityDuration(u.type,u.estimatedQuantity,u.unit),b={id:t++,wbsCode:`${c}.${o+1}`,name:u.name,description:u.description,category:l.category,boqItemId:l.originalItem.id,duration:y,startDate:i.toISOString().split("T")[0],endDate:this.addDays(i,y).toISOString().split("T")[0],earlyStart:"",earlyFinish:"",lateStart:"",lateFinish:"",totalFloat:0,freeFloat:0,isCritical:!1,dependencies:this.generateDependencies(t,o),successors:[],resources:this.generateResources(u.type),progress:0,status:"Not Started",productivityRate:0,estimatedManHours:this.estimateManHours(u.type,u.estimatedQuantity)};n.push(b),i=this.addDays(i,Math.ceil(y/2))}}return n}static calculateActivityDuration(a,s,n){const i={excavation:25,concrete:15,reinforcement:1,formwork:20,waterproofing:30,backfill:30,masonry:10,painting:40,installation:5,supply:1}[a]||10,l=Math.ceil(s/i);return Math.max(1,Math.min(30,l))}static generateDependencies(a,s){return s===0?[]:[{predecessorId:a-1,type:"FS",lag:0}]}static generateResources(a){return{excavation:[{resourceType:"Equipment",resourceName:"Ø­ÙØ§Ø±Ø©",quantity:1,unit:"units",dailyRate:1200},{resourceType:"Labor",resourceName:"Ø¹Ù…Ø§Ù„",quantity:3,unit:"persons",dailyRate:200}],concrete:[{resourceType:"Labor",resourceName:"Ø¹Ù…Ø§Ù„ Ø®Ø±Ø³Ø§Ù†Ø©",quantity:8,unit:"persons",dailyRate:250},{resourceType:"Equipment",resourceName:"Ù…Ø¶Ø®Ø© Ø®Ø±Ø³Ø§Ù†Ø©",quantity:1,unit:"units",dailyRate:800}],reinforcement:[{resourceType:"Labor",resourceName:"Ø­Ø¯Ø§Ø¯ÙŠÙ†",quantity:4,unit:"persons",dailyRate:300}],formwork:[{resourceType:"Labor",resourceName:"Ù†Ø¬Ø§Ø±ÙŠÙ†",quantity:4,unit:"persons",dailyRate:280}]}[a]||[{resourceType:"Labor",resourceName:"Ø¹Ù…Ø§Ù„ Ø¹Ø§Ù…ÙŠÙ†",quantity:3,unit:"persons",dailyRate:200}]}static estimateManHours(a,s){const t={excavation:.5,concrete:1,reinforcement:8,formwork:.8,waterproofing:.4,backfill:.3,masonry:1.2,painting:.2,installation:2,supply:.1}[a]||.5;return Math.ceil(s*t)}static addDays(a,s){const n=new Date(a);return n.setDate(n.getDate()+s),n}};B.activityPatterns=[{keywords:["Ø­ÙØ±","Ø­ÙØ±ÙŠØ§Øª","excavation","Ø­ÙØ± Ø¨Ø¹Ù…Ù‚","Ø§Ù„Ø­ÙØ± Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª","Ø­ÙØ± Ø£Ø³Ø§Ø³Ø§Øª"],type:"excavation",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­ÙØ±",sequence:10},{keywords:["Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ©","plain concrete","ØµØ¨ Ù‚ÙˆØ§Ø¹Ø¯","Ø®Ø±Ø³Ø§Ù†Ù‡ Ø¹Ø§Ø¯ÙŠÙ‡","Ø®Ø±Ø³Ø§Ù†Ø© Ù†Ø¸Ø§ÙØ©"],type:"concrete",activityName:"ØµØ¨ Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ©",sequence:20},{keywords:["Ø­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠØ­","reinforcement","ØªØ³Ù„ÙŠØ­","Ø§Ù„ØªØ³Ù„ÙŠØ­","Ø­Ø¯ÙŠØ¯ Ù…Ø³Ù„Ø­"],type:"reinforcement",activityName:"ØªØ±ÙƒÙŠØ¨ Ø­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠØ­",sequence:30},{keywords:["Ù†Ø¬Ø§Ø±Ø©","formwork","Ø´Ø¯Ø§Øª","Ù‚ÙˆØ§Ù„Ø¨","Ø´Ø¯Ø© Ø®Ø´Ø¨ÙŠØ©"],type:"formwork",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ù†Ø¬Ø§Ø±Ø© ÙˆØ§Ù„Ø´Ø¯Ø§Øª",sequence:35},{keywords:["Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©","reinforced concrete","Ø®Ø±Ø³Ø§Ù†Ù‡ Ù…Ø³Ù„Ø­Ù‡","Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ø³Ù„Ø­Ø©","ØµØ¨ Ù…Ø³Ù„Ø­"],type:"concrete",activityName:"ØµØ¨ Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©",sequence:40},{keywords:["Ù…ÙŠØ¯Ø§Øª","Ù…ÙŠØ¯Ù‡","grade beams","Ø§Ù„Ù…ÙŠØ¯Ø§Øª Ø§Ù„Ø£Ø±Ø¶ÙŠØ©"],type:"concrete",activityName:"ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ÙŠØ¯Ø§Øª",sequence:45},{keywords:["Ø¹Ø²Ù„","waterproofing","Ø¹Ø²Ù„ Ø§Ù„Ø£Ø³Ø§Ø³Ø§Øª","Ø¯Ù‡Ø§Ù† Ø¨ÙŠØªÙˆÙ…ÙŠÙ†ÙŠ","Ø¹Ø§Ø²Ù„ Ù„Ù„Ø±Ø·ÙˆØ¨Ø©","Ø¹Ø²Ù„ Ù…Ø§Ø¦ÙŠ"],type:"waterproofing",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¹Ø²Ù„",sequence:50},{keywords:["Ù…Ø¨ÙŠØ¯Ø§Øª","Ø§Ù„Ù†Ù…Ù„ Ø§Ù„Ø£Ø¨ÙŠØ¶","Ø¯ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¶","Ø±Ø´ Ø§Ù„Ù…Ø¨ÙŠØ¯Ø§Øª"],type:"installation",activityName:"Ø±Ø´ Ø§Ù„Ù…Ø¨ÙŠØ¯Ø§Øª",sequence:55},{keywords:["Ø±Ø¯Ù…","backfill","Ø§Ù„Ø±Ø¯Ù… Ø­ÙˆÙ„","Ø±Ù…Ø§Ù„ Ù†Ø¸ÙŠÙØ©","Ù†Ø§ØªØ¬ Ø§Ù„Ø­ÙØ±","Ø±Ø¯Ù… Ø§Ù„Ø£Ø³Ø§Ø³Ø§Øª"],type:"backfill",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø±Ø¯Ù…",sequence:60},{keywords:["Ø£Ø¹Ù…Ø¯Ø©","columns","Ø¹Ù…ÙˆØ¯","Ø£Ø¹Ù…Ø¯Ø© Ø®Ø±Ø³Ø§Ù†ÙŠØ©","Ø¨Ø§ÙƒÙŠØ§Øª"],type:"concrete",activityName:"ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©",sequence:70},{keywords:["Ø¨Ù†Ø§Ø¡","Ù…Ø¨Ø§Ù†ÙŠ","masonry","Ø·ÙˆØ¨","Ø¨Ù„ÙˆÙƒ","Ø¬Ø¯Ø±Ø§Ù†"],type:"masonry",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡",sequence:80},{keywords:["Ø¯Ù‡Ø§Ù†","painting","Ø·Ù„Ø§Ø¡","Ø¯Ù‡Ø§Ù† Ù†Ø§Ø±ÙŠ","ÙˆØ¬Ù‡ Ø§Ø³Ø§Ø³ÙŠ"],type:"painting",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¯Ù‡Ø§Ù†",sequence:90},{keywords:["ØªØ±ÙƒÙŠØ¨","installation","install","ØªØ«Ø¨ÙŠØª"],type:"installation",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØªØ±ÙƒÙŠØ¨",sequence:85},{keywords:["ØªÙˆØ±ÙŠØ¯","supply","ØªÙˆØ±ÙŠØ¯ ÙˆØªØ±ÙƒÙŠØ¨","ØªÙˆØ±ÙŠØ¯ Ùˆ ØªØ±ÙƒÙŠØ¨"],type:"supply",activityName:"Ø§Ù„ØªÙˆØ±ÙŠØ¯",sequence:5}];let M=B;const ge=({onScheduleGenerated:p})=>{const[a,s]=w.useState(null),[n,t]=w.useState(!1),[i,l]=w.useState(""),[c,o]=w.useState(null),[u,y]=w.useState(new Date().toISOString().split("T")[0]),[b,m]=w.useState(null),h=d=>{var j;const x=((j=d.target.files)==null?void 0:j[0])||null;x&&(x.name.endsWith(".xlsx")||x.name.endsWith(".xls")?(s(x),o(null),l("")):(s(null),o("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel (.xlsx Ø£Ùˆ .xls)")))},g=(d,x,j,f)=>{m({phase:d,current:x,total:j,details:f})},r=()=>q(null,null,function*(){if(!a){o("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel Ø£ÙˆÙ„Ø§Ù‹");return}t(!0),o(null),l("");try{g("Ù‚Ø±Ø§Ø¡Ø©",1,6,"Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Excel...");const d=yield pe.parseExcelWithSpecs(a);l(`âœ… ØªÙ… Ù‚Ø±Ø§Ø¡Ø© ${d.length} Ø¨Ù†Ø¯ Ù…Ù† Ø§Ù„Ù…Ù„Ù`),yield new Promise(N=>setTimeout(N,500)),g("ØªØ­Ù„ÙŠÙ„",2,6,`Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ù…ÙˆØ§ØµÙØ§Øª ${d.length} Ø¨Ù†Ø¯...`);const x=[];let j=0;for(let N=0;N<d.length;N++){const C=d[N],P=M.analyzeSpecifications(C.serialNumber,C.category,C.itemName,C.description,C.specifications,C.unit,C.quantity,C.unitPrice);x.push(P),j+=P.extractedActivities.length,N%50===0&&(g("ØªØ­Ù„ÙŠÙ„",2,6,`ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù†Ø¯ ${N+1}/${d.length} - ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ${j} Ù†Ø´Ø§Ø·`),yield new Promise(I=>setTimeout(I,10)))}l(`âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ${j} Ù†Ø´Ø§Ø· Ù…Ù† ${d.length} Ø¨Ù†Ø¯`),yield new Promise(N=>setTimeout(N,500)),g("ØªØ­ÙˆÙŠÙ„",3,6,"Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ Ø²Ù…Ù†ÙŠ...");let f=M.convertToScheduleActivities(x,new Date(u));l(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${f.length} Ù†Ø´Ø§Ø· ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ`),yield new Promise(N=>setTimeout(N,500)),g("ÙØ­Øµ",4,6,"Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ..."),$.applyComplianceAdjustments(f);const v=$.generateComplianceReport(f);l(`âœ… ÙØ­Øµ SBC: ${v.compliantActivities} Ù…Ù…ØªØ«Ù„ØŒ ${v.nonCompliantActivities} ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„`),yield new Promise(N=>setTimeout(N,500)),g("Ø¹Ù„Ø§Ù‚Ø§Øª",5,6,"Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø¨ÙŠÙ† Ø§Ù„Ø£Ù†Ø´Ø·Ø©..."),L.autoGenerateDependencies(f),l("âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©"),yield new Promise(N=>setTimeout(N,500)),g("CPM",6,6,"Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬...");const S=L.performCPM(f,new Date(u));f=f.map(N=>S.criticalActivities.find(P=>P.id===N.id)||N),l(`âœ… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬: ${S.criticalPath.length} Ù†Ø´Ø§Ø· Ø­Ø±Ø¬ | Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${S.projectDuration} ÙŠÙˆÙ…`),yield new Promise(N=>setTimeout(N,500));const k=xe(x,f);p(f,k,d),m(null),l(`
                ğŸ‰ ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­!
                
                ğŸ“Š ${d.length} Ø¨Ù†Ø¯ ÙÙŠ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©
                âš¡ ${f.length} Ù†Ø´Ø§Ø· ØªÙØµÙŠÙ„ÙŠ
                ğŸ¯ ${S.criticalPath.length} Ù†Ø´Ø§Ø· Ø­Ø±Ø¬
                ğŸ“… ${S.projectDuration} ÙŠÙˆÙ… Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
                âœ… ${v.compliancePercentage.toFixed(1)}% Ø§Ù…ØªØ«Ø§Ù„ SBC
            `)}catch(d){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯:",d),o(`Ø®Ø·Ø£: ${d.message}`),m(null)}finally{t(!1)}});return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(_,{className:"w-6 h-6 ml-2 text-yellow-500"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ - Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg mb-6",children:[e.jsxs("h3",{className:"font-bold text-blue-800 dark:text-blue-200 mb-2 flex items-center",children:[e.jsx(re,{className:"w-5 h-5 ml-2"}),"Ù…Ø§ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ"]}),e.jsxs("ul",{className:"text-sm space-y-1 mr-4 text-blue-700 dark:text-blue-300",children:[e.jsx("li",{children:"âœ… ÙŠÙ‚Ø±Ø£ Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯ØŒ Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ø¯ØŒ ÙˆØ§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©"}),e.jsx("li",{children:"âœ… ÙŠØ­Ù„Ù„ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª ÙˆÙŠØ³ØªØ®Ø±Ø¬ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø®ÙÙŠØ© (Ø­ÙØ±ØŒ Ø®Ø±Ø³Ø§Ù†Ø©ØŒ Ø­Ø¯ÙŠØ¯ØŒ Ø¹Ø²Ù„ØŒ Ø±Ø¯Ù…...)"}),e.jsx("li",{children:"âœ… ÙƒÙ„ Ø¨Ù†Ø¯ ÙŠØªØ­ÙˆÙ„ Ø¥Ù„Ù‰ Ø¹Ø¯Ø© Ø£Ù†Ø´Ø·Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"}),e.jsx("li",{children:"âœ… 470 Ø¨Ù†Ø¯ â†’ 1500+ Ù†Ø´Ø§Ø· ØªÙØµÙŠÙ„ÙŠ"}),e.jsx("li",{children:"âœ… ÙŠÙÙ‡Ù… ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"}),e.jsx("input",{type:"date",value:u,onChange:d=>y(d.target.value),className:"w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ù…Ù„Ù Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© (Excel)"}),e.jsx("input",{type:"file",onChange:h,accept:".xlsx,.xls",className:"w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700",disabled:n}),a&&e.jsxs("p",{className:"text-sm text-green-600 mt-2 flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 ml-1"}),"ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ",a.name]})]}),b&&e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-semibold",children:b.phase}),e.jsxs("span",{className:"text-sm text-gray-600",children:[b.current,"/",b.total]})]}),e.jsx("div",{className:"w-full bg-gray-300 dark:bg-gray-700 rounded-full h-3 mb-2",children:e.jsx("div",{className:"bg-indigo-600 h-3 rounded-full transition-all duration-300",style:{width:`${b.current/b.total*100}%`}})}),e.jsx("p",{className:"text-sm text-gray-600",children:b.details})]}),i&&!c&&e.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 rounded-lg whitespace-pre-line",children:i}),c&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 rounded-lg flex items-start",children:[e.jsx(ie,{className:"w-5 h-5 ml-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:c})]}),e.jsx("button",{onClick:r,disabled:!a||n,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 px-6 rounded-lg hover:from-indigo-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-500 font-bold text-lg flex items-center justify-center shadow-lg",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-3"}),"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-6 h-6 ml-2"}),"ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"]})})]})]})};function xe(p,a){const s=new Map;for(const n of p){const t=n.category||"99";s.has(t)||s.set(t,{code:t,level:1,name:`ÙØ¦Ø© ${t}`,activities:[],totalDuration:0,totalCost:0});const i=s.get(t),l=a.filter(c=>c.wbsCode.startsWith(t));i.activities.push(...l),i.totalDuration=Math.max(i.totalDuration,...l.map(c=>c.duration)),i.totalCost+=n.originalItem.total}return Array.from(s.values())}typeof window!="undefined"&&typeof pdfjsLib!="undefined"&&(pdfjsLib.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`);const be=(p,a)=>{const s=p.map(i=>({"Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯":i.id,Ø§Ù„ÙˆØµÙ:i.item,Ø§Ù„ÙˆØ­Ø¯Ø©:i.unit,Ø§Ù„ÙƒÙ…ÙŠØ©:i.quantity,"Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©":i.unitPrice,Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:i.total})),n=XLSX.utils.json_to_sheet(s),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,n,"Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"),XLSX.writeFile(t,`${a}_${new Date().toISOString().split("T")[0]}.xlsx`)},fe=p=>new Promise((a,s)=>{const n=new FileReader;n.onload=t=>{var i;try{const l=new Uint8Array((i=t.target)==null?void 0:i.result),c=XLSX.read(l,{type:"array"}),o=c.SheetNames[0],u=c.Sheets[o],y=XLSX.utils.sheet_to_json(u,{header:1}),b=[{keys:["Ø±Ù‚Ù…","item","no"],col:"id"},{keys:["ÙˆØµÙ","description","Ø¨Ù†Ø¯"],col:"description"},{keys:["ÙˆØ­Ø¯Ø©","unit"],col:"unit"},{keys:["ÙƒÙ…ÙŠØ©","quantity","qty"],col:"quantity"},{keys:["Ø³Ø¹Ø±","price","unit price"],col:"unitPrice"},{keys:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ","total","amount"],col:"total"}];let m=-1,h={};for(let d=0;d<y.length&&m===-1;d++){const x=y[d];for(let j=0;j<x.length;j++){const f=String(x[j]||"").toLowerCase().trim();for(const v of b)if(v.keys.some(S=>f.includes(S))){h[v.col]=j,m=d;break}}}if(m===-1||Object.keys(h).length<4)return s(new Error("ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù."));const g=[];let r=1;for(let d=m+1;d<y.length;d++){const x=y[d],j=String(x[h.description]||"").trim(),f=String(x[h.unit]||"").trim(),v=Number(x[h.quantity])||0,S=Number(x[h.unitPrice])||0;let k=h.total!==void 0&&Number(x[h.total])||0;const N=h.id!==void 0?String(x[h.id]||"").trim():`f-import-${r}`;k===0&&v>0&&S>0?k=v*S:k>0&&S===0&&v>0,j&&(v>0||k>0)&&(g.push({id:N||`f-import-${r++}`,item:j,unit:f,quantity:v,unitPrice:S,total:k}),r++)}if(g.length===0)return s(new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨Ù†ÙˆØ¯ ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù."));a(g)}catch(l){s(new Error("ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù Excel."))}},n.onerror=()=>s(new Error("ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù.")),n.readAsArrayBuffer(p)}),ye=(p,a)=>{const s=p.map(i=>({"Ø±Ù‚Ù… Ø§Ù„Ù…Ù‡Ù…Ø©":i.id,"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·":i.name,"ÙƒÙˆØ¯ WBS":i.wbsCode||"N/A","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡":i.start,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡":i.end,Ø§Ù„Ø­Ø§Ù„Ø©:i.status==="To Do"?"ØºÙŠØ± Ù…ÙÙ†Ø¬Ø²":i.status==="In Progress"?"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°":"Ù…ÙÙ†Ø¬Ø²","Ø§Ù„ØªÙ‚Ø¯Ù… %":i.progress,Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:i.priority==="High"?"Ø¹Ø§Ù„ÙŠØ©":i.priority==="Medium"?"Ù…ØªÙˆØ³Ø·Ø©":"Ù…Ù†Ø®ÙØ¶Ø©"})),n=XLSX.utils.json_to_sheet(s),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,n,"Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ"),XLSX.writeFile(t,`${a}_SCHEDULE_${new Date().toISOString().split("T")[0]}.xlsx`)},je=({onImportSuccess:p})=>{const[a,s]=w.useState(null),[n,t]=w.useState(!1),[i,l]=w.useState(null),[c,o]=w.useState(""),[u,y]=w.useState("file"),b=h=>{var r;const g=((r=h.target.files)==null?void 0:r[0])||null;g&&g.name.endsWith(".xlsx")?(s(g),l(null)):(s(null),l("ØµÙŠØºØ© Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel (.xlsx)"))},m=()=>q(null,null,function*(){t(!0),l(null);try{let h=[],g="";if(u==="file"){if(!a)throw new Error("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹.");g=a.name,h=yield fe(a)}else g="Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ",h=c.split(`
`).filter(d=>d.trim()!=="").map((d,x)=>{const j=d.split("|").map(Q=>Q.trim()),[f,v,S,k,N]=j,C=Number(S)||0,P=Number(k)||0,I=Number(N)||0;let F=0;return I>0?F=I:P===0&&C>0&&j.length>=4?F=C*Number(j[3]):F=C*P,{id:`f-manual-${x+1}`,item:f,unit:v,quantity:C,unitPrice:P,total:F}});if(h.length===0)throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£ÙŠ Ø¨Ù†ÙˆØ¯.");p(h,g),alert(`ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${h.length} Ø¨Ù†Ø¯ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù† ${g}.`),s(null),o("")}catch(h){l(h.message)}finally{t(!1)}});return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(le,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>y("file"),className:`px-4 py-2 ${u==="file"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù"}),e.jsx("button",{onClick:()=>y("manual"),className:`px-4 py-2 ${u==="manual"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ"})]})}),e.jsxs("div",{className:"space-y-4",children:[u==="file"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ø§Ø®ØªØ± Ù…Ù„Ù Excel (.xlsx)"}),e.jsx("input",{type:"file",onChange:b,accept:".xlsx",className:"w-full p-2 border rounded-lg dark:bg-slate-800 dark:border-slate-700"}),a&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ø¯Ø¯: ",a.name]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ø£Ø¯Ø®Ù„ Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© (ÙƒÙ„ Ø¨Ù†Ø¯ ÙÙŠ Ø³Ø·Ø±)"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"ğŸ“ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚:"}),e.jsx("p",{children:"ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯ | Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„ÙƒÙ…ÙŠØ© | Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx("p",{className:"mt-2 font-semibold",children:"âœ… Ù…Ø«Ø§Ù„ ØµØ­ÙŠØ­:"}),e.jsx("p",{className:"font-mono",children:"Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© | Ù…3 | 100 | 500 | 50000"}),e.jsx("p",{className:"mt-1 font-mono",children:"Ø£Ø¹Ù…Ø§Ù„ Ø­ÙØ± | Ù…3 | 200 | 50"}),e.jsx("p",{className:"mt-2 text-xs text-amber-600 dark:text-amber-400",children:"ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¥Ø°Ø§ ÙƒØ§Ù† Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© = 0ØŒ Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø©"})]}),e.jsx("textarea",{value:c,onChange:h=>o(h.target.value),placeholder:`ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯ | Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„ÙƒÙ…ÙŠØ© | Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
Ù…Ø«Ø§Ù„: Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© | Ù…3 | 100 | 500 | 50000
Ù…Ø«Ø§Ù„: Ø£Ø¹Ù…Ø§Ù„ Ø­ÙØ± | Ù…3 | 200 | 50`,rows:8,className:"w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700 font-mono text-sm"})]}),i&&e.jsx("p",{className:"text-sm text-red-500",children:i}),e.jsx("button",{onClick:m,disabled:n,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-gray-400 font-semibold",children:n?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯"})]})]})},we=({financials:p,schedule:a,onUpdateFinancials:s})=>{const[n,t]=w.useState(""),[i,l]=w.useState({item:"",unit:"",quantity:0,unitPrice:0}),c=w.useMemo(()=>p.filter(m=>m.item.toLowerCase().includes(n.toLowerCase())||m.id.toLowerCase().includes(n.toLowerCase())),[p,n]),o=()=>{if(!i.item.trim())return;const m=A(D({},i),{id:`f-manual-${Date.now()}`,total:i.quantity*i.unitPrice});s([...p,m]),l({item:"",unit:"",quantity:0,unitPrice:0})},u=(m,h,g)=>{s(p.map(r=>{if(r.id===m){const d=A(D({},r),{[h]:g});return(h==="quantity"||h==="unitPrice")&&(d.total=Number(d.quantity)*Number(d.unitPrice)),d}return r}))},y=m=>{s(p.filter(h=>h.id!==m))},b=()=>{be(p,"BOQ_Manual_Export")};return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Ø¥Ø¯Ø§Ø±Ø© Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"})]}),e.jsxs("button",{onClick:b,disabled:p.length===0,className:"flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-semibold",children:[e.jsx(T,{className:"w-4 h-4"})," ØªØµØ¯ÙŠØ± Excel"]})]}),e.jsxs("div",{className:"border p-4 rounded-lg mb-6 bg-slate-50 dark:bg-slate-800/50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯ Ø¬Ø¯ÙŠØ¯"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsx("input",{placeholder:"ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯",value:i.item,onChange:m=>l(A(D({},i),{item:m.target.value})),className:"col-span-2 p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{placeholder:"Ø§Ù„ÙˆØ­Ø¯Ø©",value:i.unit,onChange:m=>l(A(D({},i),{unit:m.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"number",placeholder:"Ø§Ù„ÙƒÙ…ÙŠØ©",value:i.quantity,onChange:m=>l(A(D({},i),{quantity:Number(m.target.value)})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"number",placeholder:"Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©",value:i.unitPrice,onChange:m=>l(A(D({},i),{unitPrice:Number(m.target.value)})),className:"p-2 border rounded-lg dark:bg-slate-700"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs("p",{className:"font-bold text-lg",children:["Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",(i.quantity*i.unitPrice).toLocaleString()," Ø±ÙŠØ§Ù„"]}),e.jsxs("button",{onClick:o,className:"flex items-center gap-2 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 font-semibold",children:[e.jsx(W,{className:"w-4 h-4"})," Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯"]})]})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(U,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„ÙˆØµÙ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯...",value:n,onChange:m=>t(m.target.value),className:"w-full p-2 pr-10 border rounded-lg dark:bg-slate-800"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ù†ÙˆØ¯ (",c.length," Ù…Ù† ",p.length,")"]}),e.jsxs("table",{className:"min-w-full text-right border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800",children:e.jsx("tr",{children:["Ø§Ù„ÙˆØµÙ","Ø§Ù„ÙˆØ­Ø¯Ø©","Ø§Ù„ÙƒÙ…ÙŠØ©","Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©","Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ","Ø¥Ø¬Ø±Ø§Ø¡"].map(m=>e.jsx("th",{className:"p-3 text-sm font-medium border-b",children:m},m))})}),e.jsx("tbody",{children:c.map(m=>e.jsxs("tr",{className:"border-b hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{value:m.item,onChange:h=>u(m.id,"item",h.target.value),className:"w-full p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{value:m.unit,onChange:h=>u(m.id,"unit",h.target.value),className:"w-20 p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",value:m.quantity,onChange:h=>u(m.id,"quantity",Number(h.target.value)),className:"w-24 p-1 border rounded dark:bg-slate-700 text-right"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",value:m.unitPrice,onChange:h=>u(m.id,"unitPrice",Number(h.target.value)),className:"w-24 p-1 border rounded dark:bg-slate-700 text-right"})}),e.jsx("td",{className:"p-2 font-bold text-blue-600",children:m.total.toLocaleString()}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>y(m.id),className:"text-red-600 hover:text-red-800",children:e.jsx(V,{className:"w-4 h-4"})})})]},m.id))})]})]})]})},Ne=({financials:p})=>{const a=w.useMemo(()=>p.reduce((n,t)=>n+t.total,0),[p]),s=w.useMemo(()=>p.length>0?a/p.length:0,[a,p]);return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ce,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø§Ù…"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[a.toLocaleString()," Ø±ÙŠØ§Ù„"]})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p.length})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙƒÙ„ÙØ©"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[s.toLocaleString()," Ø±ÙŠØ§Ù„"]})]})]})]})},ve=({schedule:p,financials:a,onUpdateSchedule:s})=>{const[n,t]=w.useState(p),[i,l]=w.useState("");w.useEffect(()=>{t(p)},[p]);const c=w.useMemo(()=>n.filter(g=>g.name.toLowerCase().includes(i.toLowerCase())||g.id.toString().includes(i)),[n,i]),[o,u]=w.useState({name:"",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],status:"To Do",priority:"Medium",wbsCode:"",category:"",dependencies:[]}),y=()=>{if(!o.name.trim())return;const g=A(D({},o),{id:Date.now(),progress:0}),r=[...n,g];t(r),s(r),u({name:"",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],status:"To Do",priority:"Medium",wbsCode:"",category:"",dependencies:[]})},b=(g,r,d)=>{const x=n.map(j=>j.id===g?A(D({},j),{[r]:d}):j);t(x),s(x)},m=g=>{const r=n.filter(d=>d.id!==g);t(r),s(r)},h=()=>{ye(p,"Project_Schedule")};return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(de,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ"})]}),e.jsxs("button",{onClick:h,disabled:p.length===0,className:"flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-semibold",children:[e.jsx(T,{className:"w-4 h-4"})," ØªØµØ¯ÙŠØ± Excel"]})]}),e.jsxs("div",{className:"border p-4 rounded-lg mb-6 bg-slate-50 dark:bg-slate-800/50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsx("input",{placeholder:"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·",value:o.name,onChange:g=>u(A(D({},o),{name:g.target.value})),className:"col-span-2 p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"date",value:o.start,onChange:g=>u(A(D({},o),{start:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"date",value:o.end,onChange:g=>u(A(D({},o),{end:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsxs("select",{value:o.status,onChange:g=>u(A(D({},o),{status:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"To Do",children:"ØºÙŠØ± Ù…ÙÙ†Ø¬Ø²"}),e.jsx("option",{value:"In Progress",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"}),e.jsx("option",{value:"Done",children:"Ù…ÙÙ†Ø¬Ø²"})]}),e.jsxs("select",{value:o.priority,onChange:g=>u(A(D({},o),{priority:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"High",children:"Ø¹Ø§Ù„ÙŠØ©"}),e.jsx("option",{value:"Medium",children:"Ù…ØªÙˆØ³Ø·Ø©"}),e.jsx("option",{value:"Low",children:"Ù…Ù†Ø®ÙØ¶Ø©"})]})]}),e.jsxs("button",{onClick:y,className:"mt-3 flex items-center gap-2 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 font-semibold",children:[e.jsx(W,{className:"w-4 h-4"})," Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©"]})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(U,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯...",value:i,onChange:g=>l(g.target.value),className:"w-full p-2 pr-10 border rounded-lg dark:bg-slate-800"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… (",c.length," Ù…Ù† ",n.length,")"]}),e.jsxs("table",{className:"min-w-full text-right border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800",children:e.jsx("tr",{children:["Ø§Ù„Ø§Ø³Ù…","Ø¨Ø¯Ø¡","Ø§Ù†ØªÙ‡Ø§Ø¡","Ø­Ø§Ù„Ø©","ØªÙ‚Ø¯Ù… %","Ø¥Ø¬Ø±Ø§Ø¡"].map(g=>e.jsx("th",{className:"p-3 text-sm font-medium border-b",children:g},g))})}),e.jsx("tbody",{children:c.map(g=>e.jsxs("tr",{className:"border-b hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{value:g.name,onChange:r=>b(g.id,"name",r.target.value),className:"w-full p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",value:g.start,onChange:r=>b(g.id,"start",r.target.value),className:"p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",value:g.end,onChange:r=>b(g.id,"end",r.target.value),className:"p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{value:g.status,onChange:r=>b(g.id,"status",r.target.value),className:"p-1 border rounded dark:bg-slate-700",children:[e.jsx("option",{value:"To Do",children:"ØºÙŠØ± Ù…ÙÙ†Ø¬Ø²"}),e.jsx("option",{value:"In Progress",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"}),e.jsx("option",{value:"Done",children:"Ù…ÙÙ†Ø¬Ø²"})]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",value:g.progress,onChange:r=>b(g.id,"progress",Number(r.target.value)),min:"0",max:"100",className:"w-20 p-1 border rounded dark:bg-slate-700 text-right"})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>m(g.id),className:"text-red-600 hover:text-red-800",children:e.jsx(V,{className:"w-4 h-4"})})})]},g.id))})]})]})]})},Ae=({project:p,onUpdateFinancials:a,onUpdateSchedule:s})=>{const[n,t]=w.useState(p.data.financials||[]),[i,l]=w.useState(p.data.schedule||[]),[c,o]=w.useState("import"),[u,y]=w.useState([]),[b,m]=w.useState([]),[h,g]=w.useState([]);w.useEffect(()=>{t(p.data.financials||[]),l(p.data.schedule||[])},[p]);const r=(f,v)=>{const S=[...n,...f];t(S),a(p.id,S)},d=f=>{t(f),a(p.id,f)},x=f=>{l(f),s(p.id,f)},j=(f,v,S)=>{y(f),m(v),g(S),o("noufal-view");const k=f.filter(C=>C.isCritical).length,N=S.length>0?(f.length/S.length).toFixed(1):"0";alert(`âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø¨Ù†Ø¬Ø§Ø­!

ğŸ“Š Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠØ©: ${S.length} Ø¨Ù†Ø¯
ğŸ”§ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©: ${f.length} Ù†Ø´Ø§Ø·
ğŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙˆØ³Ø¹: ${N}x
âš ï¸ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©: ${k} Ù†Ø´Ø§Ø·
ğŸ“ Ø£Ù‚Ø³Ø§Ù… WBS: ${v.length} Ù‚Ø³Ù…

ØªÙ… ØªØ­Ù„ÙŠÙ„ Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø¨Ù†ÙˆØ¯ ÙˆØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ Ø¥Ù„Ù‰ Ø£Ù†Ø´Ø·Ø© Ù…ØªØ¹Ø¯Ø¯Ø©!`)};return e.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø§Øª ÙˆØ§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠØ© - Ù†Ø¸Ø§Ù… NOUFAL Ø§Ù„Ù…ØªÙ‚Ø¯Ù…"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>o("import"),className:`px-4 py-3 font-semibold ${c==="import"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"1. Ø§Ø³ØªÙŠØ±Ø§Ø¯"}),e.jsx("button",{onClick:()=>o("manage"),className:`px-4 py-3 font-semibold ${c==="manage"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"2. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"}),e.jsx("button",{onClick:()=>o("analysis"),className:`px-4 py-3 font-semibold ${c==="analysis"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"3. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"}),e.jsx("button",{onClick:()=>o("schedule"),className:`px-4 py-3 font-semibold ${c==="schedule"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"4. Ø¬Ø¯ÙˆÙ„ ÙŠØ¯ÙˆÙŠ"}),e.jsx("button",{onClick:()=>o("noufal-generate"),className:`px-4 py-3 font-semibold ${c==="noufal-generate"?"border-b-2 border-green-500 text-green-600":"text-gray-500"}`,children:"5. â˜… ØªÙˆÙ„ÙŠØ¯ NOUFAL"}),e.jsx("button",{onClick:()=>o("noufal-view"),className:`px-4 py-3 font-semibold ${c==="noufal-view"?"border-b-2 border-green-500 text-green-600":"text-gray-500"}`,disabled:u.length===0,children:"6. â˜… Ø¹Ø§Ø±Ø¶ NOUFAL"})]})}),e.jsxs("div",{className:"mt-6",children:[c==="import"&&e.jsx(je,{onImportSuccess:r}),c==="manage"&&e.jsx(we,{financials:n,schedule:i,onUpdateFinancials:d}),c==="analysis"&&e.jsx(Ne,{financials:n}),c==="schedule"&&e.jsx(ve,{schedule:i,financials:n,onUpdateSchedule:x}),c==="noufal-generate"&&e.jsx(ge,{onScheduleGenerated:j}),c==="noufal-view"&&e.jsx(he,{activities:u,wbs:b,projectName:p.name})]})]})};export{Ae as BOQManualManager,Ae as default};
