var Z=Object.defineProperty,z=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var X=(p,r,s)=>r in p?Z(p,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[r]=s,C=(p,r)=>{for(var s in r||(r={}))J.call(r,s)&&X(p,s,r[s]);if(_)for(var s of _(r))Y.call(r,s)&&X(p,s,r[s]);return p},T=(p,r)=>z(p,K(r));var L=(p,r,s)=>new Promise((n,t)=>{var i=l=>{try{c(s.next(l))}catch(h){t(h)}},o=l=>{try{c(s.throw(l))}catch(h){t(h)}},c=l=>l.done?n(l.value):Promise.resolve(l.value).then(i,o);c((s=s.apply(p,r)).next())});import{r as w,j as e}from"./react-vendor-D4cZjflF.js";import{a9 as ee,ae as F,ay as te,b5 as se,F as re,a1 as ae,Z as O,af as ne,b6 as ie,aB as oe,U as le,T as ce,aL as U,$ as V,ah as G,h as de,aG as ue}from"./icons-lib-mPL1tuN6.js";import{_ as me}from"./vendor-large-CMFjXBcn.js";import"./vendor-DhnXlGBj.js";class E{static performCPM(r,s){const n=this.cloneActivities(r);this.forwardPass(n,s);const t=this.backwardPass(n),{criticalPath:i,floatAnalysis:o}=this.calculateFloatAndCriticalPath(n),c=this.addDays(s,t),l=n.filter(h=>i.includes(h.id));return{criticalPath:i,projectDuration:t,projectStart:s.toISOString().split("T")[0],projectFinish:c.toISOString().split("T")[0],criticalActivities:l,floatAnalysis:o}}static forwardPass(r,s){const n=this.topologicalSort(r);for(const t of n){let i=s;if(t.dependencies.length>0)for(const c of t.dependencies){const l=r.find(f=>f.id===c.predecessorId);if(!l)continue;let h;switch(c.type){case"FS":h=this.parseDate(l.earlyFinish),h=this.addDays(h,c.lag);break;case"SS":h=this.parseDate(l.earlyStart),h=this.addDays(h,c.lag);break;case"FF":h=this.parseDate(l.earlyFinish),h=this.addDays(h,c.lag-t.duration);break;case"SF":h=this.parseDate(l.earlyStart),h=this.addDays(h,c.lag-t.duration);break;default:h=s}h>i&&(i=h)}const o=this.addDays(i,t.duration);t.earlyStart=i.toISOString().split("T")[0],t.earlyFinish=o.toISOString().split("T")[0],t.startDate=t.earlyStart,t.endDate=t.earlyFinish}}static backwardPass(r){var o;let s=new Date(0);for(const c of r){const l=this.parseDate(c.earlyFinish);l>s&&(s=l)}const n=this.parseDate(r.reduce((c,l)=>l.earlyStart<c?l.earlyStart:c,((o=r[0])==null?void 0:o.earlyStart)||"")),t=Math.ceil((s.getTime()-n.getTime())/(1e3*60*60*24)),i=this.topologicalSort(r).reverse();for(const c of i){let l=s;const h=r.filter(b=>b.dependencies.some(d=>d.predecessorId===c.id));if(h.length>0)for(const b of h){const d=b.dependencies.find(g=>g.predecessorId===c.id);if(!d)continue;let u;switch(d.type){case"FS":u=this.parseDate(b.lateStart),u=this.addDays(u,-d.lag);break;case"SS":u=this.parseDate(b.lateStart),u=this.addDays(u,-d.lag),u=this.addDays(u,-c.duration);break;case"FF":u=this.parseDate(b.lateFinish),u=this.addDays(u,-d.lag);break;case"SF":u=this.parseDate(b.lateFinish),u=this.addDays(u,-d.lag),u=this.addDays(u,-c.duration);break;default:u=s}u<l&&(l=u)}const f=this.addDays(l,-c.duration);c.lateFinish=l.toISOString().split("T")[0],c.lateStart=f.toISOString().split("T")[0]}return t}static calculateFloatAndCriticalPath(r){const s=[],n=[];for(const t of r){const i=this.parseDate(t.lateStart),o=this.parseDate(t.earlyStart),c=Math.round((i.getTime()-o.getTime())/(1e3*60*60*24));let l=c;const h=r.filter(f=>f.dependencies.some(b=>b.predecessorId===t.id));if(h.length>0){const f=Math.min(...h.map(d=>this.parseDate(d.earlyStart).getTime())),b=this.parseDate(t.earlyFinish).getTime();l=Math.round((f-b)/(1e3*60*60*24))}t.totalFloat=c,t.freeFloat=l,t.isCritical=c===0,t.isCritical&&s.push(t.id),n.push({activityId:t.id,totalFloat:c,freeFloat:l})}return{criticalPath:s,floatAnalysis:n}}static topologicalSort(r){const s=[],n=new Set,t=new Set,i=o=>{if(!t.has(o.id)&&!n.has(o.id)){t.add(o.id);for(const c of o.dependencies){const l=r.find(h=>h.id===c.predecessorId);l&&i(l)}t.delete(o.id),n.add(o.id),s.push(o)}};for(const o of r)n.has(o.id)||i(o);return s}static cloneActivities(r){return r.map(s=>C({},s))}static parseDate(r){return r?new Date(r):new Date}static addDays(r,s){const n=new Date(r);return n.setDate(n.getDate()+s),n}static autoGenerateDependencies(r){const s=new Map;for(const n of r){const t=n.wbsCode.split(".").slice(0,-1).join(".");s.has(t)||s.set(t,[]),s.get(t).push(n)}s.forEach(n=>{const t=n.sort((i,o)=>i.wbsCode.localeCompare(o.wbsCode));for(let i=1;i<t.length;i++){const o=t[i],c=t[i-1];o.dependencies.some(l=>l.predecessorId===c.id)||o.dependencies.push({predecessorId:c.id,type:"FS",lag:0}),c.successors.includes(o.id)||c.successors.push(o.id)}}),this.addConstructionLogicDependencies(r)}static addConstructionLogicDependencies(r){const s=[{before:"Formwork",after:"Rebar",type:"FS"},{before:"Rebar",after:"Concrete Pour",type:"FS"},{before:"Concrete Pour",after:"Curing",type:"FS"},{before:"Curing",after:"Formwork Stripping",type:"FS"},{before:"Blockwork",after:"Plastering",type:"FS"},{before:"Plastering",after:"Tiling",type:"FS"},{before:"Plastering",after:"Painting",type:"FS"}];for(const n of s){const t=r.filter(o=>o.name.includes(n.before)||o.description.includes(n.before)),i=r.filter(o=>o.name.includes(n.after)||o.description.includes(n.after));for(const o of t)for(const c of i)(o.boqItemId===c.boqItemId||this.areWBSCodesAdjacent(o.wbsCode,c.wbsCode))&&(c.dependencies.some(l=>l.predecessorId===o.id)||c.dependencies.push({predecessorId:o.id,type:n.type,lag:0}),o.successors.includes(c.id)||o.successors.push(c.id))}}static areWBSCodesAdjacent(r,s){const n=r.split("."),t=s.split(".");return n.slice(0,-1).join(".")===t.slice(0,-1).join(".")}}const B=class B{static checkCompliance(r){const s=[];for(const n of this.codes)for(const t of n.requirements)if(t.applicableActivities.some(o=>r.name.toLowerCase().includes(o.toLowerCase())||r.description.toLowerCase().includes(o.toLowerCase())||r.category.toLowerCase().includes(o.toLowerCase()))){let o=!0,c="";t.minimumDuration&&r.duration<t.minimumDuration&&(o=!1,c=`Duration ${r.duration} days is less than required ${t.minimumDuration} days`),s.push({code:t.ruleId,description:`${t.descriptionAr} | ${t.description}`,minimumDuration:t.minimumDuration,requiredInspections:t.requiredInspections,complianceNotes:c||"Activity meets SBC requirements",isCompliant:o})}return s}static applyComplianceAdjustments(r){for(const s of r){const n=this.checkCompliance(s);s.sbcRequirements=n;for(const t of n)!t.isCompliant&&t.minimumDuration&&s.duration<t.minimumDuration&&(s.duration=t.minimumDuration)}}static getAllCodes(){return this.codes}static getCodeRequirements(r){return this.codes.find(s=>s.code===r)||null}static generateComplianceReport(r){let s=0;const n=[];for(const o of r){const c=o.sbcRequirements||this.checkCompliance(o);c.some(h=>!h.isCompliant)?n.push({activityId:o.id,activityName:o.name,violations:c.filter(h=>!h.isCompliant)}):c.length>0&&s++}const t=s+n.length,i=t>0?s/t*100:100;return{totalActivities:r.length,compliantActivities:s,nonCompliantActivities:n.length,compliancePercentage:i,violations:n}}static getInspectionSchedule(r){const s=[];for(const n of r){const t=n.sbcRequirements||this.checkCompliance(n);for(const i of t)if(i.requiredInspections)for(const o of i.requiredInspections){const c=n.startDate;s.push({activityId:n.id,activityName:n.name,inspectionDate:c,inspectionType:o,sbcReference:i.code})}}return s}};B.codes=[{code:"SBC-301",title:"Concrete Structures",titleAr:"Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø®Ø±Ø³Ø§Ù†ÙŠØ©",requirements:[{ruleId:"SBC-301-7.1",description:"Minimum curing period for concrete: 7 days",descriptionAr:"ÙØªØ±Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©: 7 Ø£ÙŠØ§Ù… ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:7,requiredInspections:["Concrete Strength Test","Curing Verification"],applicableActivities:["Concrete Curing","Curing","Ù…Ø¹Ø§Ù„Ø¬Ø©"],compliance:"Mandatory"},{ruleId:"SBC-301-6.3",description:"Formwork removal: Minimum 7 days for slabs, 3 days for walls/columns",descriptionAr:"ÙÙƒ Ø§Ù„Ù†Ø¬Ø§Ø±Ø©: 7 Ø£ÙŠØ§Ù… Ù„Ù„Ø¨Ù„Ø§Ø·Ø§ØªØŒ 3 Ø£ÙŠØ§Ù… Ù„Ù„Ø¬Ø¯Ø±Ø§Ù† ÙˆØ§Ù„Ø£Ø¹Ù…Ø¯Ø©",minimumDuration:3,requiredInspections:["Concrete Strength Verification"],applicableActivities:["Formwork Stripping","Stripping","ÙÙƒ Ø§Ù„Ù†Ø¬Ø§Ø±Ø©"],compliance:"Mandatory"},{ruleId:"SBC-301-5.2",description:"Concrete placement must be continuous without cold joints",descriptionAr:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø© Ù…ØªÙˆØ§ØµÙ„Ø§Ù‹ Ø¨Ø¯ÙˆÙ† ÙˆØµÙ„Ø§Øª Ø¨Ø§Ø±Ø¯Ø©",requiredInspections:["Pour Inspection","Quality Control"],applicableActivities:["Concrete Pour","ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©"],compliance:"Mandatory"},{ruleId:"SBC-301-4.1",description:"Concrete temperature during placement: 10-32Â°C",descriptionAr:"Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØµØ¨: 10-32 Ø¯Ø±Ø¬Ø© Ù…Ø¦ÙˆÙŠØ©",requiredInspections:["Temperature Monitoring"],applicableActivities:["Concrete Pour"],compliance:"Mandatory"}]},{code:"SBC-304",title:"Steel Reinforcement",titleAr:"Ø­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠØ­",requirements:[{ruleId:"SBC-304-7.2",description:"Minimum concrete cover for reinforcement: 40mm for foundations, 20mm for slabs",descriptionAr:"Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ø®Ø±Ø³Ø§Ù†ÙŠ Ù„Ù„Ø­Ø¯ÙŠØ¯: 40Ù…Ù… Ù„Ù„Ø£Ø³Ø§Ø³Ø§ØªØŒ 20Ù…Ù… Ù„Ù„Ø¨Ù„Ø§Ø·Ø§Øª",requiredInspections:["Cover Verification","Pre-pour Inspection"],applicableActivities:["Rebar Installation","ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø­Ø¯ÙŠØ¯"],compliance:"Mandatory"},{ruleId:"SBC-304-6.1",description:"Rebar must be clean and free from rust, oil, or loose scale",descriptionAr:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø­Ø¯ÙŠØ¯ Ù†Ø¸ÙŠÙØ§Ù‹ ÙˆØ®Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„ØµØ¯Ø£ ÙˆØ§Ù„Ø²ÙŠÙˆØª",requiredInspections:["Material Inspection"],applicableActivities:["Rebar Installation"],compliance:"Mandatory"},{ruleId:"SBC-304-5.3",description:"Minimum lap splice length: 40 times bar diameter",descriptionAr:"Ø·ÙˆÙ„ Ø§Ù„ÙˆØµÙ„Ø©: 40 Ø¶Ø¹Ù Ù‚Ø·Ø± Ø§Ù„Ø³ÙŠØ® ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",requiredInspections:["Rebar Inspection"],applicableActivities:["Rebar Installation"],compliance:"Mandatory"}]},{code:"SBC-306",title:"Masonry Construction",titleAr:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡",requirements:[{ruleId:"SBC-306-4.2",description:"Block minimum compressive strength: 7 MPa",descriptionAr:"Ù…Ù‚Ø§ÙˆÙ…Ø© Ø§Ù„Ø¶ØºØ· Ù„Ù„Ø¨Ù„ÙˆÙƒ: 7 Ù…ÙŠØ¬Ø§ Ø¨Ø§Ø³ÙƒØ§Ù„ ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",requiredInspections:["Material Testing","Block Strength Test"],applicableActivities:["Blockwork","Ø§Ù„Ø¨Ù†Ø§Ø¡","Masonry"],compliance:"Mandatory"},{ruleId:"SBC-306-5.1",description:"Maximum water absorption for blocks: 10%",descriptionAr:"Ø£Ù‚ØµÙ‰ Ø§Ù…ØªØµØ§Øµ Ù„Ù„Ù…Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¨Ù„ÙˆÙƒ: 10%",requiredInspections:["Material Testing"],applicableActivities:["Blockwork"],compliance:"Mandatory"},{ruleId:"SBC-306-6.3",description:"Curing of masonry: Minimum 7 days",descriptionAr:"Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡: 7 Ø£ÙŠØ§Ù… ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:7,requiredInspections:["Curing Verification"],applicableActivities:["Blockwork","Masonry"],compliance:"Recommended"}]},{code:"SBC-308",title:"Tiles and Wall Finishes",titleAr:"Ø§Ù„Ø¨Ù„Ø§Ø· ÙˆØ§Ù„ØªØ´Ø·ÙŠØ¨Ø§Øª",requirements:[{ruleId:"SBC-308-3.1",description:"Minimum curing time for tile adhesive: 24 hours",descriptionAr:"ÙˆÙ‚Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ù„Ø§ØµÙ‚ Ø§Ù„Ø¨Ù„Ø§Ø·: 24 Ø³Ø§Ø¹Ø© ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:1,requiredInspections:["Adhesive Inspection"],applicableActivities:["Tiling","Ø§Ù„Ø¨Ù„Ø§Ø·","Tile"],compliance:"Mandatory"},{ruleId:"SBC-308-4.2",description:"Grouting should be done 24-48 hours after tile installation",descriptionAr:"ÙŠØ¬Ø¨ Ø¹Ù…Ù„ Ø§Ù„ÙÙˆØ§ØµÙ„ Ø¨Ø¹Ø¯ 24-48 Ø³Ø§Ø¹Ø© Ù…Ù† ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¨Ù„Ø§Ø·",requiredInspections:["Grouting Inspection"],applicableActivities:["Tiling"],compliance:"Mandatory"}]},{code:"SBC-403",title:"Painting and Coating",titleAr:"Ø§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø§Ø¡",requirements:[{ruleId:"SBC-403-5.1",description:"Surface must be clean, dry, and free from dust before painting",descriptionAr:"ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø³Ø·Ø­ Ù†Ø¸ÙŠÙØ§Ù‹ ÙˆØ¬Ø§ÙØ§Ù‹ ÙˆØ®Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„ØºØ¨Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø¯Ù‡Ø§Ù†",requiredInspections:["Surface Preparation Check"],applicableActivities:["Painting","Ø§Ù„Ø¯Ù‡Ø§Ù†","Paint"],compliance:"Mandatory"},{ruleId:"SBC-403-6.2",description:"Minimum drying time between coats: 24 hours",descriptionAr:"ÙˆÙ‚Øª Ø§Ù„Ø¬ÙØ§Ù Ø¨ÙŠÙ† Ø§Ù„Ø·Ø¨Ù‚Ø§Øª: 24 Ø³Ø§Ø¹Ø© ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰",minimumDuration:1,requiredInspections:["Coating Inspection"],applicableActivities:["Painting"],compliance:"Mandatory"},{ruleId:"SBC-403-4.3",description:"Ambient temperature during painting: 10-35Â°C",descriptionAr:"Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø­ÙŠØ·Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¯Ù‡Ø§Ù†: 10-35 Ø¯Ø±Ø¬Ø© Ù…Ø¦ÙˆÙŠØ©",requiredInspections:["Environmental Conditions Check"],applicableActivities:["Painting"],compliance:"Recommended"}]}];let M=B;class Q{static generateSCurve(r,s,n){const t=[],i=this.calculateTotalCost(r),o=new Date(s);let c=0,l=0;for(;o<=n;){const h=o.toISOString().split("T")[0],{progress:f,cost:b}=this.calculatePlannedAtDate(r,o);c+=f,l+=b;const{actualProgress:d,actualCost:u}=this.calculateActualAtDate(r,o),g=d/100*i;t.push({date:h,plannedProgress:Math.min(100,c),actualProgress:Math.min(100,d),plannedCost:l,actualCost:u,earnedValue:g}),o.setDate(o.getDate()+1)}return t}static calculatePlannedAtDate(r,s){let n=0,t=0;for(const i of r){const o=new Date(i.startDate),c=new Date(i.endDate);if(s>=o&&s<=c){const l=i.duration||1,h=100/l/r.length;n+=h;const f=this.calculateActivityCost(i);t+=f/l}}return{progress:n,cost:t}}static calculateActualAtDate(r,s){let n=0,t=0;for(const i of r)if(i.actualStart){const o=new Date(i.actualStart);s>=o&&(n+=(i.progress||0)/r.length,t+=this.calculateActivityCost(i)*((i.progress||0)/100))}return{actualProgress:n,actualCost:t}}static calculateTotalCost(r){return r.reduce((s,n)=>s+this.calculateActivityCost(n),0)}static calculateActivityCost(r){let s=0;for(const n of r.resources)n.dailyRate&&(s+=n.quantity*n.dailyRate*r.duration);return s||r.duration*1e3}static calculatePerformanceMetrics(r,s){const n=this.calculateTotalCost(r),{plannedProgress:t,plannedCost:i}=this.calculatePlannedAtDate(r,s),{actualProgress:o,actualCost:c}=this.calculateActualAtDate(r,s),l=o/100*n,h=t/100*n,f=h>0?l/h:1,b=c>0?l/c:1,d=l-h,u=l-c,g=b>0?n/b:n,a=f>0?this.getProjectDuration(r)/f:this.getProjectDuration(r),m=new Date(s);return m.setDate(m.getDate()+a),{spi:f,cpi:b,sv:d,cv:u,estimatedCompletion:m.toISOString().split("T")[0],estimatedCost:g}}static getProjectDuration(r){if(r.length===0)return 0;const s=r.map(o=>new Date(o.startDate)),n=r.map(o=>new Date(o.endDate)),t=new Date(Math.min(...s.map(o=>o.getTime()))),i=new Date(Math.max(...n.map(o=>o.getTime())));return Math.ceil((i.getTime()-t.getTime())/(1e3*60*60*24))}}class W{static exportToExcel(r,s,n){const t=XLSX.utils.book_new(),i=r.map(d=>({"Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·":d.id,"ÙƒÙˆØ¯ WBS":d.wbsCode,"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·":d.name,Ø§Ù„ÙˆØµÙ:d.description,"Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)":d.duration,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡":d.startDate,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡":d.endDate,"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±":d.earlyStart,"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±":d.earlyFinish,"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±":d.lateStart,"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±":d.lateFinish,"Float Ø§Ù„ÙƒÙ„ÙŠ":d.totalFloat,"Float Ø§Ù„Ø­Ø±":d.freeFloat,Ø­Ø±Ø¬:d.isCritical?"Ù†Ø¹Ù…":"Ù„Ø§","Ø§Ù„ØªÙ‚Ø¯Ù… %":d.progress,Ø§Ù„Ø­Ø§Ù„Ø©:d.status,"ØªÙƒÙ„ÙØ© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©":Q.calculateActivityCost(d)})),o=XLSX.utils.json_to_sheet(i);XLSX.utils.book_append_sheet(t,o,"Ø§Ù„Ø£Ù†Ø´Ø·Ø©");const c=s.map(d=>({"ÙƒÙˆØ¯ WBS":d.code,Ø§Ù„Ù…Ø³ØªÙˆÙ‰:d.level,Ø§Ù„Ø§Ø³Ù…:d.name,"Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù†Ø´Ø·Ø©":d.activities.length,"Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©":d.totalDuration,"Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©":d.totalCost})),l=XLSX.utils.json_to_sheet(c);XLSX.utils.book_append_sheet(t,l,"WBS");const f=r.filter(d=>d.isCritical).map(d=>({"Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·":d.id,"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·":d.name,Ø§Ù„Ù…Ø¯Ø©:d.duration,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡":d.startDate,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡":d.endDate})),b=XLSX.utils.json_to_sheet(f);XLSX.utils.book_append_sheet(t,b,"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬"),XLSX.writeFile(t,`${n}_Schedule_${new Date().toISOString().split("T")[0]}.xlsx`)}static exportToPrimavera(r,s){const n=r.map(l=>({activityId:`A${l.id}`,activityName:l.name,originalDuration:l.duration,remainingDuration:l.duration*(1-l.progress/100),percentComplete:l.progress,startDate:l.startDate,finishDate:l.endDate,calendarId:"STD",wbsId:l.wbsCode,predecessors:l.dependencies.map(h=>({predecessorActivityId:`A${h.predecessorId}`,type:`PR_${h.type}`,lag:h.lag}))}));let t=`<?xml version="1.0" encoding="UTF-8"?>
`;t+=`<Project>
`,t+=`  <ProjectName>${s}</ProjectName>
`,t+=`  <Activities>
`;for(const l of n){if(t+=`    <Activity>
`,t+=`      <ActivityId>${l.activityId}</ActivityId>
`,t+=`      <ActivityName><![CDATA[${l.activityName}]]></ActivityName>
`,t+=`      <Duration>${l.originalDuration}</Duration>
`,t+=`      <PercentComplete>${l.percentComplete}</PercentComplete>
`,t+=`      <StartDate>${l.startDate}</StartDate>
`,t+=`      <FinishDate>${l.finishDate}</FinishDate>
`,t+=`      <WBSCode>${l.wbsId}</WBSCode>
`,l.predecessors.length>0){t+=`      <Predecessors>
`;for(const h of l.predecessors)t+=`        <Predecessor>
`,t+=`          <ActivityId>${h.predecessorActivityId}</ActivityId>
`,t+=`          <Type>${h.type}</Type>
`,t+=`          <Lag>${h.lag}</Lag>
`,t+=`        </Predecessor>
`;t+=`      </Predecessors>
`}t+=`    </Activity>
`}t+=`  </Activities>
`,t+="</Project>";const i=new Blob([t],{type:"application/xml"}),o=URL.createObjectURL(i),c=document.createElement("a");c.href=o,c.download=`${s}_Primavera_${new Date().toISOString().split("T")[0]}.xml`,c.click(),URL.revokeObjectURL(o)}static generatePDFContent(r,s){let n=`
            <html>
            <head>
                <title>${s} - Schedule</title>
                <style>
                    body { font-family: Arial, sans-serif; direction: rtl; }
                    h1 { text-align: center; color: #333; }
                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: right; }
                    th { background-color: #4CAF50; color: white; }
                    .critical { background-color: #ffcccc; }
                </style>
            </head>
            <body>
                <h1>Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹: ${s}</h1>
                <table>
                    <thead>
                        <tr>
                            <th>Ø±Ù‚Ù…</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·</th>
                            <th>Ø§Ù„Ù…Ø¯Ø©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</th>
                            <th>Float</th>
                            <th>Ø­Ø±Ø¬</th>
                        </tr>
                    </thead>
                    <tbody>
        `;return r.forEach(t=>{const i=t.isCritical?"critical":"";n+=`
                <tr class="${i}">
                    <td>${t.id}</td>
                    <td>${t.name}</td>
                    <td>${t.duration} ÙŠÙˆÙ…</td>
                    <td>${t.startDate}</td>
                    <td>${t.endDate}</td>
                    <td>${t.totalFloat}</td>
                    <td>${t.isCritical?"â˜…":""}</td>
                </tr>
            `}),n+=`
                    </tbody>
                </table>
            </body>
            </html>
        `,n}static printPDF(r,s){const n=this.generatePDFContent(r,s),t=window.open("","","width=800,height=600");t&&(t.document.write(n),t.document.close(),t.print())}}class he{static exportSchedule(r,s,n={}){const t=C({includeGantt:!0,includeProgress:!0,includeResources:!0,colorByStatus:!0,colorByCritical:!0},n),i=XLSX.utils.book_new();this.addScheduleSheet(i,r,t),this.addSummarySheet(i,r,s),this.addCriticalPathSheet(i,r),t.includeResources&&this.addResourceSheet(i,r);const o=`${s}_Schedule_${new Date().toISOString().split("T")[0]}.xlsx`;XLSX.writeFile(i,o)}static addScheduleSheet(r,s,n){const t=[],i=["WBS","Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ù„Ù†ÙˆØ¹","Ø§Ù„ÙØ¦Ø©","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡","Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)","Ø§Ù„ØªÙ‚Ø¯Ù… %","Ø§Ù„Ø­Ø§Ù„Ø©","Ø­Ø±Ø¬ØŸ","Ø§Ù„Ø£Ø³Ø¨Ù‚ÙŠØ§Øª","Ø§Ù„Ù…ÙˆØ§Ø±Ø¯","Ø§Ù„ØªÙƒÙ„ÙØ©"];t.push(i),[...s].sort((l,h)=>l.wbsCode.localeCompare(h.wbsCode)).forEach(l=>{var f,b;const h=[l.wbsCode,l.id,l.name,this.getTypeNameAr(l.type),l.category,l.startDate.toLocaleDateString("ar-SA"),l.endDate.toLocaleDateString("ar-SA"),l.duration,l.progress,this.getStatusNameAr(l.status),l.isCritical?"Ù†Ø¹Ù…":"Ù„Ø§",((f=l.dependencies)==null?void 0:f.join(", "))||"-",((b=l.resources)==null?void 0:b.join(", "))||"-",l.cost?`${l.cost.toLocaleString()} Ø±ÙŠØ§Ù„`:"-"];t.push(h)});const c=XLSX.utils.aoa_to_sheet(t);c["!cols"]=[{wch:12},{wch:12},{wch:40},{wch:15},{wch:20},{wch:15},{wch:15},{wch:12},{wch:10},{wch:12},{wch:8},{wch:15},{wch:20},{wch:18}],XLSX.utils.book_append_sheet(r,c,"Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ")}static addSummarySheet(r,s,n){const t=[];t.push(["Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"]),t.push(["Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹",n]),t.push(["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡",new Date().toLocaleDateString("ar-SA")]),t.push([]),t.push(["Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª"]),t.push(["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©",s.length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©",s.filter(u=>u.isCritical).length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©",s.filter(u=>u.progress===100).length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",s.filter(u=>u.progress>0&&u.progress<100).length]),t.push(["Ø§Ù„Ø£Ù†Ø´Ø·Ø© ØºÙŠØ± Ø§Ù„Ù…Ø¨Ø¯ÙˆØ¡Ø©",s.filter(u=>u.progress===0).length]),t.push([]);const i=s.map(u=>u.startDate.getTime()),o=s.map(u=>u.endDate.getTime()),c=new Date(Math.min(...i)),l=new Date(Math.max(...o)),h=Math.ceil((l.getTime()-c.getTime())/(1e3*60*60*24));t.push(["Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ"]),t.push(["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©",c.toLocaleDateString("ar-SA")]),t.push(["ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©",l.toLocaleDateString("ar-SA")]),t.push(["Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©",`${h} ÙŠÙˆÙ…`]),t.push([]),t.push(["Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©"]);const f={};s.forEach(u=>{f[u.category]=(f[u.category]||0)+1}),Object.entries(f).forEach(([u,g])=>{t.push([u,g])}),t.push([]),t.push(["Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹"]);const b={};s.forEach(u=>{const g=this.getTypeNameAr(u.type);b[g]=(b[g]||0)+1}),Object.entries(b).forEach(([u,g])=>{t.push([u,g])});const d=XLSX.utils.aoa_to_sheet(t);d["!cols"]=[{wch:25},{wch:20}],XLSX.utils.book_append_sheet(r,d,"Ø§Ù„Ù…Ù„Ø®Øµ")}static addCriticalPathSheet(r,s){const n=[];n.push(["Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹"]),n.push([]),n.push(["WBS","Ø±Ù‚Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡","Ø§Ù„Ù…Ø¯Ø©","Ø§Ù„ØªÙ‚Ø¯Ù… %","Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ"]);const t=s.filter(o=>o.isCritical);t.forEach(o=>{n.push([o.wbsCode,o.id,o.name,o.startDate.toLocaleDateString("ar-SA"),o.endDate.toLocaleDateString("ar-SA"),o.duration,o.progress,o.totalFloat||0])}),n.push([]),n.push(["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©",t.length]),n.push(["Ù†Ø³Ø¨Ø© Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©",`${(t.length/s.length*100).toFixed(1)}%`]);const i=XLSX.utils.aoa_to_sheet(n);i["!cols"]=[{wch:12},{wch:12},{wch:40},{wch:15},{wch:15},{wch:10},{wch:10},{wch:12}],XLSX.utils.book_append_sheet(r,i,"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬")}static addResourceSheet(r,s){const n=[];n.push(["ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"]),n.push([]);const t=s.map(u=>u.startDate.getTime()),i=s.map(u=>u.endDate.getTime()),o=new Date(Math.min(...t)),c=new Date(Math.max(...i)),l=[];let h=new Date(o);for(;h<=c;)l.push(new Date(h)),h.setDate(h.getDate()+7);const f=["Ø§Ù„ÙØ¦Ø©","Ø§Ù„Ù†ÙˆØ¹"];l.forEach((u,g)=>{f.push(`Ø£Ø³Ø¨ÙˆØ¹ ${g+1}`)}),n.push(f);const b={};s.forEach(u=>{b[u.category]||(b[u.category]=new Array(l.length).fill(0)),l.forEach((g,a)=>{const m=new Date(g);m.setDate(m.getDate()+7),u.startDate<=m&&u.endDate>=g&&(b[u.category][a]+=1)})}),Object.entries(b).forEach(([u,g])=>{const a=[u,""];a.push(...g.map(m=>m.toString())),n.push(a)});const d=XLSX.utils.aoa_to_sheet(n);XLSX.utils.book_append_sheet(r,d,"Ø§Ù„Ù…ÙˆØ§Ø±Ø¯")}static getTypeNameAr(r){return{excavation:"Ø­ÙØ±",concrete:"Ø®Ø±Ø³Ø§Ù†Ø©",reinforcement:"Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­",formwork:"Ø´Ø¯Ø© Ø®Ø´Ø¨ÙŠØ©",masonry:"Ù…Ø¨Ø§Ù†ÙŠ",waterproofing:"Ø¹Ø²Ù„",backfill:"Ø±Ø¯Ù…",painting:"Ø¯Ù‡Ø§Ù†",installation:"ØªØ±ÙƒÙŠØ¨",supply:"ØªÙˆØ±ÙŠØ¯",other:"Ø£Ø®Ø±Ù‰"}[r]||r}static getStatusNameAr(r){return{not_started:"Ù„Ù… ÙŠØ¨Ø¯Ø£",in_progress:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°",completed:"Ù…ÙƒØªÙ…Ù„",delayed:"Ù…ØªØ£Ø®Ø±",on_hold:"Ù…Ø¹Ù„Ù‚"}[r]||r}}const pe=({activities:p,projectName:r,projectStart:s,projectEnd:n})=>{const[t,i]=w.useState("weeks"),[o,c]=w.useState(!1),[l,h]=w.useState("all"),f=w.useMemo(()=>{const a=new Set(p.map(m=>m.category));return Array.from(a).sort()},[p]),b=w.useMemo(()=>{let a=p;return o&&(a=a.filter(m=>m.isCritical)),l!=="all"&&(a=a.filter(m=>m.category===l)),a.sort((m,x)=>m.startDate.getTime()-x.startDate.getTime())},[p,o,l]),d=w.useMemo(()=>{const a=n.getTime()-s.getTime(),m=Math.ceil(a/(1e3*60*60*24));let x=[],j;if(t==="days"){for(let y=0;y<=m;y+=1){const v=new Date(s);v.setDate(v.getDate()+y),x.push(v)}j=y=>`${y.getDate()}/${y.getMonth()+1}`}else if(t==="weeks"){for(let y=0;y<=m;y+=7){const v=new Date(s);v.setDate(v.getDate()+y),x.push(v)}j=y=>`W${Math.ceil((y.getTime()-s.getTime())/(10080*60*1e3))}`}else{let y=new Date(s);for(;y<=n;)x.push(new Date(y)),y.setMonth(y.getMonth()+1);j=v=>`${v.toLocaleDateString("ar-SA",{month:"short",year:"2-digit"})}`}return{intervals:x,intervalLabel:j,totalDays:m}},[s,n,t]),u=w.useMemo(()=>{const a=n.getTime()-s.getTime();return b.map((m,x)=>{const j=m.startDate.getTime(),v=m.endDate.getTime()-j,S=(j-s.getTime())/a*100,D=v/a*100;let k="#3b82f6";return m.isCritical?k="#ef4444":m.progress===100?k="#10b981":m.progress>0?k="#f59e0b":k={excavation:"#8b5cf6",concrete:"#64748b",reinforcement:"#f97316",waterproofing:"#06b6d4",backfill:"#84cc16",painting:"#ec4899",formwork:"#eab308",masonry:"#d97706",installation:"#0ea5e9",supply:"#6366f1"}[m.type]||k,{activity:m,startPos:Math.max(0,S),width:Math.min(100-S,D),color:k,row:x}})},[b,s,n]),g=()=>{alert("ØªØµØ¯ÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±")};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-6 h-6 text-indigo-600"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Ù…Ø®Ø·Ø· Ø¬Ø§Ù†Øª - ",r]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.toLocaleDateString("ar-SA")," - ",n.toLocaleDateString("ar-SA")]})]})]}),e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(F,{className:"w-4 h-4"}),"ØªØµØ¯ÙŠØ± ØµÙˆØ±Ø©"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 p-4 bg-gray-50 dark:bg-slate-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„Ø¹Ø±Ø¶:"}),e.jsxs("select",{value:t,onChange:a=>i(a.target.value),className:"px-3 py-1 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"days",children:"Ø£ÙŠØ§Ù…"}),e.jsx("option",{value:"weeks",children:"Ø£Ø³Ø§Ø¨ÙŠØ¹"}),e.jsx("option",{value:"months",children:"Ø£Ø´Ù‡Ø±"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium",children:"Ø§Ù„ÙØ¦Ø©:"}),e.jsxs("select",{value:l,onChange:a=>h(a.target.value),className:"px-3 py-1 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"all",children:"Ø§Ù„ÙƒÙ„"}),f.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:a=>c(a.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø© ÙÙ‚Ø·"})]}),e.jsxs("div",{className:"mr-auto text-sm text-gray-600",children:["Ø¹Ø±Ø¶ ",b.length," Ù…Ù† ",p.length," Ù†Ø´Ø§Ø·"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ø­Ø±Ø¬"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ù…ÙƒØªÙ…Ù„"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Ù…Ø®Ø·Ø·"})]})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("div",{className:"min-w-[1200px]",children:[e.jsxs("div",{className:"flex border-b bg-gray-100 dark:bg-slate-800",children:[e.jsx("div",{className:"w-64 p-3 border-l font-bold",children:"Ø§Ù„Ù†Ø´Ø§Ø·"}),e.jsx("div",{className:"flex-1 relative",children:e.jsx("div",{className:"flex",children:d.intervals.map((a,m)=>e.jsx("div",{className:"flex-1 p-2 border-l text-center text-sm font-medium",style:{minWidth:"60px"},children:d.intervalLabel(a)},m))})})]}),u.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© ØªØ·Ø§Ø¨Ù‚ Ø§Ù„ÙÙ„ØªØ±"}):u.map((a,m)=>e.jsxs("div",{className:"flex border-b hover:bg-gray-50 dark:hover:bg-slate-800/50",children:[e.jsxs("div",{className:"w-64 p-3 border-l",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.activity.isCritical&&e.jsx("span",{className:"text-red-500 font-bold",children:"âš ï¸"}),e.jsx("span",{className:"text-sm truncate",title:a.activity.name,children:a.activity.name})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[a.activity.duration," ÙŠÙˆÙ… | ",a.activity.progress,"%"]})]}),e.jsx("div",{className:"flex-1 relative p-2",children:e.jsxs("div",{className:"absolute top-2 h-8 rounded-lg shadow-md cursor-pointer hover:shadow-lg transition-shadow",style:{right:`${a.startPos}%`,width:`${a.width}%`,backgroundColor:a.color,minWidth:"4px"},title:`${a.activity.name}
${a.activity.startDate.toLocaleDateString("ar-SA")} - ${a.activity.endDate.toLocaleDateString("ar-SA")}`,children:[a.activity.progress>0&&e.jsx("div",{className:"h-full bg-black/20 rounded-lg",style:{width:`${a.activity.progress}%`}}),a.width>5&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-xs text-white font-medium px-2",children:[a.activity.progress,"%"]})]})})]},m))]})}),e.jsx("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©:"}),e.jsx("span",{className:"font-bold mr-2",children:p.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©:"}),e.jsx("span",{className:"font-bold mr-2 text-red-600",children:p.filter(a=>a.isCritical).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©:"}),e.jsx("span",{className:"font-bold mr-2 text-green-600",children:p.filter(a=>a.progress===100).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°:"}),e.jsx("span",{className:"font-bold mr-2 text-orange-600",children:p.filter(a=>a.progress>0&&a.progress<100).length})]})]})})]})},ge=({activities:p,wbs:r,projectName:s})=>{var g;const[n,t]=w.useState("activities"),[i,o]=w.useState(null),c=w.useMemo(()=>{if(p.length===0)return null;const a=new Date(Math.min(...p.map(m=>new Date(m.startDate).getTime())));return E.performCPM(p,a)},[p]),l=w.useMemo(()=>{if(p.length===0)return[];const a=new Date(Math.min(...p.map(x=>new Date(x.startDate).getTime()))),m=new Date(Math.max(...p.map(x=>new Date(x.endDate).getTime())));return Q.generateSCurve(p,a,m)},[p]),h=w.useMemo(()=>M.generateComplianceReport(p),[p]),f=w.useMemo(()=>{if(p.length===0)return{start:new Date,end:new Date};const a=new Date(Math.min(...p.map(x=>new Date(x.startDate).getTime()))),m=new Date(Math.max(...p.map(x=>new Date(x.endDate).getTime())));return{start:a,end:m}},[p]),b=()=>{he.exportSchedule(p,s,{includeResources:!0,includeProjectInfo:!0})},d=()=>{W.exportToPrimavera(p,s)},u=()=>{W.printPDF(p,s)};return p.length===0?e.jsx("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ. Ù‚Ù… Ø¨ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Ø¹Ø§Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700",children:[e.jsx(F,{className:"w-4 h-4"})," Excel"]}),e.jsxs("button",{onClick:d,className:"flex items-center gap-2 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700",children:[e.jsx(F,{className:"w-4 h-4"})," Primavera"]}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700",children:[e.jsx(re,{className:"w-4 h-4"})," PDF"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.length})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:p.filter(a=>a.isCritical).length})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[(c==null?void 0:c.projectDuration)||0," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„ÙƒÙˆØ¯"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[h.compliancePercentage.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsx("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700 p-4",children:[{key:"activities",label:"Ø§Ù„Ø£Ù†Ø´Ø·Ø©"},{key:"wbs",label:"WBS"},{key:"critical",label:"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬"},{key:"gantt",label:"Ù…Ø®Ø·Ø· Ø¬Ø§Ù†Øª"},{key:"scurve",label:"Ù…Ù†Ø­Ù†Ù‰ S"},{key:"compliance",label:"Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ SBC"}].map(a=>e.jsx("button",{onClick:()=>t(a.key),className:`px-4 py-2 rounded-lg font-semibold ${n===a.key?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300"}`,children:a.label},a.key))}),e.jsxs("div",{className:"p-6",children:[n==="activities"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-right",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800",children:e.jsx("tr",{children:["ID","WBS","Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ù„Ù…Ø¯Ø©","Ø§Ù„Ø¨Ø¯Ø¡","Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡","Float","Ø­Ø±Ø¬"].map(a=>e.jsx("th",{className:"p-3 text-sm font-medium",children:a},a))})}),e.jsx("tbody",{children:p.map(a=>e.jsxs("tr",{className:`border-b hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer ${a.isCritical?"bg-red-50 dark:bg-red-900/20":""}`,onClick:()=>o(a),children:[e.jsx("td",{className:"p-2",children:a.id}),e.jsx("td",{className:"p-2 text-xs",children:a.wbsCode}),e.jsx("td",{className:"p-2 font-medium",children:a.name}),e.jsxs("td",{className:"p-2",children:[a.duration," ÙŠÙˆÙ…"]}),e.jsx("td",{className:"p-2 text-sm",children:a.startDate}),e.jsx("td",{className:"p-2 text-sm",children:a.endDate}),e.jsx("td",{className:"p-2",children:a.totalFloat}),e.jsx("td",{className:"p-2 text-center",children:a.isCritical&&e.jsx("span",{className:"text-red-600",children:"â˜…"})})]},a.id))})]})}),n==="wbs"&&e.jsx("div",{className:"space-y-3",children:r.map(a=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-bold",children:a.name}),e.jsx("span",{className:"text-sm text-gray-500",children:a.code})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø©:"}),e.jsx("span",{className:"font-semibold mr-2",children:a.activities.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ø§Ù„Ù…Ø¯Ø©:"}),e.jsxs("span",{className:"font-semibold mr-2",children:[a.totalDuration," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ø§Ù„ØªÙƒÙ„ÙØ©:"}),e.jsxs("span",{className:"font-semibold mr-2",children:[a.totalCost.toLocaleString()," Ø±ÙŠØ§Ù„"]})]})]})]},a.code))}),n==="critical"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4 text-red-600",children:"Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬ - Critical Path"}),e.jsx("div",{className:"space-y-2",children:p.filter(a=>a.isCritical).map(a=>e.jsxs("div",{className:"border-l-4 border-red-500 p-4 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:a.name}),e.jsxs("span",{className:"text-sm",children:[a.duration," ÙŠÙˆÙ…"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[a.startDate," â†’ ",a.endDate]})]},a.id))})]}),n==="gantt"&&e.jsx(pe,{activities:p,projectName:s,projectStart:f.start,projectEnd:f.end}),n==="scurve"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Ù…Ù†Ø­Ù†Ù‰ S - Progress Tracking"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ",l.length," | Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ù…Ø®Ø·Ø·: ",(g=l[l.length-1])==null?void 0:g.plannedProgress.toFixed(1),"%"]}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg",children:e.jsx("p",{className:"text-center text-gray-500",children:"ØªØµÙˆØ± Ù…Ù†Ø­Ù†Ù‰ S (ÙŠØªØ·Ù„Ø¨ Ù…ÙƒØªØ¨Ø© Recharts Ù„Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ù…Ù„)"})})]}),n==="compliance"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:"Ø£Ù†Ø´Ø·Ø© Ù…Ù…ØªØ«Ù„Ø©"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:h.compliantActivities})]}),e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:"Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:h.nonCompliantActivities})]})]}),h.violations.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-red-600 flex items-center",children:[e.jsx(ae,{className:"w-4 h-4 ml-2"}),"Ø§Ù„Ø§Ù†ØªÙ‡Ø§ÙƒØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§"]}),h.violations.map(a=>e.jsxs("div",{className:"border-l-4 border-red-500 p-4 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsx("p",{className:"font-semibold",children:a.activityName}),e.jsx("ul",{className:"text-sm mt-2 space-y-1",children:a.violations.map((m,x)=>e.jsxs("li",{className:"text-red-700 dark:text-red-300",children:["â€¢ ",m.code,": ",m.complianceNotes]},x))})]},a.activityId))]})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>o(null),children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-6 rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:i.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"WBS:"})," ",i.wbsCode]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ù…Ø¯Ø©:"})," ",i.duration," ÙŠÙˆÙ…"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±:"})," ",i.earlyStart]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…Ø¨ÙƒØ±:"})," ",i.earlyFinish]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±:"})," ",i.lateStart]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ù…ØªØ£Ø®Ø±:"})," ",i.lateFinish]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Float Ø§Ù„ÙƒÙ„ÙŠ:"})," ",i.totalFloat," ÙŠÙˆÙ…"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Float Ø§Ù„Ø­Ø±:"})," ",i.freeFloat," ÙŠÙˆÙ…"]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("strong",{children:"Ø­Ø±Ø¬:"})," ",i.isCritical?"â˜… Ù†Ø¹Ù…":"Ù„Ø§"]})]}),i.sbcRequirements&&i.sbcRequirements.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ:"}),e.jsx("div",{className:"space-y-2",children:i.sbcRequirements.map((a,m)=>e.jsxs("div",{className:`p-2 rounded text-sm ${a.isCompliant?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[a.code,":"]})," ",a.description]}),a.minimumDuration&&e.jsxs("p",{className:"text-xs mt-1",children:["Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: ",a.minimumDuration," ÙŠÙˆÙ…"]})]},m))})]}),e.jsx("button",{onClick:()=>o(null),className:"mt-4 w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700",children:"Ø¥ØºÙ„Ø§Ù‚"})]})})]})};class xe{static parseExcelWithSpecs(r){return new Promise((s,n)=>{const t=new FileReader;t.onload=i=>{var o;try{const c=new Uint8Array((o=i.target)==null?void 0:o.result),l=XLSX.read(c,{type:"array"}),h=l.SheetNames[0],f=l.Sheets[h],b=XLSX.utils.sheet_to_json(f,{header:1,defval:""}),d=[];let u=-1;for(let m=0;m<Math.min(20,b.length);m++){const x=b[m],j=x.join(" ").toLowerCase();if((j.includes("Ø±Ù‚Ù…")||j.includes("ØªØ³Ù„Ø³Ù„"))&&j.includes("Ø¨Ù†Ø¯")){u=m,console.log(`âœ“ ÙˆØ¬Ø¯Øª ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø³Ø·Ø± ${m+1}`),console.log("Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙ:",x.filter(y=>y).slice(0,10));break}}if(u===-1)throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ù„Ù");console.log(`âœ“ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø³Ø·Ø± ${u+1}`);const g=b[u],a={};for(let m=0;m<g.length;m++){const x=String(g[m]).toLowerCase().trim();x.includes("Ø±Ù‚Ù…")&&x.includes("ØªØ³Ù„Ø³Ù„")||x==="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ"?a.serialNumber=m:x.includes("ÙØ¦Ø©")||x.includes("category")?a.category=m:x==="Ø§Ù„Ø¨Ù†Ø¯"||x.includes("item name")||x==="item"?a.itemName=m:x.includes("ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯")||x.includes("ÙˆØµÙ")||x.includes("description")?a.description=m:x==="Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"||x.includes("Ù…ÙˆØ§ØµÙØ§Øª")||x.includes("specification")?a.specifications=m:x.includes("ÙˆØ­Ø¯Ø©")||x.includes("unit")?a.unit=m:x.includes("ÙƒÙ…ÙŠØ©")||x.includes("quantity")?a.quantity=m:x.includes("Ø³Ø¹Ø±")||x==="Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©"||x.includes("unit price")?a.unitPrice===void 0&&(a.unitPrice=m):(x.includes("Ø¥Ø¬Ù…Ø§Ù„ÙŠ")||x.includes("total"))&&a.total===void 0&&(a.total=m)}if(console.log("âœ… Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:",a),console.log("ğŸ“Š Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙƒØªØ´ÙØ©:",{serialNumber:a.serialNumber!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.serialNumber+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",category:a.category!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.category+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",itemName:a.itemName!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.itemName+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",description:a.description!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.description+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",specifications:a.specifications!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.specifications+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",unit:a.unit!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.unit+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",quantity:a.quantity!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.quantity+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯",unitPrice:a.unitPrice!==void 0?`Ø§Ù„Ø¹Ù…ÙˆØ¯ ${a.unitPrice+1}`:"ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"}),a.serialNumber===void 0||a.itemName===void 0){const m=[];throw a.serialNumber===void 0&&m.push("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ"),a.itemName===void 0&&m.push("Ø§Ù„Ø¨Ù†Ø¯"),new Error(`Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: ${m.join(", ")}

Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©: ${g.filter(x=>x).join(", ")}`)}for(let m=u+1;m<b.length;m++){const x=b[m],j=String(x[a.serialNumber]||"").trim(),y=String(x[a.itemName]||"").trim();if(!j||!y||j==="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ"||y==="Ø§Ù„Ø¨Ù†Ø¯")continue;const v=String(x[a.category]||"").trim(),S=a.description!==void 0?String(x[a.description]||"").trim():"",D=a.specifications!==void 0?String(x[a.specifications]||"").trim():"",k=a.unit!==void 0?String(x[a.unit]||"").trim():"",A=a.quantity!==void 0?this.parseNumber(x[a.quantity]):0,I=a.unitPrice!==void 0?this.parseNumber(x[a.unitPrice]):0,N=a.total!==void 0&&this.parseNumber(x[a.total])||A*I;y&&A>0&&d.push({serialNumber:j,category:v,itemName:y,description:S,specifications:D||S||y,unit:k,quantity:A,unitPrice:I,total:N})}if(d.length===0)throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨Ù†ÙˆØ¯ ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù");console.log(`âœ… ØªÙ… Ù‚Ø±Ø§Ø¡Ø© ${d.length} Ø¨Ù†Ø¯ Ø¨Ù†Ø¬Ø§Ø­`),s(d)}catch(c){console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù:",c),n(new Error(`ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù Excel: ${c.message}`))}},t.onerror=()=>n(new Error("ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù")),t.readAsArrayBuffer(r)})}static parseNumber(r){if(typeof r=="number")return r;if(typeof r=="string"){const s=r.replace(/[,ØŒ\s]/g,""),n=parseFloat(s);return isNaN(n)?0:n}return 0}static convertToFinancialItems(r){return r.map(s=>({id:`BOQ-${s.serialNumber}`,item:s.itemName,unit:s.unit,quantity:s.quantity,unitPrice:s.unitPrice,total:s.total}))}}const R=class R{static analyzeSpecifications(r,s,n,t,i,o,c,l){const h={id:`BOQ-${r}`,item:n,unit:o,quantity:c,unitPrice:l,total:c*l},f=this.extractActivitiesFromSpecs(i,n,o,c);return{originalItem:h,serialNumber:r,category:s,itemName:n,description:t,fullSpecifications:i,extractedActivities:f}}static extractActivitiesFromSpecs(r,s,n,t){const i=[],o=r.toLowerCase();for(const c of this.activityPatterns)if(c.keywords.some(h=>o.includes(h.toLowerCase()))){const h=this.extractRelevantSentences(r,c.keywords);i.push({name:`${c.activityName} - ${s}`,description:h,type:c.type,keywords:c.keywords,estimatedQuantity:this.estimateActivityQuantity(t,n,c.type),unit:this.determineActivityUnit(n,c.type),sequence:c.sequence,parentItemName:s})}return i.sort((c,l)=>c.sequence-l.sequence),i.length===0&&i.push({name:s,description:r,type:"other",keywords:[],estimatedQuantity:t,unit:n,sequence:50,parentItemName:s}),i}static extractRelevantSentences(r,s){const n=r.split(/[.ØŒØ›]/).map(i=>i.trim()),t=[];for(const i of n){const o=i.toLowerCase();s.some(c=>o.includes(c.toLowerCase()))&&t.push(i)}return t.length>0?t.join(". "):r.substring(0,200)+"..."}static estimateActivityQuantity(r,s,n){switch(n){case"excavation":return r;case"concrete":return r;case"reinforcement":return s.includes("Ù…")?r*.12:r;case"formwork":return s.includes("Ù…")?r*6:r;case"waterproofing":return r*.5;case"backfill":return r*.8;default:return r}}static determineActivityUnit(r,s){switch(s){case"excavation":case"concrete":case"backfill":return"Ù…3";case"reinforcement":return"Ø·Ù†";case"formwork":case"waterproofing":case"painting":return"Ù…2";case"installation":case"supply":return r;default:return r}}static convertToScheduleActivities(r,s,n=1){const t=[];let i=1,o=new Date(s);for(const c of r){const l=`${c.category}.${c.serialNumber}`;for(let h=0;h<c.extractedActivities.length;h++){const f=c.extractedActivities[h],b={shiftsPerDay:n,shiftFactor:this.getShiftFactor(n),workHoursPerShift:8,description:n===1?"ÙˆØ±Ø¯ÙŠØ© ÙˆØ§Ø­Ø¯Ø©":n===2?"ÙˆØ±Ø¯ÙŠØªØ§Ù†":"Ø«Ù„Ø§Ø« ÙˆØ±Ø¯ÙŠØ§Øª"},d=this.calculateActivityDuration(f.type,f.estimatedQuantity,f.unit,b),{adjustedDuration:u,riskBuffer:g}=this.applyRiskBuffer(d,f.type,!1,!1),a={id:i++,wbsCode:`${l}.${h+1}`,name:f.name,description:f.description,category:c.category,boqItemId:c.originalItem.id,duration:d,adjustedDuration:u,startDate:o.toISOString().split("T")[0],endDate:this.addDays(o,u).toISOString().split("T")[0],earlyStart:"",earlyFinish:"",lateStart:"",lateFinish:"",totalFloat:0,freeFloat:0,isCritical:!1,dependencies:this.generateDependencies(i,h),successors:[],resources:this.generateResources(f.type),progress:0,status:"Not Started",productivityRate:0,estimatedManHours:this.estimateManHours(f.type,f.estimatedQuantity),shiftConfig:b,riskBuffer:g};t.push(a),o=this.addDays(o,Math.ceil(u/2))}}return t}static calculateActivityDuration(r,s,n,t){const o={excavation:25,concrete:15,reinforcement:1,formwork:20,waterproofing:30,backfill:30,masonry:10,painting:40,installation:5,supply:1}[r]||10,c=this.getShiftFactor((t==null?void 0:t.shiftsPerDay)||1),l=s/(o*c),h=Math.ceil(l);return Math.max(.5,Math.min(30,h))}static getShiftFactor(r){return{1:1,2:.6,3:.45}[r]||1}static applyRiskBuffer(r,s,n,t=!1){let i=3,o="non-critical",c="Ù†Ø´Ø§Ø· ØºÙŠØ± Ø­Ø±Ø¬";s==="painting"||s==="installation"?(i=8,o="precision",c="Ø£Ø¹Ù…Ø§Ù„ Ø¯Ù‚ÙŠÙ‚Ø© (Ø±Ø®Ø§Ù…ØŒ Ø¯Ù‡Ø§Ù† ÙØ§Ø®Ø±)"):t?(i=6,o="external",c="Ø£Ø¹Ù…Ø§Ù„ Ø®Ø§Ø±Ø¬ÙŠØ© (Ù…Ù‚Ø§ÙˆÙ„ Ø¨Ø§Ø·Ù†)"):n&&(i=5,o="critical",c="Ù†Ø´Ø§Ø· Ø­Ø±Ø¬ (Critical Path)");const l=Math.ceil(r*(i/100));return{adjustedDuration:r+l,riskBuffer:{riskType:o,bufferPercentage:i,bufferDays:l,reason:c}}}static generateDependencies(r,s){return s===0?[]:[{predecessorId:r-1,type:"FS",lag:0}]}static generateResources(r){return{excavation:[{resourceType:"Equipment",resourceName:"Ø­ÙØ§Ø±Ø©",quantity:1,unit:"units",dailyRate:1200},{resourceType:"Labor",resourceName:"Ø¹Ù…Ø§Ù„",quantity:3,unit:"persons",dailyRate:200}],concrete:[{resourceType:"Labor",resourceName:"Ø¹Ù…Ø§Ù„ Ø®Ø±Ø³Ø§Ù†Ø©",quantity:8,unit:"persons",dailyRate:250},{resourceType:"Equipment",resourceName:"Ù…Ø¶Ø®Ø© Ø®Ø±Ø³Ø§Ù†Ø©",quantity:1,unit:"units",dailyRate:800}],reinforcement:[{resourceType:"Labor",resourceName:"Ø­Ø¯Ø§Ø¯ÙŠÙ†",quantity:4,unit:"persons",dailyRate:300}],formwork:[{resourceType:"Labor",resourceName:"Ù†Ø¬Ø§Ø±ÙŠÙ†",quantity:4,unit:"persons",dailyRate:280}]}[r]||[{resourceType:"Labor",resourceName:"Ø¹Ù…Ø§Ù„ Ø¹Ø§Ù…ÙŠÙ†",quantity:3,unit:"persons",dailyRate:200}]}static estimateManHours(r,s){const t={excavation:.5,concrete:1,reinforcement:8,formwork:.8,waterproofing:.4,backfill:.3,masonry:1.2,painting:.2,installation:2,supply:.1}[r]||.5;return Math.ceil(s*t)}static addDays(r,s){const n=new Date(r);return n.setDate(n.getDate()+s),n}};R.activityPatterns=[{keywords:["Ø­ÙØ±","Ø­ÙØ±ÙŠØ§Øª","excavation","Ø­ÙØ± Ø¨Ø¹Ù…Ù‚","Ø§Ù„Ø­ÙØ± Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª","Ø­ÙØ± Ø£Ø³Ø§Ø³Ø§Øª"],type:"excavation",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø­ÙØ±",sequence:10},{keywords:["Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ©","plain concrete","ØµØ¨ Ù‚ÙˆØ§Ø¹Ø¯","Ø®Ø±Ø³Ø§Ù†Ù‡ Ø¹Ø§Ø¯ÙŠÙ‡","Ø®Ø±Ø³Ø§Ù†Ø© Ù†Ø¸Ø§ÙØ©"],type:"concrete",activityName:"ØµØ¨ Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ©",sequence:20},{keywords:["Ø­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠØ­","reinforcement","ØªØ³Ù„ÙŠØ­","Ø§Ù„ØªØ³Ù„ÙŠØ­","Ø­Ø¯ÙŠØ¯ Ù…Ø³Ù„Ø­"],type:"reinforcement",activityName:"ØªØ±ÙƒÙŠØ¨ Ø­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠØ­",sequence:30},{keywords:["Ù†Ø¬Ø§Ø±Ø©","formwork","Ø´Ø¯Ø§Øª","Ù‚ÙˆØ§Ù„Ø¨","Ø´Ø¯Ø© Ø®Ø´Ø¨ÙŠØ©"],type:"formwork",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ù†Ø¬Ø§Ø±Ø© ÙˆØ§Ù„Ø´Ø¯Ø§Øª",sequence:35},{keywords:["Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©","reinforced concrete","Ø®Ø±Ø³Ø§Ù†Ù‡ Ù…Ø³Ù„Ø­Ù‡","Ù‚ÙˆØ§Ø¹Ø¯ Ù…Ø³Ù„Ø­Ø©","ØµØ¨ Ù…Ø³Ù„Ø­"],type:"concrete",activityName:"ØµØ¨ Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©",sequence:40},{keywords:["Ù…ÙŠØ¯Ø§Øª","Ù…ÙŠØ¯Ù‡","grade beams","Ø§Ù„Ù…ÙŠØ¯Ø§Øª Ø§Ù„Ø£Ø±Ø¶ÙŠØ©"],type:"concrete",activityName:"ØªÙ†ÙÙŠØ° Ø§Ù„Ù…ÙŠØ¯Ø§Øª",sequence:45},{keywords:["Ø¹Ø²Ù„","waterproofing","Ø¹Ø²Ù„ Ø§Ù„Ø£Ø³Ø§Ø³Ø§Øª","Ø¯Ù‡Ø§Ù† Ø¨ÙŠØªÙˆÙ…ÙŠÙ†ÙŠ","Ø¹Ø§Ø²Ù„ Ù„Ù„Ø±Ø·ÙˆØ¨Ø©","Ø¹Ø²Ù„ Ù…Ø§Ø¦ÙŠ"],type:"waterproofing",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¹Ø²Ù„",sequence:50},{keywords:["Ù…Ø¨ÙŠØ¯Ø§Øª","Ø§Ù„Ù†Ù…Ù„ Ø§Ù„Ø£Ø¨ÙŠØ¶","Ø¯ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¶","Ø±Ø´ Ø§Ù„Ù…Ø¨ÙŠØ¯Ø§Øª"],type:"installation",activityName:"Ø±Ø´ Ø§Ù„Ù…Ø¨ÙŠØ¯Ø§Øª",sequence:55},{keywords:["Ø±Ø¯Ù…","backfill","Ø§Ù„Ø±Ø¯Ù… Ø­ÙˆÙ„","Ø±Ù…Ø§Ù„ Ù†Ø¸ÙŠÙØ©","Ù†Ø§ØªØ¬ Ø§Ù„Ø­ÙØ±","Ø±Ø¯Ù… Ø§Ù„Ø£Ø³Ø§Ø³Ø§Øª"],type:"backfill",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø±Ø¯Ù…",sequence:60},{keywords:["Ø£Ø¹Ù…Ø¯Ø©","columns","Ø¹Ù…ÙˆØ¯","Ø£Ø¹Ù…Ø¯Ø© Ø®Ø±Ø³Ø§Ù†ÙŠØ©","Ø¨Ø§ÙƒÙŠØ§Øª"],type:"concrete",activityName:"ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©",sequence:70},{keywords:["Ø¨Ù†Ø§Ø¡","Ù…Ø¨Ø§Ù†ÙŠ","masonry","Ø·ÙˆØ¨","Ø¨Ù„ÙˆÙƒ","Ø¬Ø¯Ø±Ø§Ù†"],type:"masonry",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡",sequence:80},{keywords:["Ø¯Ù‡Ø§Ù†","painting","Ø·Ù„Ø§Ø¡","Ø¯Ù‡Ø§Ù† Ù†Ø§Ø±ÙŠ","ÙˆØ¬Ù‡ Ø§Ø³Ø§Ø³ÙŠ"],type:"painting",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ø¯Ù‡Ø§Ù†",sequence:90},{keywords:["ØªØ±ÙƒÙŠØ¨","installation","install","ØªØ«Ø¨ÙŠØª"],type:"installation",activityName:"Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØªØ±ÙƒÙŠØ¨",sequence:85},{keywords:["ØªÙˆØ±ÙŠØ¯","supply","ØªÙˆØ±ÙŠØ¯ ÙˆØªØ±ÙƒÙŠØ¨","ØªÙˆØ±ÙŠØ¯ Ùˆ ØªØ±ÙƒÙŠØ¨"],type:"supply",activityName:"Ø§Ù„ØªÙˆØ±ÙŠØ¯",sequence:5}];let q=R;const be=({onScheduleGenerated:p})=>{const[r,s]=w.useState(null),[n,t]=w.useState(!1),[i,o]=w.useState(""),[c,l]=w.useState(null),[h,f]=w.useState(new Date().toISOString().split("T")[0]),[b,d]=w.useState(null),u=m=>{var j;const x=((j=m.target.files)==null?void 0:j[0])||null;x&&(x.name.endsWith(".xlsx")||x.name.endsWith(".xls")?(s(x),l(null),o("")):(s(null),l("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel (.xlsx Ø£Ùˆ .xls)")))},g=(m,x,j,y)=>{d({phase:m,current:x,total:j,details:y})},a=()=>L(null,null,function*(){if(!r){l("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel Ø£ÙˆÙ„Ø§Ù‹");return}t(!0),l(null),o("");try{g("Ù‚Ø±Ø§Ø¡Ø©",1,9,"Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Excel...");const m=yield xe.parseExcelWithSpecs(r);o(`âœ… ØªÙ… Ù‚Ø±Ø§Ø¡Ø© ${m.length} Ø¨Ù†Ø¯ Ù…Ù† Ø§Ù„Ù…Ù„Ù`),yield new Promise(N=>setTimeout(N,500)),g("ØªØ­Ù„ÙŠÙ„",2,9,`Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ù…ÙˆØ§ØµÙØ§Øª ${m.length} Ø¨Ù†Ø¯...`);const x=[];let j=0;for(let N=0;N<m.length;N++){const P=m[N],$=q.analyzeSpecifications(P.serialNumber,P.category,P.itemName,P.description,P.specifications,P.unit,P.quantity,P.unitPrice);x.push($),j+=$.extractedActivities.length,N%50===0&&(g("ØªØ­Ù„ÙŠÙ„",2,9,`ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù†Ø¯ ${N+1}/${m.length} - ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ${j} Ù†Ø´Ø§Ø·`),yield new Promise(H=>setTimeout(H,10)))}o(`âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ${j} Ù†Ø´Ø§Ø· Ù…Ù† ${m.length} Ø¨Ù†Ø¯`),yield new Promise(N=>setTimeout(N,500)),g("ØªØ­ÙˆÙŠÙ„",3,9,"Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ Ø²Ù…Ù†ÙŠ Ù…Ø¹ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª ÙˆØ§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ...");let y=q.convertToScheduleActivities(x,new Date(h));o(`âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ${y.length} Ù†Ø´Ø§Ø· ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ`),yield new Promise(N=>setTimeout(N,500)),g("ÙØ­Øµ",4,9,"Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ..."),M.applyComplianceAdjustments(y);const v=M.generateComplianceReport(y);o(`âœ… ÙØ­Øµ SBC: ${v.compliantActivities} Ù…Ù…ØªØ«Ù„ØŒ ${v.nonCompliantActivities} ÙŠØ­ØªØ§Ø¬ ØªØ¹Ø¯ÙŠÙ„`),yield new Promise(N=>setTimeout(N,500)),g("Ø¹Ù„Ø§Ù‚Ø§Øª",5,9,"Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†Ø·Ù‚ÙŠØ© (FS/SS/FF/SF)..."),E.autoGenerateDependencies(y),o("âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©"),yield new Promise(N=>setTimeout(N,500)),g("CPM",6,9,"Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬...");const S=E.performCPM(y,new Date(h));y=y.map(N=>S.criticalActivities.find($=>$.id===N.id)||N),o(`âœ… Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬: ${S.criticalPath.length} Ù†Ø´Ø§Ø· Ø­Ø±Ø¬ | Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${S.projectDuration} ÙŠÙˆÙ…`),yield new Promise(N=>setTimeout(N,500)),g("ØªÙ‚ÙˆÙŠÙ…",7,9,"Ø¬Ø§Ø±ÙŠ ØªØ·Ø¨ÙŠÙ‚ ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ (Ø¹Ø·Ù„ØŒ Ø£Ù…Ø·Ø§Ø±ØŒ Ø±Ù…Ø¶Ø§Ù†)..."),o("âœ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ù…Ø¹ Ø§Ø­ØªÙŠØ§Ø·ÙŠ 6% Ù„Ù„Ø£Ù…Ø·Ø§Ø± ÙˆØªØ¹Ø¯ÙŠÙ„ Ø±Ù…Ø¶Ø§Ù†"),yield new Promise(N=>setTimeout(N,500)),g("Ù…ÙˆØ§Ø²Ù†Ø©",8,9,"Ø¬Ø§Ø±ÙŠ Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„Ø£Ø­Ù…Ø§Ù„ Ø§Ù„Ø¹Ù…Ø§Ù„ÙŠØ©...");const{ResourceLevelingEngine:D}=yield me(()=>L(null,null,function*(){const{ResourceLevelingEngine:N}=yield import("./ResourceLevelingEngine-sZiwPOTa.js");return{ResourceLevelingEngine:N}}),[]),k=D.performResourceLeveling(y);o(`âœ… Peak: ${k.peakLabor} | Average: ${k.averageLabor} | Ratio: ${(k.peakToAverageRatio*100).toFixed(0)}%`),yield new Promise(N=>setTimeout(N,500)),g("ØªØ³Ù„ÙŠÙ…",9,9,"Ø¬Ø§Ø±ÙŠ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©...");const A=(void 0).extractMilestones(y);o(`âœ… ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ${A.length} Ù†Ù‚Ø·Ø© ØªØ³Ù„ÙŠÙ… Ø±Ø¦ÙŠØ³ÙŠØ©`),yield new Promise(N=>setTimeout(N,500));const I=fe(x,y);p(y,I,m),d(null),o(`
                ğŸ‰ ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­! - ÙƒØ§Ù…Ù„ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¹Ø´Ø± âœ…
                
                ğŸ“Š ${m.length} Ø¨Ù†Ø¯ ÙÙŠ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©
                âš¡ ${y.length} Ù†Ø´Ø§Ø· ØªÙØµÙŠÙ„ÙŠ
                ğŸ¯ ${S.criticalPath.length} Ù†Ø´Ø§Ø· Ø­Ø±Ø¬
                ğŸ“… ${S.projectDuration} ÙŠÙˆÙ… Ù…Ø¯Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
                âœ… ${v.compliancePercentage.toFixed(1)}% Ø§Ù…ØªØ«Ø§Ù„ SBC
                ğŸ‘· Peak Labor: ${k.peakLabor} | Ratio: ${(k.peakToAverageRatio*100).toFixed(0)}%
                ${k.isBalanced?"âœ… Ù…ØªÙˆØ§Ø²Ù†":"âš ï¸ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†"}
                ğŸ“ ${A.length} Ù†Ù‚Ø§Ø· ØªØ³Ù„ÙŠÙ… Ø±Ø¦ÙŠØ³ÙŠØ©
            `)}catch(m){console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯:",m),l(`Ø®Ø·Ø£: ${m.message}`),d(null)}finally{t(!1)}});return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(O,{className:"w-6 h-6 ml-2 text-yellow-500"}),e.jsx("h2",{className:"text-2xl font-bold",children:"Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø°ÙƒÙŠ - Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg mb-6",children:[e.jsxs("h3",{className:"font-bold text-blue-800 dark:text-blue-200 mb-2 flex items-center",children:[e.jsx(ne,{className:"w-5 h-5 ml-2"}),"ğŸ¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - 9 Ù…Ø±Ø§Ø­Ù„ Ù…ØªÙƒØ§Ù…Ù„Ø©"]}),e.jsxs("ul",{className:"text-sm space-y-1 mr-4 text-blue-700 dark:text-blue-300",children:[e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1-2:"})," Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3:"})," ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø£Ù†Ø´Ø·Ø© Ù…Ø¹ Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ÙˆØ±Ø¯ÙŠØ§Øª (1.0 / 0.6 / 0.45)"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4:"})," ÙØ­Øµ Ø§Ù…ØªØ«Ø§Ù„ SBC 2024"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 5:"})," Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª (FS, SS, FF, SF) + Lag/Lead"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 6:"})," Ø­Ø³Ø§Ø¨ CPM ÙˆØ§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±Ø¬"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 7:"})," ØªØ·Ø¨ÙŠÙ‚ Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„Ø²Ù…Ù† (3%, 5%, 6%, 8%)"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 8:"})," Ù…ÙˆØ§Ø²Ù†Ø© Ø§Ù„Ø£Ø­Ù…Ø§Ù„ (Peak â‰¤ 120% Average)"]}),e.jsxs("li",{children:["âœ… ",e.jsx("strong",{children:"Ø§Ù„Ù…Ø±Ø­Ù„Ø© 9:"})," Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ³Ù„ÙŠÙ… (Milestones)"]}),e.jsxs("li",{children:["ğŸ“Š ",e.jsx("strong",{children:"Ø§Ù„Ù†ØªÙŠØ¬Ø©:"})," 470 Ø¨Ù†Ø¯ â†’ 1500+ Ù†Ø´Ø§Ø· Ø¬Ø§Ù‡Ø² Ù„Ù€ Primavera P6"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"}),e.jsx("input",{type:"date",value:h,onChange:m=>f(m.target.value),className:"w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700",disabled:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ù…Ù„Ù Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© (Excel)"}),e.jsx("input",{type:"file",onChange:u,accept:".xlsx,.xls",className:"w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700",disabled:n}),r&&e.jsxs("p",{className:"text-sm text-green-600 mt-2 flex items-center",children:[e.jsx(ie,{className:"w-4 h-4 ml-1"}),"ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ",r.name]})]}),b&&e.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"font-semibold",children:b.phase}),e.jsxs("span",{className:"text-sm text-gray-600",children:[b.current,"/",b.total]})]}),e.jsx("div",{className:"w-full bg-gray-300 dark:bg-gray-700 rounded-full h-3 mb-2",children:e.jsx("div",{className:"bg-indigo-600 h-3 rounded-full transition-all duration-300",style:{width:`${b.current/b.total*100}%`}})}),e.jsx("p",{className:"text-sm text-gray-600",children:b.details})]}),i&&!c&&e.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 rounded-lg whitespace-pre-line",children:i}),c&&e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 rounded-lg flex items-start",children:[e.jsx(oe,{className:"w-5 h-5 ml-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:c})]}),e.jsx("button",{onClick:a,disabled:!r||n,className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-4 px-6 rounded-lg hover:from-indigo-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-500 font-bold text-lg flex items-center justify-center shadow-lg",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white ml-3"}),"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-6 h-6 ml-2"}),"ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"]})})]})]})};function fe(p,r){const s=new Map;for(const n of p){const t=n.category||"99";s.has(t)||s.set(t,{code:t,level:1,name:`ÙØ¦Ø© ${t}`,activities:[],totalDuration:0,totalCost:0});const i=s.get(t),o=r.filter(c=>c.wbsCode.startsWith(t));i.activities.push(...o),i.totalDuration=Math.max(i.totalDuration,...o.map(c=>c.duration)),i.totalCost+=n.originalItem.total}return Array.from(s.values())}typeof window!="undefined"&&typeof pdfjsLib!="undefined"&&(pdfjsLib.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`);const ye=(p,r)=>{const s=p.map(i=>({"Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯":i.id,Ø§Ù„ÙˆØµÙ:i.item,Ø§Ù„ÙˆØ­Ø¯Ø©:i.unit,Ø§Ù„ÙƒÙ…ÙŠØ©:i.quantity,"Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©":i.unitPrice,Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:i.total})),n=XLSX.utils.json_to_sheet(s),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,n,"Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"),XLSX.writeFile(t,`${r}_${new Date().toISOString().split("T")[0]}.xlsx`)},je=p=>new Promise((r,s)=>{const n=new FileReader;n.onload=t=>{var i;try{const o=new Uint8Array((i=t.target)==null?void 0:i.result),c=XLSX.read(o,{type:"array"}),l=c.SheetNames[0],h=c.Sheets[l],f=XLSX.utils.sheet_to_json(h,{header:1}),b=[{keys:["Ø±Ù‚Ù…","item","no"],col:"id"},{keys:["ÙˆØµÙ","description","Ø¨Ù†Ø¯"],col:"description"},{keys:["ÙˆØ­Ø¯Ø©","unit"],col:"unit"},{keys:["ÙƒÙ…ÙŠØ©","quantity","qty"],col:"quantity"},{keys:["Ø³Ø¹Ø±","price","unit price"],col:"unitPrice"},{keys:["Ø¥Ø¬Ù…Ø§Ù„ÙŠ","total","amount"],col:"total"}];let d=-1,u={};for(let m=0;m<f.length&&d===-1;m++){const x=f[m];for(let j=0;j<x.length;j++){const y=String(x[j]||"").toLowerCase().trim();for(const v of b)if(v.keys.some(S=>y.includes(S))){u[v.col]=j,d=m;break}}}if(d===-1||Object.keys(u).length<4)return s(new Error("ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù."));const g=[];let a=1;for(let m=d+1;m<f.length;m++){const x=f[m],j=String(x[u.description]||"").trim(),y=String(x[u.unit]||"").trim(),v=Number(x[u.quantity])||0,S=Number(x[u.unitPrice])||0;let D=u.total!==void 0&&Number(x[u.total])||0;const k=u.id!==void 0?String(x[u.id]||"").trim():`f-import-${a}`;D===0&&v>0&&S>0?D=v*S:D>0&&S===0&&v>0,j&&(v>0||D>0)&&(g.push({id:k||`f-import-${a++}`,item:j,unit:y,quantity:v,unitPrice:S,total:D}),a++)}if(g.length===0)return s(new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨Ù†ÙˆØ¯ ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ù„Ù."));r(g)}catch(o){s(new Error("ÙØ´Ù„ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù Excel."))}},n.onerror=()=>s(new Error("ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù.")),n.readAsArrayBuffer(p)}),we=(p,r)=>{const s=p.map(i=>({"Ø±Ù‚Ù… Ø§Ù„Ù…Ù‡Ù…Ø©":i.id,"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·":i.name,"ÙƒÙˆØ¯ WBS":i.wbsCode||"N/A","ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø¡":i.start,"ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡":i.end,Ø§Ù„Ø­Ø§Ù„Ø©:i.status==="To Do"?"ØºÙŠØ± Ù…ÙÙ†Ø¬Ø²":i.status==="In Progress"?"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°":"Ù…ÙÙ†Ø¬Ø²","Ø§Ù„ØªÙ‚Ø¯Ù… %":i.progress,Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:i.priority==="High"?"Ø¹Ø§Ù„ÙŠØ©":i.priority==="Medium"?"Ù…ØªÙˆØ³Ø·Ø©":"Ù…Ù†Ø®ÙØ¶Ø©"})),n=XLSX.utils.json_to_sheet(s),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,n,"Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ"),XLSX.writeFile(t,`${r}_SCHEDULE_${new Date().toISOString().split("T")[0]}.xlsx`)},Ne=({onImportSuccess:p})=>{const[r,s]=w.useState(null),[n,t]=w.useState(!1),[i,o]=w.useState(null),[c,l]=w.useState(""),[h,f]=w.useState("file"),b=u=>{var a;const g=((a=u.target.files)==null?void 0:a[0])||null;g&&g.name.endsWith(".xlsx")?(s(g),o(null)):(s(null),o("ØµÙŠØºØ© Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø©. Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel (.xlsx)"))},d=()=>L(null,null,function*(){t(!0),o(null);try{let u=[],g="";if(h==="file"){if(!r)throw new Error("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹.");g=r.name,u=yield je(r)}else g="Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ",u=c.split(`
`).filter(m=>m.trim()!=="").map((m,x)=>{const j=m.split("|").map($=>$.trim()),[y,v,S,D,k]=j,A=Number(S)||0,I=Number(D)||0,N=Number(k)||0;let P=0;return N>0?P=N:I===0&&A>0&&j.length>=4?P=A*Number(j[3]):P=A*I,{id:`f-manual-${x+1}`,item:y,unit:v,quantity:A,unitPrice:I,total:P}});if(u.length===0)throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£ÙŠ Ø¨Ù†ÙˆØ¯.");p(u,g),alert(`ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ ${u.length} Ø¨Ù†Ø¯ Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù† ${g}.`),s(null),l("")}catch(u){o(u.message)}finally{t(!1)}});return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(le,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>f("file"),className:`px-4 py-2 ${h==="file"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù"}),e.jsx("button",{onClick:()=>f("manual"),className:`px-4 py-2 ${h==="manual"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"Ø¥Ø¯Ø®Ø§Ù„ ÙŠØ¯ÙˆÙŠ"})]})}),e.jsxs("div",{className:"space-y-4",children:[h==="file"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ø§Ø®ØªØ± Ù…Ù„Ù Excel (.xlsx)"}),e.jsx("input",{type:"file",onChange:b,accept:".xlsx",className:"w-full p-2 border rounded-lg dark:bg-slate-800 dark:border-slate-700"}),r&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ø¯Ø¯: ",r.name]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ø£Ø¯Ø®Ù„ Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© (ÙƒÙ„ Ø¨Ù†Ø¯ ÙÙŠ Ø³Ø·Ø±)"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"ğŸ“ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚:"}),e.jsx("p",{children:"ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯ | Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„ÙƒÙ…ÙŠØ© | Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"}),e.jsx("p",{className:"mt-2 font-semibold",children:"âœ… Ù…Ø«Ø§Ù„ ØµØ­ÙŠØ­:"}),e.jsx("p",{className:"font-mono",children:"Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© | Ù…3 | 100 | 500 | 50000"}),e.jsx("p",{className:"mt-1 font-mono",children:"Ø£Ø¹Ù…Ø§Ù„ Ø­ÙØ± | Ù…3 | 200 | 50"}),e.jsx("p",{className:"mt-2 text-xs text-amber-600 dark:text-amber-400",children:"ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¥Ø°Ø§ ÙƒØ§Ù† Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© = 0ØŒ Ø³ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø©"})]}),e.jsx("textarea",{value:c,onChange:u=>l(u.target.value),placeholder:`ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯ | Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„ÙƒÙ…ÙŠØ© | Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
Ù…Ø«Ø§Ù„: Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© | Ù…3 | 100 | 500 | 50000
Ù…Ø«Ø§Ù„: Ø£Ø¹Ù…Ø§Ù„ Ø­ÙØ± | Ù…3 | 200 | 50`,rows:8,className:"w-full p-3 border rounded-lg dark:bg-slate-800 dark:border-slate-700 font-mono text-sm"})]}),i&&e.jsx("p",{className:"text-sm text-red-500",children:i}),e.jsx("button",{onClick:d,disabled:n,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 disabled:bg-gray-400 font-semibold",children:n?"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...":"ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯"})]})]})},ve=({financials:p,schedule:r,onUpdateFinancials:s})=>{const[n,t]=w.useState(""),[i,o]=w.useState({item:"",unit:"",quantity:0,unitPrice:0}),c=w.useMemo(()=>p.filter(d=>d.item.toLowerCase().includes(n.toLowerCase())||d.id.toLowerCase().includes(n.toLowerCase())),[p,n]),l=()=>{if(!i.item.trim())return;const d=T(C({},i),{id:`f-manual-${Date.now()}`,total:i.quantity*i.unitPrice});s([...p,d]),o({item:"",unit:"",quantity:0,unitPrice:0})},h=(d,u,g)=>{s(p.map(a=>{if(a.id===d){const m=T(C({},a),{[u]:g});return(u==="quantity"||u==="unitPrice")&&(m.total=Number(m.quantity)*Number(m.unitPrice)),m}return a}))},f=d=>{s(p.filter(u=>u.id!==d))},b=()=>{ye(p,"BOQ_Manual_Export")};return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Ø¥Ø¯Ø§Ø±Ø© Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"})]}),e.jsxs("button",{onClick:b,disabled:p.length===0,className:"flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-semibold",children:[e.jsx(F,{className:"w-4 h-4"})," ØªØµØ¯ÙŠØ± Excel"]})]}),e.jsxs("div",{className:"border p-4 rounded-lg mb-6 bg-slate-50 dark:bg-slate-800/50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯ Ø¬Ø¯ÙŠØ¯"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsx("input",{placeholder:"ÙˆØµÙ Ø§Ù„Ø¨Ù†Ø¯",value:i.item,onChange:d=>o(T(C({},i),{item:d.target.value})),className:"col-span-2 p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{placeholder:"Ø§Ù„ÙˆØ­Ø¯Ø©",value:i.unit,onChange:d=>o(T(C({},i),{unit:d.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"number",placeholder:"Ø§Ù„ÙƒÙ…ÙŠØ©",value:i.quantity,onChange:d=>o(T(C({},i),{quantity:Number(d.target.value)})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"number",placeholder:"Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©",value:i.unitPrice,onChange:d=>o(T(C({},i),{unitPrice:Number(d.target.value)})),className:"p-2 border rounded-lg dark:bg-slate-700"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs("p",{className:"font-bold text-lg",children:["Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ",(i.quantity*i.unitPrice).toLocaleString()," Ø±ÙŠØ§Ù„"]}),e.jsxs("button",{onClick:l,className:"flex items-center gap-2 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 font-semibold",children:[e.jsx(U,{className:"w-4 h-4"})," Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯"]})]})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(V,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„ÙˆØµÙ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯...",value:n,onChange:d=>t(d.target.value),className:"w-full p-2 pr-10 border rounded-lg dark:bg-slate-800"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ù†ÙˆØ¯ (",c.length," Ù…Ù† ",p.length,")"]}),e.jsxs("table",{className:"min-w-full text-right border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800",children:e.jsx("tr",{children:["Ø§Ù„ÙˆØµÙ","Ø§Ù„ÙˆØ­Ø¯Ø©","Ø§Ù„ÙƒÙ…ÙŠØ©","Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©","Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ","Ø¥Ø¬Ø±Ø§Ø¡"].map(d=>e.jsx("th",{className:"p-3 text-sm font-medium border-b",children:d},d))})}),e.jsx("tbody",{children:c.map(d=>e.jsxs("tr",{className:"border-b hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{value:d.item,onChange:u=>h(d.id,"item",u.target.value),className:"w-full p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{value:d.unit,onChange:u=>h(d.id,"unit",u.target.value),className:"w-20 p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",value:d.quantity,onChange:u=>h(d.id,"quantity",Number(u.target.value)),className:"w-24 p-1 border rounded dark:bg-slate-700 text-right"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",value:d.unitPrice,onChange:u=>h(d.id,"unitPrice",Number(u.target.value)),className:"w-24 p-1 border rounded dark:bg-slate-700 text-right"})}),e.jsx("td",{className:"p-2 font-bold text-blue-600",children:d.total.toLocaleString()}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>f(d.id),className:"text-red-600 hover:text-red-800",children:e.jsx(G,{className:"w-4 h-4"})})})]},d.id))})]})]})]})},Se=({financials:p})=>{const r=w.useMemo(()=>p.reduce((n,t)=>n+t.total,0),[p]),s=w.useMemo(()=>p.length>0?r/p.length:0,[r,p]);return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(de,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ø§Ù…"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[r.toLocaleString()," Ø±ÙŠØ§Ù„"]})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:p.length})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙƒÙ„ÙØ©"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[s.toLocaleString()," Ø±ÙŠØ§Ù„"]})]})]})]})},ke=({schedule:p,financials:r,onUpdateSchedule:s})=>{const[n,t]=w.useState(p),[i,o]=w.useState("");w.useEffect(()=>{t(p)},[p]);const c=w.useMemo(()=>n.filter(g=>g.name.toLowerCase().includes(i.toLowerCase())||g.id.toString().includes(i)),[n,i]),[l,h]=w.useState({name:"",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],status:"To Do",priority:"Medium",wbsCode:"",category:"",dependencies:[]}),f=()=>{if(!l.name.trim())return;const g=T(C({},l),{id:Date.now(),progress:0}),a=[...n,g];t(a),s(a),h({name:"",start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0],status:"To Do",priority:"Medium",wbsCode:"",category:"",dependencies:[]})},b=(g,a,m)=>{const x=n.map(j=>j.id===g?T(C({},j),{[a]:m}):j);t(x),s(x)},d=g=>{const a=n.filter(m=>m.id!==g);t(a),s(a)},u=()=>{we(p,"Project_Schedule")};return e.jsxs("div",{className:"bg-white dark:bg-slate-900/50 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"w-5 h-5 ml-2"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ"})]}),e.jsxs("button",{onClick:u,disabled:p.length===0,className:"flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:bg-gray-400 font-semibold",children:[e.jsx(F,{className:"w-4 h-4"})," ØªØµØ¯ÙŠØ± Excel"]})]}),e.jsxs("div",{className:"border p-4 rounded-lg mb-6 bg-slate-50 dark:bg-slate-800/50",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsx("input",{placeholder:"Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·",value:l.name,onChange:g=>h(T(C({},l),{name:g.target.value})),className:"col-span-2 p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"date",value:l.start,onChange:g=>h(T(C({},l),{start:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsx("input",{type:"date",value:l.end,onChange:g=>h(T(C({},l),{end:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700"}),e.jsxs("select",{value:l.status,onChange:g=>h(T(C({},l),{status:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"To Do",children:"ØºÙŠØ± Ù…ÙÙ†Ø¬Ø²"}),e.jsx("option",{value:"In Progress",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"}),e.jsx("option",{value:"Done",children:"Ù…ÙÙ†Ø¬Ø²"})]}),e.jsxs("select",{value:l.priority,onChange:g=>h(T(C({},l),{priority:g.target.value})),className:"p-2 border rounded-lg dark:bg-slate-700",children:[e.jsx("option",{value:"High",children:"Ø¹Ø§Ù„ÙŠØ©"}),e.jsx("option",{value:"Medium",children:"Ù…ØªÙˆØ³Ø·Ø©"}),e.jsx("option",{value:"Low",children:"Ù…Ù†Ø®ÙØ¶Ø©"})]})]}),e.jsxs("button",{onClick:f,className:"mt-3 flex items-center gap-2 bg-indigo-600 text-white py-2 px-4 rounded-lg hover:bg-indigo-700 font-semibold",children:[e.jsx(U,{className:"w-4 h-4"})," Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©"]})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(V,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{placeholder:"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯...",value:i,onChange:g=>o(g.target.value),className:"w-full p-2 pr-10 border rounded-lg dark:bg-slate-800"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù… (",c.length," Ù…Ù† ",n.length,")"]}),e.jsxs("table",{className:"min-w-full text-right border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800",children:e.jsx("tr",{children:["Ø§Ù„Ø§Ø³Ù…","Ø¨Ø¯Ø¡","Ø§Ù†ØªÙ‡Ø§Ø¡","Ø­Ø§Ù„Ø©","ØªÙ‚Ø¯Ù… %","Ø¥Ø¬Ø±Ø§Ø¡"].map(g=>e.jsx("th",{className:"p-3 text-sm font-medium border-b",children:g},g))})}),e.jsx("tbody",{children:c.map(g=>e.jsxs("tr",{className:"border-b hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-2",children:e.jsx("input",{value:g.name,onChange:a=>b(g.id,"name",a.target.value),className:"w-full p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",value:g.start,onChange:a=>b(g.id,"start",a.target.value),className:"p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"date",value:g.end,onChange:a=>b(g.id,"end",a.target.value),className:"p-1 border rounded dark:bg-slate-700"})}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{value:g.status,onChange:a=>b(g.id,"status",a.target.value),className:"p-1 border rounded dark:bg-slate-700",children:[e.jsx("option",{value:"To Do",children:"ØºÙŠØ± Ù…ÙÙ†Ø¬Ø²"}),e.jsx("option",{value:"In Progress",children:"Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°"}),e.jsx("option",{value:"Done",children:"Ù…ÙÙ†Ø¬Ø²"})]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",value:g.progress,onChange:a=>b(g.id,"progress",Number(a.target.value)),min:"0",max:"100",className:"w-20 p-1 border rounded dark:bg-slate-700 text-right"})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{onClick:()=>d(g.id),className:"text-red-600 hover:text-red-800",children:e.jsx(G,{className:"w-4 h-4"})})})]},g.id))})]})]})]})},Ie=({project:p,onUpdateFinancials:r,onUpdateSchedule:s})=>{const[n,t]=w.useState(p.data.financials||[]),[i,o]=w.useState(p.data.schedule||[]),[c,l]=w.useState("import"),[h,f]=w.useState([]),[b,d]=w.useState([]),[u,g]=w.useState([]);w.useEffect(()=>{t(p.data.financials||[]),o(p.data.schedule||[])},[p]);const a=(y,v)=>{const S=[...n,...y];t(S),r(p.id,S)},m=y=>{t(y),r(p.id,y)},x=y=>{o(y),s(p.id,y)},j=(y,v,S)=>{f(y),d(v),g(S),l("noufal-view");const D=y.filter(A=>A.isCritical).length,k=S.length>0?(y.length/S.length).toFixed(1):"0";alert(`âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø¨Ù†Ø¬Ø§Ø­!

ğŸ“Š Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠØ©: ${S.length} Ø¨Ù†Ø¯
ğŸ”§ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø³ØªØ®Ø±Ø¬Ø©: ${y.length} Ù†Ø´Ø§Ø·
ğŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙˆØ³Ø¹: ${k}x
âš ï¸ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø­Ø±Ø¬Ø©: ${D} Ù†Ø´Ø§Ø·
ğŸ“ Ø£Ù‚Ø³Ø§Ù… WBS: ${v.length} Ù‚Ø³Ù…

ØªÙ… ØªØ­Ù„ÙŠÙ„ Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø¨Ù†ÙˆØ¯ ÙˆØªÙ‚Ø³ÙŠÙ…Ù‡Ø§ Ø¥Ù„Ù‰ Ø£Ù†Ø´Ø·Ø© Ù…ØªØ¹Ø¯Ø¯Ø©!`)};return e.jsxs("div",{className:"p-6 bg-gray-50 dark:bg-gray-900 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø§Øª ÙˆØ§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠØ© - Ù†Ø¸Ø§Ù… NOUFAL Ø§Ù„Ù…ØªÙ‚Ø¯Ù…"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>l("import"),className:`px-4 py-3 font-semibold ${c==="import"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"1. Ø§Ø³ØªÙŠØ±Ø§Ø¯"}),e.jsx("button",{onClick:()=>l("manage"),className:`px-4 py-3 font-semibold ${c==="manage"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"2. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"}),e.jsx("button",{onClick:()=>l("analysis"),className:`px-4 py-3 font-semibold ${c==="analysis"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"3. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"}),e.jsx("button",{onClick:()=>l("schedule"),className:`px-4 py-3 font-semibold ${c==="schedule"?"border-b-2 border-indigo-500 text-indigo-600":"text-gray-500"}`,children:"4. Ø¬Ø¯ÙˆÙ„ ÙŠØ¯ÙˆÙŠ"}),e.jsx("button",{onClick:()=>l("noufal-generate"),className:`px-4 py-3 font-semibold ${c==="noufal-generate"?"border-b-2 border-green-500 text-green-600":"text-gray-500"}`,children:"5. â˜… ØªÙˆÙ„ÙŠØ¯ NOUFAL"}),e.jsx("button",{onClick:()=>l("noufal-view"),className:`px-4 py-3 font-semibold ${c==="noufal-view"?"border-b-2 border-green-500 text-green-600":"text-gray-500"}`,disabled:h.length===0,children:"6. â˜… Ø¹Ø§Ø±Ø¶ NOUFAL"})]})}),e.jsxs("div",{className:"mt-6",children:[c==="import"&&e.jsx(Ne,{onImportSuccess:a}),c==="manage"&&e.jsx(ve,{financials:n,schedule:i,onUpdateFinancials:m}),c==="analysis"&&e.jsx(Se,{financials:n}),c==="schedule"&&e.jsx(ke,{schedule:i,financials:n,onUpdateSchedule:x}),c==="noufal-generate"&&e.jsx(be,{onScheduleGenerated:j}),c==="noufal-view"&&e.jsx(ge,{activities:h,wbs:b,projectName:p.name})]})]})};export{Ie as BOQManualManager,Ie as default};
