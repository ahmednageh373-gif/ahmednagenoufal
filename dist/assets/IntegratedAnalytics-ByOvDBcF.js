import{r as b,j as e}from"./react-vendor-ITqvX6Xp.js";import{c as w,F as S,a9 as W,bi as Y,D as p,a3 as $,u as B,aX as j,j as C,k as Z}from"./icons-lib-Dd_BpYQ6.js";import"./vendor-8CkhJSGZ.js";const ae=({projects:m,currentProject:i})=>{const[r,n]=b.useState("summary"),[c,T]=b.useState("month"),[f,_]=b.useState(!1),s=b.useMemo(()=>{var R;const t=i,l=t.data.schedule.length,d=t.data.schedule.filter(a=>a.progress===100).length,z=t.data.schedule.filter(a=>a.progress>0&&a.progress<100).length,V=l-d-z,h=l>0?d/l*100:0,o=t.data.financials.reduce((a,x)=>a+x.total,0),k=o*(h/100),E=o-k,L=t.data.riskRegister.length,I=t.data.riskRegister.filter(a=>a.status==="Open").length,O=t.data.riskRegister.filter(a=>a.status==="Open"&&a.probability==="High"&&a.impact==="High").length,H=((R=t.data.members)==null?void 0:R.length)||0,P=new Date(t.startDate),U=new Date(t.endDate||t.startDate),X=new Date,N=Math.ceil((U.getTime()-P.getTime())/(1e3*60*60*24)),v=Math.ceil((X.getTime()-P.getTime())/(1e3*60*60*24)),q=N-v,u=Math.max(0,Math.min(100,v/N*100)),G=h-u,J=u>0?h/u:1,K=o>0?o/(k||1):1,Q=t.data.schedule.reduce((a,x)=>{const g=x.category||"غير مصنف";return a[g]||(a[g]={total:0,completed:0,inProgress:0}),a[g].total++,x.progress===100?a[g].completed++:x.progress>0&&a[g].inProgress++,a},{});return{schedule:{totalTasks:l,completedTasks:d,inProgressTasks:z,notStartedTasks:V,overallProgress:h,plannedProgress:u,scheduleVariance:G,spi:J},financial:{totalBudget:o,spentBudget:k,remainingBudget:E,cpi:K},risks:{totalRisks:L,openRisks:I,highPriorityRisks:O},resources:{teamSize:H},time:{totalDuration:N,elapsedDays:v,remainingDays:q},categoryStats:Q}},[i]),F=()=>{alert("سيتم إنشاء تقرير PDF شامل مع الرسوم البيانية والإحصائيات")},M=()=>{alert("سيتم إنشاء تقرير Excel تفصيلي مع جميع البيانات")},A=()=>{alert("سيتم مشاركة التقرير عبر البريد الإلكتروني أو رابط")};return e.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-br from-gray-50 to-indigo-50 dark:from-gray-900 dark:to-indigo-900/20",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx(w,{className:"text-indigo-600"}),"التحليلات والتقارير المتكاملة - ",i.name]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"تحليلات شاملة ومتعددة الأبعاد مع تقارير احترافية"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[e.jsx(S,{size:18}),"PDF"]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(W,{size:18}),"Excel"]}),e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Y,{size:18}),"مشاركة"]})]})]}),e.jsx("div",{className:"flex gap-2 border-b border-gray-200 dark:border-gray-700",children:[{key:"summary",label:"التقرير الموجز",icon:w},{key:"financial",label:"التحليل المالي",icon:p},{key:"schedule",label:"تحليل الجدول",icon:$},{key:"resources",label:"تحليل الموارد",icon:B},{key:"risks",label:"تحليل المخاطر",icon:j},{key:"custom",label:"تقرير مخصص",icon:S}].map(t=>e.jsxs("button",{onClick:()=>n(t.key),className:`flex items-center gap-2 px-4 py-2 border-b-2 transition-colors ${r===t.key?"border-indigo-600 text-indigo-600 dark:text-indigo-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[e.jsx(t.icon,{size:18}),t.label]},t.key))})]}),r==="summary"&&e.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(y,{title:"التقدم الإجمالي",value:`${s.schedule.overallProgress.toFixed(1)}%`,subtitle:`${s.schedule.completedTasks} / ${s.schedule.totalTasks} مهمة`,icon:C,color:"bg-blue-600",trend:s.schedule.scheduleVariance>=0?"positive":"negative",trendValue:`${Math.abs(s.schedule.scheduleVariance).toFixed(1)}%`}),e.jsx(y,{title:"الأداء المالي",value:`${s.financial.cpi.toFixed(2)}`,subtitle:`${s.financial.spentBudget.toLocaleString("ar-SA")} من ${s.financial.totalBudget.toLocaleString("ar-SA")}`,icon:p,color:"bg-green-600",trend:s.financial.cpi>=1?"positive":"negative",trendValue:`CPI ${s.financial.cpi>=1?"جيد":"ضعيف"}`}),e.jsx(y,{title:"أداء الجدول",value:`${s.schedule.spi.toFixed(2)}`,subtitle:`${s.time.elapsedDays} / ${s.time.totalDuration} يوم`,icon:$,color:"bg-purple-600",trend:s.schedule.spi>=1?"positive":"negative",trendValue:`SPI ${s.schedule.spi>=1?"متقدم":"متأخر"}`}),e.jsx(y,{title:"المخاطر المفتوحة",value:s.risks.openRisks.toString(),subtitle:`${s.risks.highPriorityRisks} عالي الأولوية`,icon:j,color:"bg-red-600",trend:s.risks.openRisks===0?"positive":"negative",trendValue:`${s.risks.totalRisks} إجمالي`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(Z,{size:20}),"حالة المهام"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(D,{label:"مكتملة",count:s.schedule.completedTasks,total:s.schedule.totalTasks,color:"bg-green-500"}),e.jsx(D,{label:"قيد التنفيذ",count:s.schedule.inProgressTasks,total:s.schedule.totalTasks,color:"bg-blue-500"}),e.jsx(D,{label:"لم تبدأ",count:s.schedule.notStartedTasks,total:s.schedule.totalTasks,color:"bg-gray-400"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(p,{size:20}),"استخدام الميزانية"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"المصروفات"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[s.financial.spentBudget.toLocaleString("ar-SA")," ريال"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full",style:{width:`${s.financial.spentBudget/s.financial.totalBudget*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"المتبقي"}),e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[s.financial.remainingBudget.toLocaleString("ar-SA")," ريال"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4",children:e.jsx("div",{className:"bg-green-500 h-4 rounded-full",style:{width:`${s.financial.remainingBudget/s.financial.totalBudget*100}%`}})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"الميزانية الإجمالية"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[s.financial.totalBudget.toLocaleString("ar-SA")," ريال"]})]})})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(w,{size:20}),"التقدم حسب الفئة"]}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.categoryStats).map(([t,l])=>{const d=l.total>0?l.completed/l.total*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:[l.completed," / ",l.total," (",d.toFixed(0),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-indigo-600 h-3 rounded-full",style:{width:`${d}%`}})})]},t)})})]})]}),r!=="summary"&&e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 text-center border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"mb-4",children:[r==="financial"&&e.jsx(p,{size:48,className:"mx-auto text-green-600"}),r==="schedule"&&e.jsx($,{size:48,className:"mx-auto text-blue-600"}),r==="resources"&&e.jsx(B,{size:48,className:"mx-auto text-purple-600"}),r==="risks"&&e.jsx(j,{size:48,className:"mx-auto text-red-600"}),r==="custom"&&e.jsx(S,{size:48,className:"mx-auto text-indigo-600"})]}),e.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:[r==="financial"&&"التحليل المالي التفصيلي",r==="schedule"&&"تحليل الجدول الزمني التفصيلي",r==="resources"&&"تحليل الموارد التفصيلي",r==="risks"&&"تحليل المخاطر التفصيلي",r==="custom"&&"إنشاء تقرير مخصص"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"سيتم إضافة التحليلات التفصيلية والرسوم البيانية المتقدمة هنا"})]})})]})},y=({title:m,value:i,subtitle:r,icon:n,color:c,trend:T,trendValue:f})=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${c}`,children:e.jsx(n,{className:"text-white",size:24})}),T==="positive"?e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(C,{size:16}),e.jsx("span",{className:"text-xs font-medium",children:f})]}):e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(j,{size:16}),e.jsx("span",{className:"text-xs font-medium",children:f})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-1",children:m}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:i}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r})]}),D=({label:m,count:i,total:r,color:n})=>{const c=r>0?i/r*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:m}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[i," (",c.toFixed(0),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:`${n} h-3 rounded-full`,style:{width:`${c}%`}})})]})};export{ae as IntegratedAnalytics,ae as default};
