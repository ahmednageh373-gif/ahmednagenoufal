const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-large-gsDFeA65.js","assets/vendor-8CkhJSGZ.js","assets/react-vendor-ITqvX6Xp.js"])))=>i.map(i=>d[i]);
var T=Object.defineProperty,M=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var R=(e,n,t)=>n in e?T(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,b=(e,n)=>{for(var t in n||(n={}))_.call(n,t)&&R(e,t,n[t]);if(E)for(var t of E(n))L.call(n,t)&&R(e,t,n[t]);return e},f=(e,n)=>M(e,O(n));var k=(e,n,t)=>new Promise((s,u)=>{var p=l=>{try{m(t.next(l))}catch(g){u(g)}},d=l=>{try{m(t.throw(l))}catch(g){u(g)}},m=l=>l.done?s(l.value):Promise.resolve(l.value).then(p,d);m((t=t.apply(e,n)).next())});import{r as $,j as o}from"./react-vendor-ITqvX6Xp.js";import{_ as U,E as G,a as Q,r as J,u as K}from"./vendor-large-gsDFeA65.js";import{ag as V,ah as H}from"./vendor-8CkhJSGZ.js";import{g as Y,e as X,j as Z,U as ee,F as W,aW as te,u as ne,a3 as oe,D as ae,a9 as se}from"./icons-lib-Dd_BpYQ6.js";const re=[{id:"exc-001",nameAr:"Ø­ÙØ± ÙˆØªØ³ÙˆÙŠØ©",nameEn:"Excavation and Leveling",category:"excavation",keywords:["Ø­ÙØ±","excavation","dig","ØªØ³ÙˆÙŠØ©","leveling","Ø­ÙØ±ÙŠØ§Øª"],subActivities:[{id:"exc-001-01",name:"Ù†Ù‚Ù„ Ù…Ø¹Ø¯Ø§Øª ÙˆØªØ¬Ù‡ÙŠØ² Ø§Ù„Ù…ÙˆÙ‚Ø¹",sequence:1,duration:.5,workers:[{role:"Ù…Ø´Ø±Ù",count:1,productivity:1e3,dailyCost:300},{role:"Ø¹Ø§Ù…Ù„",count:4,productivity:250,dailyCost:150}],productivity:1e3,unit:"Ù…3",dependencies:[]},{id:"exc-001-02",name:"Ø­ÙØ± Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ",sequence:2,duration:1,workers:[{role:"Ù…Ø´ØºÙ„ Ø­ÙØ§Ø±Ø©",count:1,productivity:200,dailyCost:400},{role:"Ù…Ø³Ø§Ø¹Ø¯",count:2,productivity:100,dailyCost:150}],productivity:200,unit:"Ù…3",dependencies:["exc-001-01"]},{id:"exc-001-03",name:"ØªØ³ÙˆÙŠØ© ÙˆØ¶ØºØ·",sequence:3,duration:.5,workers:[{role:"Ù…Ø´ØºÙ„ ÙƒÙ…Ø¨Ø±ÙŠØ³ÙˆØ±",count:1,productivity:300,dailyCost:350},{role:"Ø¹Ø§Ù…Ù„",count:3,productivity:100,dailyCost:150}],productivity:300,unit:"Ù…3",dependencies:["exc-001-02"]}],materials:[{name:"ÙˆÙ‚ÙˆØ¯ Ù…Ø¹Ø¯Ø§Øª",quantityPer:5,unit:"Ù„ØªØ±",wastePercentage:0},{name:"Ø±Ù…Ù„ Ù„Ù„Ø±Ø¯Ù…",quantityPer:.3,unit:"Ù…3",wastePercentage:10}],sbcReferences:["SBC 301.1","SBC 301.2"],executionMethod:"ÙŠØªÙ… Ø§Ù„Ø­ÙØ± Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø­ÙØ§Ø±Ø© Ù…Ø¹ Ù…Ø±Ø§Ø¹Ø§Ø© Ù…Ù†Ø³ÙˆØ¨ Ø§Ù„Ø­ÙØ± Ø­Ø³Ø¨ Ø§Ù„Ù…Ø®Ø·Ø·Ø§Øª"}],ie=[{id:"con-plain-001",nameAr:"Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ© Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª",nameEn:"Plain Concrete for Foundations",category:"concrete",keywords:["Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ©","plain concrete","Ù†Ø¸Ø§ÙØ©","blinding","Ø£Ø³Ø§Ø³Ø§Øª"],subActivities:[{id:"con-plain-001-01",name:"ØªØ¬Ù‡ÙŠØ² ÙˆØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹",sequence:1,duration:.2,workers:[{role:"Ø¹Ø§Ù…Ù„",count:4,productivity:100,dailyCost:150}],productivity:100,unit:"Ù…3",dependencies:[]},{id:"con-plain-001-02",name:"ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©",sequence:2,duration:.5,workers:[{role:"Ù…Ø´Ø±Ù ØµØ¨",count:1,productivity:40,dailyCost:300},{role:"Ø¹Ø§Ù…Ù„",count:6,productivity:8,dailyCost:150}],productivity:40,unit:"Ù…3",dependencies:["con-plain-001-01"]},{id:"con-plain-001-03",name:"ØªØ³ÙˆÙŠØ© ÙˆØªØ´Ø·ÙŠØ¨",sequence:3,duration:.3,workers:[{role:"Ø¹Ø§Ù…Ù„ ØªØ´Ø·ÙŠØ¨",count:3,productivity:50,dailyCost:180}],productivity:50,unit:"Ù…3",dependencies:["con-plain-001-02"]}],materials:[{name:"Ø®Ø±Ø³Ø§Ù†Ø© Ø¬Ø§Ù‡Ø²Ø©",quantityPer:1.05,unit:"Ù…3",wastePercentage:5}],sbcReferences:["SBC 304","SBC 304.1"],executionMethod:"ØµØ¨ Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ© Ø¨Ø¯Ø±Ø¬Ø© 150 ÙƒØ¬Ù…/Ø³Ù…2 Ø¨Ø³Ù…Ùƒ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø®Ø·Ø·Ø§Øª"}],le=[{id:"con-rc-001",nameAr:"Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© Ù„Ù„Ø£Ø¹Ù…Ø¯Ø©",nameEn:"Reinforced Concrete Columns",category:"concrete",keywords:["Ø£Ø¹Ù…Ø¯Ø©","columns","Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©","reinforced"],subActivities:[{id:"con-rc-001-01",name:"Ù†Ø¬Ø§Ø±Ø© (ØªØ®Ø´ÙŠØ¨)",sequence:1,duration:2,workers:[{role:"Ù†Ø¬Ø§Ø±",count:4,productivity:3,dailyCost:250},{role:"Ù…Ø³Ø§Ø¹Ø¯ Ù†Ø¬Ø§Ø±",count:4,productivity:3,dailyCost:150}],productivity:3,unit:"Ù…3",dependencies:[]},{id:"con-rc-001-02",name:"Ø­Ø¯Ø§Ø¯Ø© (ØªØ³Ù„ÙŠØ­)",sequence:2,duration:2,workers:[{role:"Ø­Ø¯Ø§Ø¯",count:3,productivity:150,dailyCost:250},{role:"Ù…Ø³Ø§Ø¹Ø¯ Ø­Ø¯Ø§Ø¯",count:3,productivity:150,dailyCost:150}],productivity:150,unit:"ÙƒØ¬Ù…",dependencies:["con-rc-001-01"]},{id:"con-rc-001-03",name:"ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©",sequence:3,duration:1,workers:[{role:"Ù…Ø´Ø±Ù ØµØ¨",count:1,productivity:20,dailyCost:300},{role:"Ø¹Ø§Ù…Ù„",count:6,productivity:4,dailyCost:150}],productivity:20,unit:"Ù…3",dependencies:["con-rc-001-02"]},{id:"con-rc-001-04",name:"Ù…Ø¹Ø§Ù„Ø¬Ø©",sequence:4,duration:7,workers:[{role:"Ø¹Ø§Ù…Ù„",count:1,productivity:100,dailyCost:150}],productivity:100,unit:"Ù…2",dependencies:["con-rc-001-03"]}],materials:[{name:"Ø®Ø±Ø³Ø§Ù†Ø© Ø¬Ø§Ù‡Ø²Ø©",quantityPer:1.05,unit:"Ù…3",wastePercentage:5},{name:"Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­",quantityPer:120,unit:"ÙƒØ¬Ù…",wastePercentage:8},{name:"Ø®Ø´Ø¨ Ø¨Ù„ÙŠÙˆØ¯",quantityPer:6,unit:"Ù„ÙˆØ­",wastePercentage:15},{name:"Ù…ÙˆØ§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø©",quantityPer:2,unit:"ÙƒØ¬Ù…",wastePercentage:5}],sbcReferences:["SBC 304","SBC 304.2","SBC 304.3"],executionMethod:"Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© Ø¨Ø¯Ø±Ø¬Ø© 30 Ù†ÙŠÙˆØªÙ†/Ù…Ù…2 Ù…Ø¹ Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø®Ø·Ø·Ø§Øª"},{id:"con-rc-002",nameAr:"Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© Ù„Ù„Ø¨Ù„Ø§Ø·Ø§Øª",nameEn:"Reinforced Concrete Slabs",category:"concrete",keywords:["Ø¨Ù„Ø§Ø·Ø©","slab","Ø³Ù‚Ù","Ø¨Ù„Ø§Ø·Ø§Øª","Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©"],subActivities:[{id:"con-rc-002-01",name:"Ù†Ø¬Ø§Ø±Ø© (ÙØ±Ù…)",sequence:1,duration:3,workers:[{role:"Ù†Ø¬Ø§Ø±",count:6,productivity:15,dailyCost:250},{role:"Ù…Ø³Ø§Ø¹Ø¯ Ù†Ø¬Ø§Ø±",count:6,productivity:15,dailyCost:150}],productivity:15,unit:"Ù…2",dependencies:[]},{id:"con-rc-002-02",name:"Ø­Ø¯Ø§Ø¯Ø© (ØªØ³Ù„ÙŠØ­)",sequence:2,duration:2,workers:[{role:"Ø­Ø¯Ø§Ø¯",count:4,productivity:200,dailyCost:250},{role:"Ù…Ø³Ø§Ø¹Ø¯ Ø­Ø¯Ø§Ø¯",count:4,productivity:200,dailyCost:150}],productivity:200,unit:"ÙƒØ¬Ù…",dependencies:["con-rc-002-01"]},{id:"con-rc-002-03",name:"ØµØ¨ Ø§Ù„Ø®Ø±Ø³Ø§Ù†Ø©",sequence:3,duration:1,workers:[{role:"Ù…Ø´Ø±Ù ØµØ¨",count:1,productivity:50,dailyCost:300},{role:"Ø¹Ø§Ù…Ù„",count:10,productivity:5,dailyCost:150}],productivity:50,unit:"Ù…3",dependencies:["con-rc-002-02"]},{id:"con-rc-002-04",name:"Ù…Ø¹Ø§Ù„Ø¬Ø©",sequence:4,duration:14,workers:[{role:"Ø¹Ø§Ù…Ù„",count:2,productivity:200,dailyCost:150}],productivity:200,unit:"Ù…2",dependencies:["con-rc-002-03"]}],materials:[{name:"Ø®Ø±Ø³Ø§Ù†Ø© Ø¬Ø§Ù‡Ø²Ø©",quantityPer:1.05,unit:"Ù…3",wastePercentage:5},{name:"Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­",quantityPer:100,unit:"ÙƒØ¬Ù…",wastePercentage:8},{name:"Ø®Ø´Ø¨ Ø¨Ù„ÙŠÙˆØ¯",quantityPer:1.2,unit:"Ù„ÙˆØ­",wastePercentage:15},{name:"Ù…ÙˆØ§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø©",quantityPer:3,unit:"ÙƒØ¬Ù…",wastePercentage:5}],sbcReferences:["SBC 304","SBC 304.4"],executionMethod:"Ø¨Ù„Ø§Ø·Ø© Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© Ø¨Ø³Ù…Ùƒ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø®Ø·Ø·Ø§Øª Ø§Ù„Ø¥Ù†Ø´Ø§Ø¦ÙŠØ©"}],ce=[{id:"mas-001",nameAr:"Ù…Ø¨Ø§Ù†ÙŠ Ø·ÙˆØ¨ Ø£Ø­Ù…Ø±",nameEn:"Red Brick Masonry",category:"masonry",keywords:["Ù…Ø¨Ø§Ù†ÙŠ","Ø·ÙˆØ¨","brick","masonry","Ø£Ø­Ù…Ø±","Ø¬Ø¯Ø§Ø±","Ø¬Ø¯Ø±Ø§Ù†"],subActivities:[{id:"mas-001-01",name:"Ø¨Ù†Ø§Ø¡ Ø¨Ø§Ù„Ø·ÙˆØ¨",sequence:1,duration:1,workers:[{role:"Ø¨Ù†Ø§Ø¡",count:4,productivity:8,dailyCost:250},{role:"Ù…Ø³Ø§Ø¹Ø¯",count:4,productivity:8,dailyCost:150}],productivity:8,unit:"Ù…2",dependencies:[]},{id:"mas-001-02",name:"Ù„ÙŠØ§Ø³Ø© (Ù…ÙˆÙ†Ø©)",sequence:2,duration:1,workers:[{role:"Ù…Ù„ÙŠØ§Ø³",count:3,productivity:12,dailyCost:230},{role:"Ù…Ø³Ø§Ø¹Ø¯",count:3,productivity:12,dailyCost:150}],productivity:12,unit:"Ù…2",dependencies:["mas-001-01"]}],materials:[{name:"Ø·ÙˆØ¨ Ø£Ø­Ù…Ø±",quantityPer:70,unit:"Ø·ÙˆØ¨Ø©",wastePercentage:5},{name:"Ø£Ø³Ù…Ù†Øª",quantityPer:20,unit:"ÙƒØ¬Ù…",wastePercentage:3},{name:"Ø±Ù…Ù„",quantityPer:.03,unit:"Ù…3",wastePercentage:5}],sbcReferences:["SBC 306"],executionMethod:"Ø¨Ù†Ø§Ø¡ Ø¨Ø§Ù„Ø·ÙˆØ¨ Ø§Ù„Ø£Ø­Ù…Ø± Ù…Ø¹ Ù…ÙˆÙ†Ø© Ø£Ø³Ù…Ù†ØªÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"}],de=[{id:"fin-001",nameAr:"Ø¨Ù„Ø§Ø· Ø£Ø±Ø¶ÙŠØ§Øª",nameEn:"Floor Tiles",category:"finishing",keywords:["Ø¨Ù„Ø§Ø·","tiles","Ø£Ø±Ø¶ÙŠØ§Øª","flooring","Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ","Ø±Ø®Ø§Ù…"],subActivities:[{id:"fin-001-01",name:"ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø£Ø±Ø¶ÙŠØ©",sequence:1,duration:.5,workers:[{role:"Ø¹Ø§Ù…Ù„",count:4,productivity:40,dailyCost:150}],productivity:40,unit:"Ù…2",dependencies:[]},{id:"fin-001-02",name:"ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¨Ù„Ø§Ø·",sequence:2,duration:1.5,workers:[{role:"Ø¨Ù„Ø§Ø·",count:3,productivity:15,dailyCost:280},{role:"Ù…Ø³Ø§Ø¹Ø¯",count:3,productivity:15,dailyCost:150}],productivity:15,unit:"Ù…2",dependencies:["fin-001-01"]},{id:"fin-001-03",name:"Ø³Ù‚ÙŠØ© ÙˆØªÙ†Ø¸ÙŠÙ",sequence:3,duration:.5,workers:[{role:"Ø¹Ø§Ù…Ù„",count:2,productivity:50,dailyCost:150}],productivity:50,unit:"Ù…2",dependencies:["fin-001-02"]}],materials:[{name:"Ø¨Ù„Ø§Ø·",quantityPer:1.1,unit:"Ù…2",wastePercentage:10},{name:"Ø£Ø³Ù…Ù†Øª Ø£Ø¨ÙŠØ¶",quantityPer:5,unit:"ÙƒØ¬Ù…",wastePercentage:5},{name:"Ù…Ø§Ø¯Ø© Ù„Ø§ØµÙ‚Ø©",quantityPer:3,unit:"ÙƒØ¬Ù…",wastePercentage:5}],sbcReferences:["SBC 306.5"],executionMethod:"ØªØ±ÙƒÙŠØ¨ Ø¨Ù„Ø§Ø· Ø¨Ù…ÙˆØ§Ø¯ Ù„Ø§ØµÙ‚Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª"}],ue=[...re,...ie,...le,...ce,...de];function pe(e){const n=e.toLowerCase();for(const t of ue)for(const s of t.keywords)if(n.includes(s.toLowerCase()))return t;return null}function ye(e){return k(this,null,function*(){console.log(`ğŸ” Analyzing item: ${e.description}`);const n=pe(e.description);return n?(console.log(`âœ… Found matching activity: ${n.nameAr}`),me(e,n)):(console.log("âš ï¸ No exact match found, using AI analysis..."),he(e))})}function me(e,n){const t={activities:[],totalDuration:0,criticalPath:[]};let s=0;const u=[];for(const l of n.subActivities){const g=xe(e.quantity,l.productivity),r=ge(l.workers,g),a={id:l.id,name:l.name,description:`${l.name} - ${e.description}`,sequence:l.sequence,duration:g,startOffset:s,workers:r,productivity:{rate:l.productivity,unit:l.unit,perDay:l.productivity},dependencies:l.dependencies,isCritical:l.dependencies.length===0};t.activities.push(a),a.isCritical&&u.push(a.id),l.dependencies.length===0&&(s+=g)}t.totalDuration=s,t.criticalPath=u;const p=B(t.activities),d=be(e,n),m={applicableCodes:n.sbcReferences,requirements:[n.executionMethod],compliant:!0,notes:[]};return f(b({},e),{analysis:{detectedActivity:n,breakdown:t,labor:p,materials:d,sbcCompliance:m,confidence:95}})}function he(e){return k(this,null,function*(){var n,t;try{const s="AIzaSyAK_UVp3OsRKnakSBiTOSp9mzkPioy7O3A",p=new V(s).getGenerativeModel({model:"gemini-pro"}),d=`
Ø£Ù†Øª Ø®Ø¨ÙŠØ± ÙÙŠ Ø¥Ø¯Ø§Ø±Ø© Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. Ø­Ù„Ù„ Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ Ù…Ù† Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©:

**Ø§Ù„Ø¨Ù†Ø¯**: ${e.description}
**Ø§Ù„ÙƒÙ…ÙŠØ©**: ${e.quantity} ${e.unit}
**Ø§Ù„ÙØ¦Ø©**: ${e.category||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯"}

Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:
1. ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø¥Ù†Ø´Ø§Ø¦ÙŠ (Ø­ÙØ±ØŒ Ø®Ø±Ø³Ø§Ù†Ø© Ø¹Ø§Ø¯ÙŠØ©ØŒ Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø©ØŒ Ù…Ø¨Ø§Ù†ÙŠØŒ ØªØ´Ø·ÙŠØ¨Ø§ØªØŒ Ø¥Ù„Ø®)
2. ØªÙ‚Ø³ÙŠÙ… Ø§Ù„Ø¨Ù†Ø¯ Ø¥Ù„Ù‰ Ø£Ù†Ø´Ø·Ø© ÙØ±Ø¹ÙŠØ© Ø¨Ø§Ù„ØªØ³Ù„Ø³Ù„ (Ù…Ø«Ø§Ù„: Ø®Ø±Ø³Ø§Ù†Ø© Ù…Ø³Ù„Ø­Ø© â†’ Ù†Ø¬Ø§Ø±Ø©ØŒ Ø­Ø¯Ø§Ø¯Ø©ØŒ ØµØ¨ØŒ Ù…Ø¹Ø§Ù„Ø¬Ø©)
3. ØªÙ‚Ø¯ÙŠØ± Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ø§Ù„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ÙŠÙ† Ù„ÙƒÙ„ Ù†Ø´Ø§Ø· ÙˆØ§Ù„ØªØ®ØµØµ (Ù†Ø¬Ø§Ø±ØŒ Ø­Ø¯Ø§Ø¯ØŒ Ø¹Ø§Ù…Ù„ Ø¹Ø§Ø¯ÙŠØŒ Ø¥Ù„Ø®)
4. ØªÙ‚Ø¯ÙŠØ± Ø¥Ù†ØªØ§Ø¬ÙŠØ© ÙƒÙ„ Ø¹Ø§Ù…Ù„ Ø¨Ø§Ù„ÙŠÙˆÙ…
5. ØªÙ‚Ø¯ÙŠØ± Ù…Ø¯Ø© ÙƒÙ„ Ù†Ø´Ø§Ø· Ø¨Ø§Ù„Ø£ÙŠØ§Ù…
6. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…Ø¹ Ù†Ø³Ø¨Ø© Ø§Ù„Ù‡Ø¯Ø±
7. ØªØ­Ø¯ÙŠØ¯ Ø£ÙƒÙˆØ§Ø¯ SBC Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø§Ù„Ù…Ø·Ø¨Ù‚Ø©
8. Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø­Ø³Ø¨ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ

Ø£Ø¹Ø·Ù†ÙŠ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¨ØµÙŠØºØ© JSON Ù…Ø¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ§Ù„ÙŠØ©:
{
  "activityType": "Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·",
  "activities": [
    {
      "name": "Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ÙØ±Ø¹ÙŠ",
      "sequence": 1,
      "duration": Ø¹Ø¯Ø¯_Ø§Ù„Ø£ÙŠØ§Ù…,
      "workers": [
        {
          "role": "Ø§Ù„ØªØ®ØµØµ",
          "count": Ø§Ù„Ø¹Ø¯Ø¯,
          "productivity": Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©_Ø¨Ø§Ù„ÙŠÙˆÙ…,
          "dailyCost": Ø§Ù„ØªÙƒÙ„ÙØ©_Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
        }
      ]
    }
  ],
  "materials": [
    {
      "name": "Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©",
      "quantityPer": Ø§Ù„ÙƒÙ…ÙŠØ©_Ù„Ù„ÙˆØ­Ø¯Ø©,
      "unit": "Ø§Ù„ÙˆØ­Ø¯Ø©",
      "wastePercentage": Ù†Ø³Ø¨Ø©_Ø§Ù„Ù‡Ø¯Ø±
    }
  ],
  "sbcCodes": ["SBC-301", "SBC-302"],
  "executionMethod": "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø¨Ø§Ø®ØªØµØ§Ø±",
  "confidence": Ù†Ø³Ø¨Ø©_Ø§Ù„Ø«Ù‚Ø©_Ù…Ù†_100
}
`,r=(yield(yield p.generateContent(d)).response).text().match(/\{[\s\S]*\}/);if(!r)return console.warn("âš ï¸ Could not extract JSON from Gemini response, using fallback"),z(e);const a=JSON.parse(r[0]),c={activities:[],totalDuration:0,criticalPath:[]};let h=0;for(const i of a.activities||[]){const y=`${e.id}-activity-${i.sequence}`,C=i.workers.map(x=>({role:x.role,count:x.count,productivity:x.productivity,dailyCost:x.dailyCost||150,totalCost:x.count*(x.dailyCost||150)*i.duration,workingDays:i.duration}));c.activities.push({id:y,name:i.name,description:`${i.name} - ${e.description}`,sequence:i.sequence,duration:i.duration,startOffset:h,workers:C,productivity:{rate:((n=i.workers[0])==null?void 0:n.productivity)||10,unit:e.unit,perDay:((t=i.workers[0])==null?void 0:t.productivity)||10},dependencies:i.sequence>1?[`${e.id}-activity-${i.sequence-1}`]:[],isCritical:i.sequence===1}),c.activities[c.activities.length-1].isCritical&&c.criticalPath.push(y),h+=i.duration}c.totalDuration=h;const w=B(c.activities),v=(a.materials||[]).map(i=>{const y=i.quantityPer*e.quantity,C=y*(i.wastePercentage/100);return{name:i.name,quantity:y,unit:i.unit,wastage:C,totalRequired:y+C}}),A={applicableCodes:a.sbcCodes||[],requirements:[a.executionMethod||"ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ"],compliant:!0,notes:["ØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Gemini AI"]};return f(b({},e),{analysis:{detectedActivity:null,breakdown:c,labor:w,materials:v,sbcCompliance:A,confidence:a.confidence||75}})}catch(s){return console.error("âŒ Gemini AI error:",s),z(e)}})}function z(e){const n={activities:[{id:`${e.id}-activity-1`,name:"ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ù†Ø¯",description:e.description,sequence:1,duration:j(e.quantity,e.unit),startOffset:0,workers:[{role:"Ø¹Ø§Ù…Ù„",count:4,productivity:10,dailyCost:150,totalCost:j(e.quantity,e.unit)*4*150,workingDays:j(e.quantity,e.unit)}],productivity:{rate:10,unit:e.unit,perDay:10},dependencies:[],isCritical:!0}],totalDuration:j(e.quantity,e.unit),criticalPath:[`${e.id}-activity-1`]},t={totalWorkers:4,totalManDays:j(e.quantity,e.unit)*4,totalCost:j(e.quantity,e.unit)*4*150,breakdown:{Ø¹Ø§Ù…Ù„:{count:4,days:j(e.quantity,e.unit),cost:j(e.quantity,e.unit)*4*150}}};return f(b({},e),{analysis:{detectedActivity:null,breakdown:n,labor:t,materials:[],sbcCompliance:{applicableCodes:[],requirements:[],compliant:!0,notes:["ÙŠØ¬Ø¨ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ ÙŠØ¯ÙˆÙŠØ§Ù‹ - ØªØ­Ù„ÙŠÙ„ Ø¨Ø³ÙŠØ·"]},confidence:50}})}function xe(e,n){if(n<=0)return 1;const t=Math.ceil(e/n);return Math.max(1,t)}function ge(e,n){return e.map(t=>({role:t.role,count:t.count,productivity:t.productivity,dailyCost:t.dailyCost,totalCost:t.count*t.dailyCost*n,workingDays:n}))}function B(e){const n={};let t=0,s=0,u=0;for(const p of e)for(const d of p.workers)n[d.role]||(n[d.role]={count:0,days:0,cost:0}),n[d.role].count=Math.max(n[d.role].count,d.count),n[d.role].days+=d.workingDays,n[d.role].cost+=d.totalCost,t+=d.count,s+=d.count*d.workingDays,u+=d.totalCost;return{totalWorkers:t,totalManDays:s,totalCost:u,breakdown:n}}function be(e,n){return n.materials.map(t=>{const s=t.quantityPer*e.quantity,u=s*(t.wastePercentage/100),p=s+u;return{name:t.name,quantity:s,unit:t.unit,wastage:u,totalRequired:p}})}function j(e,n){const s={Ù…3:e/20,Ù…2:e/30,Ù…Ø·:e/15,Ø·Ù†:e/5,Ø¹Ø¯Ø¯:e/10}[n]||e/10;return Math.max(1,Math.ceil(s))}function fe(e){return k(this,null,function*(){console.log(`ğŸ“Š Analyzing ${e.length} items...`);const n=[];for(const t of e)try{const s=yield ye(t);n.push(s)}catch(s){console.error(`âŒ Error analyzing item ${t.id}:`,s),n.push(f(b({},t),{analysis:{detectedActivity:null,breakdown:{activities:[],totalDuration:0,criticalPath:[]},labor:{totalWorkers:0,totalManDays:0,totalCost:0,breakdown:{}},materials:[],sbcCompliance:{applicableCodes:[],requirements:[],compliant:!1,notes:["ÙØ´Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„"]},confidence:0}}))}return console.log(`âœ… Analysis complete: ${n.length} items analyzed`),n})}function we(e){return k(this,null,function*(){try{console.log("ğŸ“„ Parsing PDF file:",e.name);const n=yield e.arrayBuffer(),t=yield U(()=>import("./vendor-large-gsDFeA65.js").then(m=>m.p),__vite__mapDeps([0,1,2]));t.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${t.version}/pdf.worker.min.js`;const u=yield t.getDocument({data:n}).promise;console.log(`ğŸ“„ PDF loaded: ${u.numPages} pages`);let p="";for(let m=1;m<=u.numPages;m++){const r=(yield(yield u.getPage(m)).getTextContent()).items.map(a=>a.str).join(" ");p+=r+`
`}return console.log("âœ… PDF text extracted:",p.length,"characters"),{success:!0,items:ve(p),rawText:p}}catch(n){return console.error("âŒ PDF parsing error:",n),{success:!1,items:[],error:n instanceof Error?n.message:"Unknown error"}}})}function ve(e){const n=[],t=e.split(`
`).map(p=>p.trim()).filter(p=>p.length>0),s=[/^(\d+)\s+(.+?)\s+(\d+\.?\d*)\s+(Ù…[Â²Â³]?|Ø·Ù†|Ø¹Ø¯Ø¯|ÙƒØ¬Ù…|Ù…Ø·)\s+(\d+\.?\d*)\s+(\d+\.?\d*)$/,/(\d+)[.\s]+(.+?)\s+(\d+\.?\d*)\s+(Ù…[Â²Â³]?|Ø·Ù†|Ø¹Ø¯Ø¯|ÙƒØ¬Ù…|Ù…Ø·)/];let u="Ø¹Ø§Ù…";for(let p=0;p<t.length;p++){const d=t[p];if(Ce(d)){u=d;continue}for(const m of s){const l=d.match(m);if(l){const[,g,r,a,c,h,w]=l,v={id:g||`item-${n.length+1}`,itemNumber:g||"",description:r.trim(),quantity:parseFloat(a),unit:c,unitPrice:parseFloat(h||"0"),totalPrice:parseFloat(w||"0")||parseFloat(a)*parseFloat(h||"0"),category:u};v.quantity>0&&v.description.length>0&&n.push(v);break}}}return console.log(`âœ… Extracted ${n.length} items from PDF`),n}function Ce(e){return[/^Ø§Ù„Ø¨Ø§Ø¨\s+/,/^Ø§Ù„ÙØµÙ„\s+/,/^Ø§Ù„Ù‚Ø³Ù…\s+/,/^Ø£Ø¹Ù…Ø§Ù„\s+/,/^Chapter\s+/i,/^Section\s+/i].some(t=>t.test(e))}function Fe(e,n="ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"){return k(this,null,function*(){const t=new H.Workbook;t.creator="NOUFAL AI System",t.lastModifiedBy="NOUFAL AI",t.created=new Date,t.modified=new Date,t.properties.date1904=!0;const s=t.addWorksheet("Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ",{views:[{rightToLeft:!0}],properties:{tabColor:{argb:"FF4A90E2"}}});s.mergeCells("A1:F1");const u=s.getCell("A1");u.value=`ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© - ${n}`,u.font={name:"Arial",size:18,bold:!0,color:{argb:"FFFFFFFF"}},u.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF2563EB"}},u.alignment={vertical:"middle",horizontal:"center"},s.getRow(1).height=40;const p=e.length,d=e.length>0?Math.round(e.reduce((i,y)=>i+y.analysis.confidence,0)/e.length):0,m=e.reduce((i,y)=>i+y.analysis.labor.totalWorkers,0),l=e.reduce((i,y)=>i+y.analysis.breakdown.totalDuration,0),g=e.reduce((i,y)=>i+y.analysis.labor.totalCost,0);s.addRow([]),s.addRow(["Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ©","Ø§Ù„Ù‚ÙŠÙ…Ø©"]),s.addRow(["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯",p]),s.addRow(["Ù…ØªÙˆØ³Ø· Ø¯Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„",`${d}%`]),s.addRow(["Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ø§Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",m]),s.addRow(["Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©",`${l} ÙŠÙˆÙ…`]),s.addRow(["ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ù…Ø§Ù„Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©",`${g.toLocaleString("ar-SA")} Ø±ÙŠØ§Ù„`]);for(let i=3;i<=8;i++){const y=s.getRow(i);y.getCell(1).font={bold:!0,color:{argb:"FF1E40AF"}},y.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E7FF"}},y.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}s.getColumn(1).width=25,s.getColumn(2).width=30;const r=t.addWorksheet("ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ù†ÙˆØ¯",{views:[{rightToLeft:!0}],properties:{tabColor:{argb:"FF10B981"}}}),a=["#","Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯","Ø§Ù„ÙˆØµÙ","Ø§Ù„ÙƒÙ…ÙŠØ©","Ø§Ù„ÙˆØ­Ø¯Ø©","Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù†Ø´Ø·Ø©","Ø§Ù„Ø¹Ù…Ø§Ù„Ø©","Ø§Ù„Ù…Ø¯Ø© (ÙŠÙˆÙ…)","Ø§Ù„ØªÙƒÙ„ÙØ© (Ø±ÙŠØ§Ù„)","Ø§Ù„Ø¯Ù‚Ø© %"],c=r.addRow(a);c.font={bold:!0,color:{argb:"FFFFFFFF"}},c.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF059669"}},c.alignment={vertical:"middle",horizontal:"center"},c.height=25,e.forEach((i,y)=>{const C=r.addRow([y+1,i.itemNumber,i.description,i.quantity,i.unit,i.analysis.breakdown.activities.length,i.analysis.labor.totalWorkers,i.analysis.breakdown.totalDuration,i.analysis.labor.totalCost,i.analysis.confidence]),x=C.getCell(10);i.analysis.confidence>=90?(x.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF10B981"}},x.font={color:{argb:"FFFFFFFF"},bold:!0}):i.analysis.confidence>=70?(x.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF3B82F6"}},x.font={color:{argb:"FFFFFFFF"},bold:!0}):(x.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF59E0B"}},x.font={color:{argb:"FFFFFFFF"},bold:!0}),C.eachCell(P=>{P.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),r.columns=[{width:5},{width:12},{width:40},{width:10},{width:10},{width:12},{width:10},{width:12},{width:15},{width:10}];const h=t.addWorksheet("ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ø´Ø·Ø©",{views:[{rightToLeft:!0}],properties:{tabColor:{argb:"FFF59E0B"}}}),w=["Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯","Ø§Ø³Ù… Ø§Ù„Ù†Ø´Ø§Ø·","Ø§Ù„ØªØ³Ù„Ø³Ù„","Ø§Ù„Ù…Ø¯Ø© (ÙŠÙˆÙ…)","Ø§Ù„Ø¹Ù…Ø§Ù„Ø©","Ø§Ù„ØªØ®ØµØµ","Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©"],v=h.addRow(w);v.font={bold:!0,color:{argb:"FFFFFFFF"}},v.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD97706"}},v.alignment={vertical:"middle",horizontal:"center"},e.forEach(i=>{i.analysis.breakdown.activities.forEach(y=>{y.workers.forEach((C,x)=>{h.addRow([i.itemNumber,x===0?y.name:"",x===0?y.sequence:"",x===0?y.duration:"",C.count,C.role,C.productivity]).eachCell(q=>{q.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})})})}),h.columns=[{width:12},{width:30},{width:10},{width:12},{width:10},{width:20},{width:12}];const A=yield t.xlsx.writeBuffer();return new Blob([A],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})})}function ke(e,n="ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"){return k(this,null,function*(){const t=new G({orientation:"landscape",unit:"mm",format:"a4"});t.setFontSize(20),t.setTextColor(37,99,235),t.text(`ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø© - ${n}`,148,20,{align:"center"});const s=e.length,u=e.length>0?Math.round(e.reduce((a,c)=>a+c.analysis.confidence,0)/e.length):0,p=e.reduce((a,c)=>a+c.analysis.labor.totalWorkers,0),d=e.reduce((a,c)=>a+c.analysis.breakdown.totalDuration,0),m=e.reduce((a,c)=>a+c.analysis.labor.totalCost,0);t.setFontSize(12),t.setTextColor(0,0,0);let l=35;t.text(`Total Items: ${s}`,20,l),l+=8,t.text(`Average Confidence: ${u}%`,20,l),l+=8,t.text(`Total Workers: ${p}`,20,l),l+=8,t.text(`Total Duration: ${d} days`,20,l),l+=8,t.text(`Total Labor Cost: ${m.toLocaleString()} SAR`,20,l);const g=e.map((a,c)=>[String(c+1),a.itemNumber,a.description.substring(0,50),String(a.quantity),a.unit,String(a.analysis.breakdown.activities.length),String(a.analysis.labor.totalWorkers),String(a.analysis.breakdown.totalDuration),String(a.analysis.labor.totalCost.toFixed(0)),`${a.analysis.confidence}%`]);Q(t,{startY:l+10,head:[["#","Item No","Description","Qty","Unit","Activities","Workers","Duration","Cost","Confidence"]],body:g,theme:"grid",headStyles:{fillColor:[5,150,105],textColor:255,fontStyle:"bold",halign:"center"},styles:{font:"helvetica",fontSize:8,cellPadding:2},columnStyles:{0:{cellWidth:8,halign:"center"},1:{cellWidth:15,halign:"center"},2:{cellWidth:60},3:{cellWidth:12,halign:"center"},4:{cellWidth:12,halign:"center"},5:{cellWidth:15,halign:"center"},6:{cellWidth:15,halign:"center"},7:{cellWidth:15,halign:"center"},8:{cellWidth:18,halign:"right"},9:{cellWidth:15,halign:"center"}},didDrawCell:a=>{if(a.column.index===9&&a.section==="body"){const c=e[a.row.index];c.analysis.confidence>=90?t.setFillColor(16,185,129):c.analysis.confidence>=70?t.setFillColor(59,130,246):t.setFillColor(245,158,11),t.rect(a.cell.x,a.cell.y,a.cell.width,a.cell.height,"F"),t.setTextColor(255,255,255),t.text(a.cell.text[0],a.cell.x+a.cell.width/2,a.cell.y+a.cell.height/2,{align:"center",baseline:"middle"})}}});const r=t.getNumberOfPages();for(let a=1;a<=r;a++)t.setPage(a),t.setFontSize(8),t.setTextColor(128,128,128),t.text(`Generated by NOUFAL AI System - Page ${a} of ${r}`,148,205,{align:"center"});return t.output("blob")})}function I(e,n){const t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)}function Ne(e,n="ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"){return k(this,null,function*(){const t=yield Fe(e,n),s=`${n}_${new Date().toISOString().split("T")[0]}.xlsx`;I(t,s)})}function je(e,n="ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©"){return k(this,null,function*(){const t=yield ke(e,n),s=`${n}_${new Date().toISOString().split("T")[0]}.pdf`;I(t,s)})}function $e(){const[e,n]=$.useState({mode:"ai",items:[],analyzedItems:[],isAnalyzing:!1,progress:0,selectedItem:null}),[t,s]=$.useState("excel"),u=$.useCallback(r=>k(null,null,function*(){var c;const a=(c=r.target.files)==null?void 0:c[0];if(a){n(h=>f(b({},h),{isAnalyzing:!0,progress:10}));try{let h=[];if(a.name.endsWith(".pdf")){const w=yield we(a);if(w.success)h=w.items;else{alert(`Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© PDF: ${w.error}`),n(v=>f(b({},v),{isAnalyzing:!1,progress:0}));return}}else h=yield p(a);n(w=>f(b({},w),{items:h,progress:30})),e.mode==="ai"||e.mode==="hybrid"?yield d(h):n(w=>f(b({},w),{isAnalyzing:!1,progress:100,analyzedItems:h.map(v=>f(b({},v),{analysis:{detectedActivity:null,breakdown:{activities:[],totalDuration:0,criticalPath:[]},labor:{totalWorkers:0,totalManDays:0,totalCost:0,breakdown:{}},materials:[],sbcCompliance:{applicableCodes:[],requirements:[],compliant:!0,notes:[]},confidence:0}}))}))}catch(h){console.error("Error uploading file:",h),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù"),n(w=>f(b({},w),{isAnalyzing:!1,progress:0}))}}}),[e.mode]),p=r=>k(null,null,function*(){return new Promise((a,c)=>{const h=new FileReader;h.onload=w=>{var v;try{const A=(v=w.target)==null?void 0:v.result,i=J(A,{type:"binary"}),y=i.Sheets[i.SheetNames[0]],C=K.sheet_to_json(y,{header:1});let x=-1;const P=["Ø±Ù‚Ù…","ÙˆØµÙ","Ø¨Ù†Ø¯","ÙƒÙ…ÙŠØ©","Ø³Ø¹Ø±","no","description","item"];for(let N=0;N<Math.min(10,C.length);N++){const F=C[N];if(F&&F.some(S=>P.some(D=>String(S).toLowerCase().includes(D)))){x=N;break}}x===-1&&(x=0);const q=[];for(let N=x+1;N<C.length;N++){const F=C[N];if(!F||F.length===0)continue;const S=String(F[1]||F[2]||"").trim(),D=parseFloat(String(F[3]||F[4]||"0"));!S||D<=0||q.push({id:String(N),itemNumber:String(F[0]||N),description:S,quantity:D,unit:String(F[4]||F[5]||"Ø¹Ø¯Ø¯"),unitPrice:parseFloat(String(F[5]||F[6]||"0")),totalPrice:parseFloat(String(F[6]||F[7]||"0")),category:"Ø¹Ø§Ù…"})}a(q)}catch(A){c(A)}},h.readAsBinaryString(r)})}),d=r=>k(null,null,function*(){n(a=>f(b({},a),{progress:40}));try{const a=yield fe(r);n(c=>f(b({},c),{analyzedItems:a,isAnalyzing:!1,progress:100}))}catch(a){console.error("Error analyzing items:",a),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„"),n(c=>f(b({},c),{isAnalyzing:!1,progress:0}))}}),m={totalItems:e.analyzedItems.length,avgConfidence:e.analyzedItems.length>0?Math.round(e.analyzedItems.reduce((r,a)=>r+a.analysis.confidence,0)/e.analyzedItems.length):0,totalWorkers:e.analyzedItems.reduce((r,a)=>r+a.analysis.labor.totalWorkers,0),totalDuration:e.analyzedItems.reduce((r,a)=>r+a.analysis.breakdown.totalDuration,0),totalCost:e.analyzedItems.reduce((r,a)=>r+a.analysis.labor.totalCost,0)},l=()=>k(null,null,function*(){if(e.analyzedItems.length===0){alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±");return}try{yield Ne(e.analyzedItems,"ØªØ­Ù„ÙŠÙ„_Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©_NOUFAL")}catch(r){console.error("Error exporting Excel:",r),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Excel")}}),g=()=>k(null,null,function*(){if(e.analyzedItems.length===0){alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©");return}try{yield je(e.analyzedItems,"ØªØ­Ù„ÙŠÙ„_Ø§Ù„Ù…Ù‚Ø§ÙŠØ³Ø©_NOUFAL")}catch(r){console.error("Error exporting PDF:",r),alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± PDF")}});return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-slate-900 p-8",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h1",{className:"text-5xl font-bold text-white mb-4 bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent",children:"Ù…Ø±ÙƒØ² Ù‚ÙŠØ§Ø¯Ø© Ù†ÙˆÙÙ„"}),o.jsx("p",{className:"text-xl text-slate-300",children:"Ù…Ø­Ù„Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø°ÙƒÙŠ | AI-Powered BOQ Analyzer"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[o.jsxs("button",{onClick:()=>n(r=>f(b({},r),{mode:"ai"})),className:`p-6 rounded-2xl border-2 transition-all ${e.mode==="ai"?"bg-gradient-to-br from-cyan-600/20 to-blue-600/20 border-cyan-400 shadow-lg shadow-cyan-500/50":"bg-slate-800/50 border-slate-600 hover:border-slate-500"}`,children:[o.jsx(Y,{className:`w-12 h-12 mx-auto mb-3 ${e.mode==="ai"?"text-cyan-400":"text-slate-400"}`}),o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ"}),o.jsx("p",{className:"text-sm text-slate-300",children:"Ø§Ø³ØªØ®Ø¯Ø§Ù… Gemini AI"})]}),o.jsxs("button",{onClick:()=>n(r=>f(b({},r),{mode:"manual"})),className:`p-6 rounded-2xl border-2 transition-all ${e.mode==="manual"?"bg-gradient-to-br from-purple-600/20 to-pink-600/20 border-purple-400 shadow-lg shadow-purple-500/50":"bg-slate-800/50 border-slate-600 hover:border-slate-500"}`,children:[o.jsx(X,{className:`w-12 h-12 mx-auto mb-3 ${e.mode==="manual"?"text-purple-400":"text-slate-400"}`}),o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙŠØ¯ÙˆÙŠ"}),o.jsx("p",{className:"text-sm text-slate-300",children:"ØªØ­Ù„ÙŠÙ„ Ù…Ø®ØµØµ ÙŠØ¯ÙˆÙŠØ§Ù‹"})]}),o.jsxs("button",{onClick:()=>n(r=>f(b({},r),{mode:"hybrid"})),className:`p-6 rounded-2xl border-2 transition-all ${e.mode==="hybrid"?"bg-gradient-to-br from-amber-600/20 to-orange-600/20 border-amber-400 shadow-lg shadow-amber-500/50":"bg-slate-800/50 border-slate-600 hover:border-slate-500"}`,children:[o.jsx(Z,{className:`w-12 h-12 mx-auto mb-3 ${e.mode==="hybrid"?"text-amber-400":"text-slate-400"}`}),o.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù‡Ø¬ÙŠÙ†"}),o.jsx("p",{className:"text-sm text-slate-300",children:"AI + ØªØ­Ø³ÙŠÙ†Ø§Øª ÙŠØ¯ÙˆÙŠØ©"})]})]}),o.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-2xl border border-slate-700 p-8 mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù"}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>s("excel"),className:`px-4 py-2 rounded-lg transition-all ${t==="excel"?"bg-green-600 text-white":"bg-slate-700 text-slate-300"}`,children:"Excel"}),o.jsx("button",{onClick:()=>s("pdf"),className:`px-4 py-2 rounded-lg transition-all ${t==="pdf"?"bg-red-600 text-white":"bg-slate-700 text-slate-300"}`,children:"PDF"}),o.jsx("button",{onClick:()=>s("manual"),className:`px-4 py-2 rounded-lg transition-all ${t==="manual"?"bg-purple-600 text-white":"bg-slate-700 text-slate-300"}`,children:"ÙŠØ¯ÙˆÙŠ"})]})]}),o.jsxs("div",{className:"border-2 border-dashed border-slate-600 rounded-xl p-12 text-center hover:border-cyan-400 transition-all cursor-pointer",children:[o.jsx("input",{type:"file",accept:t==="pdf"?".pdf":".xlsx,.xls,.csv",onChange:u,className:"hidden",id:"file-upload"}),o.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[o.jsx(ee,{className:"w-16 h-16 mx-auto mb-4 text-cyan-400"}),o.jsx("p",{className:"text-xl text-white mb-2",children:"Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ­Ù…ÙŠÙ„"}),o.jsx("p",{className:"text-sm text-slate-400",children:t==="pdf"?"PDF Files":"Excel, CSV Files"})]})]}),e.isAnalyzing&&o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"text-white",children:"Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„..."}),o.jsxs("span",{className:"text-cyan-400",children:[e.progress,"%"]})]}),o.jsx("div",{className:"w-full bg-slate-700 rounded-full h-3",children:o.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-3 rounded-full transition-all duration-500",style:{width:`${e.progress}%`}})})]})]}),e.analyzedItems.length>0&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-blue-600/20 to-cyan-600/20 border border-blue-400/30 rounded-xl p-6",children:[o.jsx(W,{className:"w-8 h-8 text-blue-400 mb-2"}),o.jsx("p",{className:"text-sm text-slate-300 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†ÙˆØ¯"}),o.jsx("p",{className:"text-3xl font-bold text-white",children:m.totalItems})]}),o.jsxs("div",{className:"bg-gradient-to-br from-green-600/20 to-emerald-600/20 border border-green-400/30 rounded-xl p-6",children:[o.jsx(te,{className:"w-8 h-8 text-green-400 mb-2"}),o.jsx("p",{className:"text-sm text-slate-300 mb-1",children:"Ø¯Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„"}),o.jsxs("p",{className:"text-3xl font-bold text-white",children:[m.avgConfidence,"%"]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-purple-600/20 to-pink-600/20 border border-purple-400/30 rounded-xl p-6",children:[o.jsx(ne,{className:"w-8 h-8 text-purple-400 mb-2"}),o.jsx("p",{className:"text-sm text-slate-300 mb-1",children:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ø§Ù„Ø©"}),o.jsx("p",{className:"text-3xl font-bold text-white",children:m.totalWorkers})]}),o.jsxs("div",{className:"bg-gradient-to-br from-amber-600/20 to-orange-600/20 border border-amber-400/30 rounded-xl p-6",children:[o.jsx(oe,{className:"w-8 h-8 text-amber-400 mb-2"}),o.jsx("p",{className:"text-sm text-slate-300 mb-1",children:"Ø§Ù„Ù…Ø¯Ø© (ÙŠÙˆÙ…)"}),o.jsx("p",{className:"text-3xl font-bold text-white",children:m.totalDuration})]}),o.jsxs("div",{className:"bg-gradient-to-br from-red-600/20 to-rose-600/20 border border-red-400/30 rounded-xl p-6",children:[o.jsx(ae,{className:"w-8 h-8 text-red-400 mb-2"}),o.jsx("p",{className:"text-sm text-slate-300 mb-1",children:"ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ù…Ø§Ù„Ø©"}),o.jsxs("p",{className:"text-3xl font-bold text-white",children:[(m.totalCost/1e3).toFixed(1),"K"]})]})]}),e.analyzedItems.length>0&&o.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-xl rounded-2xl border border-slate-700 p-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-white",children:"Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„"}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.analyzedItems.length===0,children:[o.jsx(se,{className:"w-4 h-4"}),"ØªØµØ¯ÙŠØ± Excel"]}),o.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:e.analyzedItems.length===0,children:[o.jsx(W,{className:"w-4 h-4"}),"Ø·Ø¨Ø§Ø¹Ø© PDF"]})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-600",children:[o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"#"}),o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"Ø§Ù„Ø¨Ù†Ø¯"}),o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"Ø§Ù„ÙƒÙ…ÙŠØ©"}),o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"Ø§Ù„Ø£Ù†Ø´Ø·Ø©"}),o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"Ø§Ù„Ø¹Ù…Ø§Ù„Ø©"}),o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"Ø§Ù„Ù…Ø¯Ø©"}),o.jsx("th",{className:"text-right py-4 px-4 text-slate-300 font-semibold",children:"Ø§Ù„Ø¯Ù‚Ø©"})]})}),o.jsx("tbody",{children:e.analyzedItems.slice(0,20).map((r,a)=>o.jsxs("tr",{className:"border-b border-slate-700 hover:bg-slate-700/30 cursor-pointer transition-all",onClick:()=>n(c=>f(b({},c),{selectedItem:r})),children:[o.jsx("td",{className:"py-4 px-4 text-slate-400",children:r.itemNumber}),o.jsx("td",{className:"py-4 px-4 text-white",children:r.description}),o.jsxs("td",{className:"py-4 px-4 text-slate-300",children:[r.quantity," ",r.unit]}),o.jsx("td",{className:"py-4 px-4 text-cyan-400",children:r.analysis.breakdown.activities.length}),o.jsx("td",{className:"py-4 px-4 text-purple-400",children:r.analysis.labor.totalWorkers}),o.jsxs("td",{className:"py-4 px-4 text-amber-400",children:[r.analysis.breakdown.totalDuration," ÙŠÙˆÙ…"]}),o.jsx("td",{className:"py-4 px-4",children:o.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${r.analysis.confidence>=90?"bg-green-600/20 text-green-400":r.analysis.confidence>=70?"bg-blue-600/20 text-blue-400":"bg-amber-600/20 text-amber-400"}`,children:[r.analysis.confidence,"%"]})})]},r.id))})]})})]})]})})}export{$e as default};
