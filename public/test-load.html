<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Loading - NOUFAL</title>
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            direction: rtl;
        }
        .test-box {
            background: white;
            color: #333;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .success { border-left: 5px solid #4caf50; }
        .error { border-left: 5px solid #f44336; }
        .loading { border-left: 5px solid #ff9800; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            overflow: auto;
            direction: ltr;
            text-align: left;
        }
        button {
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #5568d3;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ù†Ø¸Ø§Ù… NOUFAL</h1>
    <p>Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªØ®ØªØ¨Ø± Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ© Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ¹Ø·Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>

    <div id="results"></div>

    <button onclick="runTests()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
    <button onclick="location.href='/'">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button onclick="location.reload()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„</button>

    <script>
        const results = document.getElementById('results');

        function addResult(title, status, details) {
            const div = document.createElement('div');
            div.className = `test-box ${status}`;
            div.innerHTML = `
                <h3>${status === 'success' ? 'âœ…' : status === 'error' ? 'âŒ' : 'â³'} ${title}</h3>
                ${details ? `<pre>${details}</pre>` : ''}
            `;
            results.appendChild(div);
        }

        async function runTests() {
            results.innerHTML = '';
            
            // Test 1: Check if root element exists
            addResult('Ø§Ø®ØªØ¨Ø§Ø± 1: Ø¹Ù†ØµØ± root', 
                document.getElementById('root') ? 'success' : 'error',
                document.getElementById('root') ? 'Ø¹Ù†ØµØ± root Ù…ÙˆØ¬ÙˆØ¯' : 'Ø¹Ù†ØµØ± root Ù…ÙÙ‚ÙˆØ¯!');

            // Test 2: Try to load React
            try {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 2: ØªØ­Ù…ÙŠÙ„ React', 'loading', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
                const React = await import('https://esm.sh/react@19.2.0');
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 2: ØªØ­Ù…ÙŠÙ„ React', 'success', 'React loaded: ' + typeof React.default);
            } catch (error) {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 2: ØªØ­Ù…ÙŠÙ„ React', 'error', error.toString());
            }

            // Test 3: Try to load lucide-react
            try {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 3: ØªØ­Ù…ÙŠÙ„ lucide-react', 'loading', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
                const lucide = await import('https://esm.sh/lucide-react@0.546.0');
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 3: ØªØ­Ù…ÙŠÙ„ lucide-react', 'success', 
                    `lucide-react loaded\nActivity: ${typeof lucide.Activity}\nKeys: ${Object.keys(lucide).slice(0, 10).join(', ')}`);
            } catch (error) {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 3: ØªØ­Ù…ÙŠÙ„ lucide-react', 'error', error.toString());
            }

            // Test 4: Check console errors
            addResult('Ø§Ø®ØªØ¨Ø§Ø± 4: Ø£Ø®Ø·Ø§Ø¡ Console', 'success', 
                'Ø§ÙØªØ­ Console (F12) ÙˆØ§Ø¨Ø­Ø« Ø¹Ù† Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø±');

            // Test 5: Try to load main bundle
            try {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 5: ØªØ­Ù…ÙŠÙ„ Bundle Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'loading', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...');
                const indexHtml = await fetch('/').then(r => r.text());
                const match = indexHtml.match(/src="([^"]*index-[^"]*\.js)"/);
                if (match) {
                    const bundleUrl = match[1];
                    addResult('Ø§Ø®ØªØ¨Ø§Ø± 5: Bundle Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'success', 
                        `Bundle found: ${bundleUrl}\nØ­Ø¬Ù…: ${(await fetch(bundleUrl).then(r => r.text())).length} bytes`);
                    
                    // Test 6: Try to execute the bundle
                    const script = document.createElement('script');
                    script.type = 'module';
                    script.src = bundleUrl;
                    script.onload = () => {
                        addResult('Ø§Ø®ØªØ¨Ø§Ø± 6: ØªÙ†ÙÙŠØ° Bundle', 'success', 'Bundle executed successfully!');
                    };
                    script.onerror = (error) => {
                        addResult('Ø§Ø®ØªØ¨Ø§Ø± 6: ØªÙ†ÙÙŠØ° Bundle', 'error', error.toString());
                    };
                    document.head.appendChild(script);
                } else {
                    addResult('Ø§Ø®ØªØ¨Ø§Ø± 5: Bundle Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'error', 'Bundle not found in HTML!');
                }
            } catch (error) {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 5: Bundle Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ', 'error', error.toString());
            }

            // Test 7: Check localStorage
            try {
                localStorage.setItem('test', '1');
                localStorage.removeItem('test');
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 7: localStorage', 'success', 'localStorage ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
            } catch (error) {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 7: localStorage', 'error', error.toString());
            }

            // Test 8: Network check
            try {
                const response = await fetch('/');
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 8: Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…', 'success', 
                    `Status: ${response.status}\nHeaders: ${response.headers.get('content-type')}`);
            } catch (error) {
                addResult('Ø§Ø®ØªØ¨Ø§Ø± 8: Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…', 'error', error.toString());
            }
        }

        // Auto-run on load
        window.addEventListener('load', () => {
            setTimeout(runTests, 1000);
        });

        // Catch all errors
        window.addEventListener('error', (event) => {
            addResult('Ø®Ø·Ø£ Ø¹Ø§Ù…', 'error', 
                `Message: ${event.message}\nFile: ${event.filename}\nLine: ${event.lineno}\nColumn: ${event.colno}`);
        });
    </script>
</body>
</html>
