# ๐ ุฏููู ุงูุฃุฏุงุก ูุงููุฑุงูุจุฉ - NOUFAL ERP Performance & Monitoring Guide

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ 4 ููุฒุงุช ุฃุณุงุณูุฉ ูุชุญุณูู ุฃุฏุงุก ุงููุธุงู ููุฑุงูุจุชู:

1. **ูุฑุงูุจุฉ ุงุณุชุฎุฏุงู ุงููุนุงูุฌ ูุงูุฐุงูุฑุฉ (CPU/RAM Monitoring)**
2. **ูุธุงู ุงูุชุฎุฒูู ุงููุคูุช (Caching with Redis)**
3. **ูุธุงู ุชุณุฌูู ุงูุฃุฎุทุงุก ุงููุชูุฏู (Advanced Logging)**
4. **ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช (Automated Database Backup)**

---

## 1๏ธโฃ ูุฑุงูุจุฉ ุงุณุชุฎุฏุงู ุงููุนุงูุฌ ูุงูุฐุงูุฑุฉ

### ๐ ุงููุตู

ูุธุงู ูุฑุงูุจุฉ ุดุงูู ูุชุชุจุน:
- ุงุณุชุฎุฏุงู ุงููุนุงูุฌ (CPU) ุจุดูู ูุญุธู
- ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ (RAM) ูุงูุฐุงูุฑุฉ ุงูุงูุชุฑุงุถูุฉ (Swap)
- ุงุณุชุฎุฏุงู ุงููุฑุต ุงูุตูุจ (Disk)
- ุงุณุชุฎุฏุงู ุงูุดุจูุฉ (Network I/O)
- ุฃูู ุงูุนูููุงุช ุงููุดุทุฉ (Top Processes)

### โ๏ธ ุงูููู: `backend/monitoring.py`

### ๐ ุงูููุฒุงุช

#### ุฃ. ุงููุฑุงูุจุฉ ุงููุญุธูุฉ
```python
from backend.monitoring import SystemMonitor

# ุฅูุดุงุก ูุฑุงูุจ ุงููุธุงู
monitor = SystemMonitor(warning_threshold={
    'cpu': 80.0,    # ุชุญุฐูุฑ ุนูุฏ 80% ุงุณุชุฎุฏุงู ุงููุนุงูุฌ
    'ram': 85.0,    # ุชุญุฐูุฑ ุนูุฏ 85% ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ
    'disk': 90.0    # ุชุญุฐูุฑ ุนูุฏ 90% ุงูุชูุงุก ุงููุฑุต
})

# ุงูุญุตูู ุนูู ุงูููุงููุณ ุงูุญุงููุฉ
metrics = monitor.get_current_metrics()
print(f"ุงุณุชุฎุฏุงู ุงููุนุงูุฌ: {metrics.cpu_percent}%")
print(f"ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ: {metrics.ram_percent}%")
print(f"ุงุณุชุฎุฏุงู ุงููุฑุต: {metrics.disk_percent}%")
```

#### ุจ. ูุฑุงูุจุฉ ุงูุนูููุงุช
```python
# ุงูุญุตูู ุนูู ุฃุนูู 10 ุนูููุงุช ุญุณุจ ุงุณุชุฎุฏุงู ุงููุนุงูุฌ
top_processes = monitor.get_process_metrics(top_n=10)

for proc in top_processes:
    print(f"{proc.name} - CPU: {proc.cpu_percent}% - RAM: {proc.memory_mb} MB")
```

#### ุฌ. ูุญุต ุตุญุฉ ุงููุธุงู
```python
# ุงูุญุตูู ุนูู ุญุงูุฉ ุตุญุฉ ุงููุธุงู ุงูุดุงููุฉ
health = monitor.get_health_status()

print(f"ุงูุญุงูุฉ: {health['status']}")  # healthy, warning, critical
if health['warnings']:
    print("ุงูุชุญุฐูุฑุงุช:")
    for warning in health['warnings']:
        print(f"  - {warning}")
```

#### ุฏ. ููุฎุต ุงูููุงููุณ
```python
# ุงูุญุตูู ุนูู ููุฎุต ุขุฎุฑ 60 ูุฑุงุกุฉ
summary = monitor.get_metrics_summary(last_n=60)

print(f"ุงููุนุงูุฌ - ูุชูุณุท: {summary['cpu']['avg']}%")
print(f"ุงูุฐุงูุฑุฉ - ูุชูุณุท: {summary['ram']['avg']}%")
print(f"ุงููุฑุต - ูุชูุณุท: {summary['disk']['avg']}%")
```

#### ูู. ุงููุฑุงูุจุฉ ุงููุณุชูุฑุฉ ูู ุงูุฎูููุฉ
```python
# ุจุฏุก ุงููุฑุงูุจุฉ ุงููุณุชูุฑุฉ ูู 60 ุซุงููุฉ
monitor.start_monitoring(interval=60)

# ุฅููุงู ุงููุฑุงูุจุฉ
monitor.stop_monitoring()
```

### ๐ ููุงุท ุงูููุงูุฉ (API Endpoints)

ุจุนุฏ ุงูุชูุงูู ูุน Flask:

#### 1. ุตุญุฉ ุงููุธุงู
```bash
GET /api/monitoring/health
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "status": "healthy",
  "timestamp": "2025-11-06T15:30:00",
  "metrics": {
    "cpu_percent": 45.2,
    "ram_percent": 62.8,
    "disk_percent": 71.5
  },
  "warnings": []
}
```

#### 2. ุงูููุงููุณ ุงูุญุงููุฉ
```bash
GET /api/monitoring/metrics
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "timestamp": "2025-11-06T15:30:00",
  "cpu_percent": 45.2,
  "cpu_count": 4,
  "ram_total_gb": 16.0,
  "ram_used_gb": 10.0,
  "ram_available_gb": 6.0,
  "ram_percent": 62.8,
  "disk_total_gb": 500.0,
  "disk_used_gb": 357.5,
  "disk_free_gb": 142.5,
  "disk_percent": 71.5
}
```

#### 3. ููุฎุต ุงูููุงููุณ
```bash
GET /api/monitoring/summary?last=60
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "period": "Last 60 readings",
  "cpu": {
    "avg": 42.5,
    "min": 15.2,
    "max": 78.9,
    "current": 45.2
  },
  "ram": {
    "avg": 60.3,
    "min": 55.1,
    "max": 70.2,
    "current": 62.8
  }
}
```

#### 4. ุฃูู ุงูุนูููุงุช
```bash
GET /api/monitoring/processes?top=10
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "processes": [
    {
      "pid": 1234,
      "name": "python",
      "cpu_percent": 15.5,
      "memory_mb": 450.2,
      "memory_percent": 2.8,
      "status": "running"
    }
  ]
}
```

### ๐ ุงูุชูุงูู ูุน Flask

ูู ููู `backend/app.py`:

```python
from flask import Flask
from backend.monitoring import init_monitoring

app = Flask(__name__)

# ุชูุนูู ุงููุฑุงูุจุฉ
monitor = init_monitoring(app)

# ุงููุฑุงูุจุฉ ูุชุงุญุฉ ุงูุขู ุนุจุฑ:
# - /api/monitoring/health
# - /api/monitoring/metrics
# - /api/monitoring/summary
# - /api/monitoring/processes
```

### โ๏ธ ุงูุนุชุจุงุช ุงูุชุญุฐูุฑูุฉ

ูููู ุชุฎุตูุต ุงูุนุชุจุงุช ุงูุชุญุฐูุฑูุฉ ูู `backend/config.py`:

```python
# ูู ููู ุงูุฅุนุฏุงุฏุงุช
MONITORING_THRESHOLDS = {
    'cpu': 80.0,    # ุชุญุฐูุฑ ุนูุฏ 80% ุงุณุชุฎุฏุงู
    'ram': 85.0,    # ุชุญุฐูุฑ ุนูุฏ 85% ุงุณุชุฎุฏุงู
    'disk': 90.0,   # ุชุญุฐูุฑ ุนูุฏ 90% ุงูุชูุงุก
}

ENABLE_MONITORING = True  # ุชูุนูู ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
MONITORING_INTERVAL = 60  # ูุญุต ูู 60 ุซุงููุฉ
```

---

## 2๏ธโฃ ูุธุงู ุงูุชุฎุฒูู ุงููุคูุช (Caching System)

### ๐ ุงููุตู

ูุธุงู ุชุฎุฒูู ูุคูุช ูุฑู ูุฏุนู:
- **Redis** ููุจูุฆุงุช ุงูููุฒุนุฉ (Production)
- **In-Memory Cache** ูุจุฏูู ุชููุงุฆู (Development)
- TTL (Time To Live) - ุงูุชูุงุก ุตูุงุญูุฉ ุชููุงุฆู
- Decorator ููุชุฎุฒูู ุงููุคูุช ููุฏูุงู
- ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก (Hit Rate)

### โ๏ธ ุงูููู: `backend/caching.py`

### ๐ ุงูููุฒุงุช

#### ุฃ. ุงูุงุณุชุฎุฏุงู ุงูุฃุณุงุณู

```python
from backend.caching import CacheManager

# ุฅูุดุงุก ูุฏูุฑ ุงูุชุฎุฒูู ุงููุคูุช
# ุณูุณุชุฎุฏู Redis ุฅุฐุง ูุงู ูุชุงุญุงูุ ูุฅูุง ุณูุณุชุฎุฏู ุงูุฐุงูุฑุฉ
cache = CacheManager(use_redis=True, redis_config={
    'host': 'localhost',
    'port': 6379,
    'db': 0,
    'password': None
})

# ุชุฎุฒูู ูููุฉ (ุตุงูุญุฉ ููุฏุฉ 5 ุฏูุงุฆู)
cache.set("user:123", {"name": "Ahmed", "role": "Admin"}, ttl=300)

# ุงุณุชุฑุฌุงุน ูููุฉ
user = cache.get("user:123")

# ุญุฐู ูููุฉ
cache.delete("user:123")

# ูุณุญ ุฌููุน ุงูููู ุงููุฎุฒูุฉ
cache.clear()

# ุงูุชุญูู ูู ูุฌูุฏ ููุชุงุญ
if cache.exists("user:123"):
    print("ุงูููุชุงุญ ููุฌูุฏ")
```

#### ุจ. ุงุณุชุฎุฏุงู ุงูุฏูููุฑูุชุฑ (Decorator)

```python
from backend.caching import cached

@cached(ttl=600, key_prefix="user")
def get_user(user_id):
    """
    ุงูุฏุงูุฉ ุณุชูุฎุฒูู ูุชูุฌุชูุง ูุคูุชุงู ููุฏุฉ 10 ุฏูุงุฆู
    ุงูุงุณุชุฏุนุงุก ุงูุฃูู: ุณูุชู ุชูููุฐ ุงูุฏุงูุฉ ูุชุฎุฒูู ุงููุชูุฌุฉ
    ุงูุงุณุชุฏุนุงุกุงุช ุงูุชุงููุฉ: ุณุชูุฑุฌุน ุงููุชูุฌุฉ ูู ุงูุชุฎุฒูู ุงููุคูุช
    """
    # ุงุณุชุนูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุจุทูุก)
    return db.query(User).get(user_id)

# ุงูุงุณุชุฎุฏุงู
user = get_user(123)  # Cache MISS - ุชูููุฐ ุงูุฏุงูุฉ
user = get_user(123)  # Cache HIT - ูู ุงูุชุฎุฒูู ุงููุคูุช (ุฃุณุฑุน!)

# ูุณุญ ุงูุชุฎุฒูู ุงููุคูุช ููุฏุงูุฉ
get_user.clear_cache()
```

#### ุฌ. ุฃูุซูุฉ ุนูููุฉ

**1. ุชุฎุฒูู ูุคูุช ููุชุงุฆุฌ BOQ:**
```python
@cached(ttl=1800, key_prefix="boq")
def calculate_boq_summary(project_id):
    """ุญุณุงุจ ููุฎุต BOQ - ูุณุชุบุฑู ููุชุงู ุทูููุงู"""
    # ุญุณุงุจุงุช ูุนูุฏุฉ...
    return {
        "total_cost": 1500000,
        "items_count": 250,
        "progress": 65.5
    }

# ุงูุงุณุชุฏุนุงุก ุงูุฃูู: ุจุทูุก (10 ุซูุงูู)
summary = calculate_boq_summary(project_id=42)

# ุงูุงุณุชุฏุนุงุก ุงูุซุงูู: ุณุฑูุน ุฌุฏุงู (< 1 ููู ุซุงููุฉ)
summary = calculate_boq_summary(project_id=42)
```

**2. ุชุฎุฒูู ูุคูุช ููุฎุทุท ุฌุงูุช:**
```python
@cached(ttl=600, key_prefix="gantt")
def generate_gantt_chart(project_id):
    """ุฅูุดุงุก ูุฎุทุท ุฌุงูุช - ุนูููุฉ ูุซููุฉ"""
    # ูุนุงูุฌุฉ ุงูุจูุงูุงุช...
    return gantt_data

# ุณูุชู ุชุฎุฒูู ุงููุชูุฌุฉ ููุฏุฉ 10 ุฏูุงุฆู
chart = generate_gantt_chart(project_id=42)
```

**3. ุชุฎุฒูู ูุคูุช ูุจูุงูุงุช ุงููุณุชุฎุฏู:**
```python
@cached(ttl=300, key_prefix="user_profile")
def get_user_profile(user_id):
    """ุงูุญุตูู ุนูู ููู ุงููุณุชุฎุฏู ุงููุงูู"""
    user = User.query.get(user_id)
    return {
        "id": user.id,
        "name": user.name,
        "email": user.email,
        "permissions": user.get_permissions()
    }
```

#### ุฏ. ุฅุญุตุงุฆูุงุช ุงูุฃุฏุงุก

```python
# ุงูุญุตูู ุนูู ุฅุญุตุงุฆูุงุช ุงูุชุฎุฒูู ุงููุคูุช
stats = cache.get_stats()

print(f"ููุน ุงูุชุฎุฒูู: {stats['cache_type']}")  # redis ุฃู in_memory
print(f"ุฅุฌูุงูู ุงูููุงุชูุญ: {stats['total_keys']}")
print(f"ุนุฏุฏ ุงููุตูู ุงููุงุฌุญ: {stats['hits']}")
print(f"ุนุฏุฏ ุงูุฅุฎูุงู: {stats['misses']}")
print(f"ูุนุฏู ุงููุฌุงุญ: {stats['hit_rate']}%")
```

### ๐ ููุงุท ุงูููุงูุฉ (API Endpoints)

#### 1. ุฅุญุตุงุฆูุงุช ุงูุชุฎุฒูู ุงููุคูุช
```bash
GET /api/cache/stats
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "cache_type": "redis",
  "total_keys": 1247,
  "hits": 8542,
  "misses": 1234,
  "total_requests": 9776,
  "hit_rate": 87.38
}
```

#### 2. ูุณุญ ุงูุชุฎุฒูู ุงููุคูุช
```bash
POST /api/cache/clear
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "message": "Cache cleared successfully"
}
```

### ๐ ุงูุชูุงูู ูุน Flask

ูู ููู `backend/app.py`:

```python
from flask import Flask
from backend.caching import init_cache

app = Flask(__name__)

# ุฅุนุฏุงุฏุงุช Redis (ูู config.py)
app.config['USE_REDIS_CACHE'] = True
app.config['REDIS_HOST'] = 'localhost'
app.config['REDIS_PORT'] = 6379
app.config['REDIS_DB'] = 0
app.config['REDIS_PASSWORD'] = None  # ุฃู ูููุฉ ุงููุฑูุฑ

# ุชูุนูู ุงูุชุฎุฒูู ุงููุคูุช
cache_manager = init_cache(app)

# ุงูุชุฎุฒูู ุงููุคูุช ูุชุงุญ ุงูุขู ุนุจุฑ:
# - /api/cache/stats
# - /api/cache/clear
```

### ๐ง ุฅุนุฏุงุฏ Redis

#### ุชุซุจูุช Redis ุนูู Ubuntu/Debian:
```bash
# ุชุซุจูุช Redis
sudo apt update
sudo apt install redis-server -y

# ุชุดุบูู Redis
sudo systemctl start redis-server
sudo systemctl enable redis-server

# ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
redis-cli ping
# ูุฌุจ ุฃู ุชุฑู: PONG
```

#### ุชุซุจูุช Redis ุนูู macOS:
```bash
brew install redis
brew services start redis
```

#### ุชุซุจูุช Redis ุนูู Windows:
```bash
# ุงุณุชุฎุฏุงู WSL ุฃู Docker
docker run -d -p 6379:6379 redis:latest
```

### ๐ ููุงุฆุฏ ุงูุชุฎุฒูู ุงููุคูุช

| ุงูููุฒุฉ | ูุจู ุงูุชุฎุฒูู ุงููุคูุช | ุจุนุฏ ุงูุชุฎุฒูู ุงููุคูุช | ุงูุชุญุณูู |
|--------|-------------------|-------------------|---------|
| ุญุณุงุจ BOQ | 10 ุซูุงูู | < 1 ูููู ุซุงููุฉ | **10,000x ุฃุณุฑุน** |
| ูุฎุทุท ุฌุงูุช | 5 ุซูุงูู | < 1 ูููู ุซุงููุฉ | **5,000x ุฃุณุฑุน** |
| ุจูุงูุงุช ุงููุณุชุฎุฏู | 500 ูููู ุซุงููุฉ | < 1 ูููู ุซุงููุฉ | **500x ุฃุณุฑุน** |
| ุงุณุชุนูุงูุงุช SQL | 200 ูููู ุซุงููุฉ | 0 ูููู ุซุงููุฉ | **โ ุฃุณุฑุน** |

### โ๏ธ ุฃูุถู ุงูููุงุฑุณุงุช

1. **ุงุณุชุฎุฏู TTL ููุงุณุจ:**
   - ุจูุงูุงุช ูุงุฏุฑุงู ูุง ุชุชุบูุฑ: 1800-3600 ุซุงููุฉ (30-60 ุฏูููุฉ)
   - ุจูุงูุงุช ูุชูุณุทุฉ ุงูุชุบููุฑ: 300-600 ุซุงููุฉ (5-10 ุฏูุงุฆู)
   - ุจูุงูุงุช ูุซูุฑุฉ ุงูุชุบููุฑ: 60-120 ุซุงููุฉ (1-2 ุฏูููุฉ)

2. **ุงูุณุญ ุงูุชุฎุฒูู ุงููุคูุช ุนูุฏ ุงูุชุญุฏูุซ:**
```python
@app.route('/api/boq/update', methods=['PUT'])
def update_boq():
    # ุชุญุฏูุซ ุงูุจูุงูุงุช
    update_database()
    
    # ูุณุญ ุงูุชุฎุฒูู ุงููุคูุช ุงููุชุนูู
    cache.delete(f"boq:{project_id}")
    
    return {"success": True}
```

3. **ุฑุงูุจ ูุนุฏู ุงููุฌุงุญ (Hit Rate):**
   - ูุนุฏู ูุฌุงุญ ุฌูุฏ: > 80%
   - ูุนุฏู ูุฌุงุญ ููุชุงุฒ: > 90%
   - ุฅุฐุง ูุงู < 70%: ุฑุงุฌุน ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุฎุฒูู ุงููุคูุช

---

## 3๏ธโฃ ูุธุงู ุชุณุฌูู ุงูุฃุฎุทุงุก ุงููุชูุฏู

### ๐ ุงููุตู

ูุธุงู ุชุณุฌูู ุดุงูู ูููุฑ:
- **5 ูููุงุช ุณุฌู ูููุตูุฉ** ูุชูุธูู ุฃูุถู
- **ุฏูุฑุงู ุชููุงุฆู ููุณุฌูุงุช** (Log Rotation)
- **ุชูุณูู JSON** ูุณูููุฉ ุงูุชุญููู
- **ูุณุชููุงุช ูุชุนุฏุฏุฉ** (DEBUG, INFO, WARNING, ERROR, CRITICAL)
- **ุชุณุฌูู ุงูุทูุจุงุช HTTP** ุจุดูู ูููุตู
- **ุณุฌู ุงูุชุฏููู** (Audit Trail)

### โ๏ธ ุงูููู: `backend/logging_config.py`

### ๐ ุงูููุฒุงุช

#### ุฃ. ุฅุนุฏุงุฏ ุงูุชุณุฌูู

```python
from backend.logging_config import setup_logging

# ุฅุนุฏุงุฏ ูุธุงู ุงูุชุณุฌูู
setup_logging(
    app_name="noufal_erp",
    log_dir="logs",           # ูุฌูุฏ ุงูุณุฌูุงุช
    log_level="INFO",         # ุงููุณุชูู ุงูุงูุชุฑุงุถู
    enable_console=True,      # ุนุฑุถ ูู ุงููููุณูู
    enable_file=True,         # ุญูุธ ูู ูููุงุช
    enable_json=True,         # ุชูุณูู JSON
    max_bytes=10*1024*1024,   # ุญุฌู ุฃูุตู ููู ููู (10 MB)
    backup_count=10           # ุนุฏุฏ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
)
```

#### ุจ. ุงุณุชุฎุฏุงู Logger

```python
import logging

logger = logging.getLogger(__name__)

# ูุณุชููุงุช ูุฎุชููุฉ ูู ุงูุชุณุฌูู
logger.debug("ุฑุณุงูุฉ ุชุตุญูุญ - ูุนูููุงุช ุชูุตูููุฉ ูููุทูุฑูู")
logger.info("ุฑุณุงูุฉ ูุนูููุงุช - ุนูููุงุช ุนุงุฏูุฉ")
logger.warning("ุชุญุฐูุฑ - ุดูุก ุบูุฑ ูุชููุน ูููู ุงููุธุงู ูุนูู")
logger.error("ุฎุทุฃ - ูุดู ูู ุชูููุฐ ุนูููุฉ")
logger.critical("ุฎุทูุฑ - ุงููุธุงู ูุฏ ูุง ูุนูู ุจุดูู ุตุญูุญ")

# ุชุณุฌูู ูุน ุงุณุชุซูุงุก
try:
    result = 1 / 0
except Exception as e:
    logger.error("ุญุฏุซ ุฎุทุฃ ูู ุงูุญุณุงุจ", exc_info=True)
```

#### ุฌ. ุชุณุฌูู ุทูุจุงุช HTTP

```python
from backend.logging_config import log_request

log_request(
    method="GET",
    path="/api/projects/123",
    status_code=200,
    response_time_ms=45.67,
    user_id=123,
    ip_address="192.168.1.100",
    user_agent="Mozilla/5.0"
)
```

#### ุฏ. ุชุณุฌูู ุฃุญุฏุงุซ ุงูุชุฏููู

```python
from backend.logging_config import log_audit

log_audit(
    event_type="USER_LOGIN",
    user_id=123,
    action="LOGIN",
    resource="authentication",
    details={"method": "password", "success": True},
    ip_address="192.168.1.100"
)

log_audit(
    event_type="BOQ_UPDATE",
    user_id=456,
    action="UPDATE",
    resource="boq/789",
    details={"field": "quantity", "old_value": 100, "new_value": 150},
    ip_address="192.168.1.101"
)
```

### ๐ ูููุงุช ุงูุณุฌูุงุช

ุจุนุฏ ุงูุฅุนุฏุงุฏุ ุณูุชู ุฅูุดุงุก 5 ูููุงุช ูู ูุฌูุฏ `logs/`:

#### 1. `noufal_erp.log`
**ุงูุณุฌู ุงูุนุงู** - ุฌููุน ุงููุณุชููุงุช (INFO ูุฃุนูู)

```json
{
  "timestamp": "2025-11-06T15:30:45",
  "level": "INFO",
  "logger": "backend.app",
  "message": "ุชู ุจุฏุก ุงูุชุทุจูู ุจูุฌุงุญ",
  "module": "app",
  "function": "main",
  "line": 45
}
```

#### 2. `noufal_erp_errors.log`
**ุณุฌู ุงูุฃุฎุทุงุก ููุท** - ERROR ู CRITICAL

```json
{
  "timestamp": "2025-11-06T15:31:22",
  "level": "ERROR",
  "logger": "backend.database",
  "message": "ูุดู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช",
  "module": "database",
  "function": "connect",
  "line": 89,
  "exception": {
    "type": "ConnectionError",
    "message": "Could not connect to database",
    "traceback": ["..."]
  }
}
```

#### 3. `noufal_erp_debug.log`
**ุณุฌู ุงูุชุตุญูุญ** - ุฌููุน ุงููุณุชููุงุช ุจูุง ูููุง DEBUG
- ูููุดุฃ ููุท ุนูุฏ ุชุนููู `log_level="DEBUG"`
- ูุญุชูู ุนูู ูุนูููุงุช ุชูุตูููุฉ ุฌุฏุงู ูููุทูุฑูู

#### 4. `noufal_erp_requests.log`
**ุณุฌู ุทูุจุงุช HTTP**

```json
{
  "timestamp": "2025-11-06T15:32:10",
  "method": "POST",
  "path": "/api/boq/create",
  "status_code": 201,
  "response_time_ms": 123.45,
  "user_id": 123,
  "ip_address": "192.168.1.100",
  "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
}
```

#### 5. `noufal_erp_audit.log`
**ุณุฌู ุงูุชุฏููู** - ุชุชุจุน ุฃุญุฏุงุซ ุงูุฃูุงู ูุงูุชุบููุฑุงุช

```json
{
  "timestamp": "2025-11-06T15:33:00",
  "event_type": "USER_LOGIN",
  "user_id": 123,
  "action": "LOGIN",
  "resource": "authentication",
  "details": {
    "method": "password",
    "success": true,
    "2fa_enabled": false
  },
  "ip_address": "192.168.1.100"
}
```

### ๐ ุฏูุฑุงู ุงูุณุฌูุงุช (Log Rotation)

ูุชู ุฏูุฑุงู ุงูุณุฌูุงุช ุชููุงุฆูุงู ุนูุฏ:
- ูุตูู ุญุฌู ุงูููู ุฅูู 10 MB (ูุงุจู ููุชุฎุตูุต)
- ูุชู ุงูุงุญุชูุงุธ ุจู 10 ูุณุฎ ุงุญุชูุงุทูุฉ (ูุงุจู ููุชุฎุตูุต)

**ูุซุงู:**
```
logs/
โโโ noufal_erp.log          # ุงูููู ุงูุญุงูู
โโโ noufal_erp.log.1        # ุฃุญุฏุซ ูุณุฎุฉ ุงุญุชูุงุทูุฉ
โโโ noufal_erp.log.2
โโโ ...
โโโ noufal_erp.log.10       # ุฃูุฏู ูุณุฎุฉ ุงุญุชูุงุทูุฉ
```

### ๐ ุงูุชูุงูู ูุน Flask

ูู ููู `backend/app.py`:

```python
from flask import Flask
from backend.logging_config import init_logging

app = Flask(__name__)

# ุฅุนุฏุงุฏุงุช ุงูุชุณุฌูู (ูู config.py)
app.config['LOG_DIR'] = 'logs'
app.config['LOG_LEVEL'] = 'INFO'  # ุฃู 'DEBUG' ููุชุทููุฑ
app.config['LOG_JSON_FORMAT'] = True

# ุชูุนูู ุงูุชุณุฌูู
init_logging(app)

# ุงูุขู ุฌููุน ุงูุทูุจุงุช ูุงูุฃุฎุทุงุก ุณุชูุณุฌูู ุชููุงุฆูุงู
```

### ๐ ุชุญููู ุงูุณุฌูุงุช

#### ุงุณุชุฎุฏุงู jq ูุชุญููู JSON:
```bash
# ุนุฑุถ ุขุฎุฑ 10 ุฃุฎุทุงุก
cat logs/noufal_erp_errors.log | jq -s '.[-10:]'

# ุงูุจุญุซ ุนู ุฃุฎุทุงุก ูุญุฏุฏุฉ
cat logs/noufal_erp.log | jq 'select(.level == "ERROR")'

# ุฅุญุตุงุฆูุงุช ุงูุทูุจุงุช ุญุณุจ ุงููุณุชุฎุฏู
cat logs/noufal_erp_requests.log | jq -r '.user_id' | sort | uniq -c

# ุฃุจุทุฃ 10 ุทูุจุงุช
cat logs/noufal_erp_requests.log | jq -s 'sort_by(.response_time_ms) | reverse | .[:10]'
```

#### ุงุณุชุฎุฏุงู grep ููุจุญุซ:
```bash
# ุงูุจุญุซ ุนู ุฃุฎุทุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
grep "database" logs/noufal_erp_errors.log

# ุงูุจุญุซ ุนู ูุญุงููุงุช ุชุณุฌูู ุฏุฎูู ูุงุดูุฉ
grep "LOGIN.*failed" logs/noufal_erp_audit.log
```

### โ๏ธ ุงูุชุฎุตูุต

ูู `backend/config.py`:

```python
class Config:
    # ุฅุนุฏุงุฏุงุช ุงูุชุณุฌูู
    LOG_DIR = 'logs'
    LOG_LEVEL = 'INFO'  # DEBUG, INFO, WARNING, ERROR, CRITICAL
    LOG_JSON_FORMAT = True
    LOG_MAX_BYTES = 10 * 1024 * 1024  # 10 MB
    LOG_BACKUP_COUNT = 10

class DevelopmentConfig(Config):
    LOG_LEVEL = 'DEBUG'  # ูุณุชูู ุชูุตููู ููุชุทููุฑ

class ProductionConfig(Config):
    LOG_LEVEL = 'INFO'  # ูุณุชูู ููุงุณู ููุฅูุชุงุฌ
    LOG_BACKUP_COUNT = 30  # ุงุญุชูุธ ุจู 30 ูุณุฎุฉ
```

### ๐จ ุงูุฃููุงู ูู ุงููููุณูู

ุนูุฏ ุชูุนูู `enable_console=True`ุ ุณุชุธูุฑ ุงูุณุฌูุงุช ููููุฉ:
- ๐ต **DEBUG** - ุฃุฒุฑู ุณูุงูู
- ๐ข **INFO** - ุฃุฎุถุฑ
- ๐ก **WARNING** - ุฃุตูุฑ
- ๐ด **ERROR** - ุฃุญูุฑ
- ๐ฃ **CRITICAL** - ุจููุณุฌู

### ๐ ููุงุฆุฏ ูุธุงู ุงูุชุณุฌูู

| ุงููุงุฆุฏุฉ | ุงููุตู |
|---------|-------|
| **ุชุชุจุน ุงูุฃุฎุทุงุก** | ูุนุฑูุฉ ูุชู ูุฃูู ุญุฏุซุช ุงูุฃุฎุทุงุก ุจุงูุถุจุท |
| **ุชุญููู ุงูุฃุฏุงุก** | ููุงุณ ุฃููุงุช ุงุณุชุฌุงุจุฉ ุงูุทูุจุงุช |
| **ุงูุฃูุงู** | ุชุชุจุน ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ูุงูุนูููุงุช ุงูุญุณุงุณุฉ |
| **ุงูุชุฏููู** | ุณุฌู ูุงูู ูุฌููุน ุงูุชุบููุฑุงุช ูู ุงููุธุงู |
| **ุงุณุชูุดุงู ุงูุฃุฎุทุงุก** | ูุนูููุงุช ุชูุตูููุฉ ูุญู ุงููุดุงูู |

---

## 4๏ธโฃ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู ููุงุนุฏุฉ ุงูุจูุงูุงุช

### ๐ ุงููุตู

ูุธุงู ูุณุฎ ุงุญุชูุงุทู ุฐูู ูููุฑ:
- **ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู ูููู** ูู ููุช ูุญุฏุฏ
- ุฏุนู **SQLite ู PostgreSQL**
- **ุถุบุท ุชููุงุฆู** ูููุณุฎ ุงูุงุญุชูุงุทูุฉ (gzip)
- **ุฏูุฑุงู ุงููุณุฎ** - ุงูุงุญุชูุงุธ ุจุนุฏุฏ ูุญุฏุฏ
- **ุงุณุชุนุงุฏุฉ ุณููุฉ** ูู ุฃู ูุณุฎุฉ ุงุญุชูุงุทูุฉ
- **ุฌุฏููุฉ ูุชูุฏูุฉ** ูุน APScheduler

### โ๏ธ ุงูููู: `backend/backup.py`

### ๐ ุงูููุฒุงุช

#### ุฃ. ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุฏููุฉ

```python
from backend.backup import DatabaseBackup

# ุฅูุดุงุก ูุฏูุฑ ุงููุณุฎ ุงูุงุญุชูุงุทู
backup_manager = DatabaseBackup(
    database_url='postgresql://user:pass@localhost/noufal_erp',
    backup_dir='backups',      # ูุฌูุฏ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
    max_backups=7,            # ุงูุงุญุชูุงุธ ุจุขุฎุฑ 7 ูุณุฎ
    compress=True             # ุถุบุท ุจู gzip
)

# ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ
backup_info = backup_manager.create_backup(name_prefix="manual")

print(f"ุชู ุฅูุดุงุก ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ: {backup_info.filename}")
print(f"ุงูุญุฌู: {backup_info.size_bytes / 1024:.2f} KB")
print(f"ุงูููุน: {backup_info.database_type}")
```

#### ุจ. ุนุฑุถ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุงููุชุงุญุฉ

```python
# ุนุฑุถ ุฌููุน ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
backups = backup_manager.list_backups()

for backup in backups:
    print(f"ุงูููู: {backup.filename}")
    print(f"ุงูุชุงุฑูุฎ: {backup.timestamp}")
    print(f"ุงูุญุฌู: {backup.size_bytes / (1024*1024):.2f} MB")
    print(f"ูุถุบูุท: {'ูุนู' if backup.compressed else 'ูุง'}")
    print("-" * 50)
```

#### ุฌ. ุงุณุชุนุงุฏุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

```python
# ุงุณุชุนุงุฏุฉ ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุญุฏุฏุฉ
# โ๏ธ ุชุญุฐูุฑ: ุณูุชู ุงุณุชุจุฏุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ!

backup_filename = "backup_20251106_020000.sql.gz"
backup_manager.restore_backup(backup_filename)

print("ุชู ุงุณุชุนุงุฏุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ!")
```

#### ุฏ. ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ

```python
# ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุฏููุฉ
success = backup_manager.delete_backup("backup_20251001_020000.sql.gz")

if success:
    print("ุชู ุญุฐู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ")
```

#### ูู. ุฅุญุตุงุฆูุงุช ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ

```python
# ุงูุญุตูู ุนูู ุฅุญุตุงุฆูุงุช ุดุงููุฉ
stats = backup_manager.get_backup_stats()

print(f"ุฅุฌูุงูู ุงููุณุฎ: {stats['total_backups']}")
print(f"ุงูุญุฌู ุงูููู: {stats['total_size_mb']} MB")
print(f"ุฃูุฏู ูุณุฎุฉ: {stats['oldest_backup']}")
print(f"ุฃุญุฏุซ ูุณุฎุฉ: {stats['newest_backup']}")
```

### โฐ ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ

#### ุฃ. ูุณุฎุฉ ุงุญุชูุงุทูุฉ ููููุฉ

```python
from backend.backup import BackupScheduler

# ุฅูุดุงุก ุฌุฏููุฉ
scheduler = BackupScheduler(backup_manager)

# ุฌุฏููุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ููููุฉ ุงูุณุงุนุฉ 2:00 ุตุจุงุญุงู
scheduler.schedule_daily_backup(hour=2, minute=0)

# ุจุฏุก ุงูุฌุฏููุฉ
scheduler.start()

print("ุชู ุชูุนูู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู ุงููููู")
```

#### ุจ. ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุจูุชุฑุงุช ููุชุธูุฉ

```python
# ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู 6 ุณุงุนุงุช
scheduler.schedule_interval_backup(hours=6)

scheduler.start()
```

#### ุฌ. ุนุฑุถ ุงูููุงู ุงููุฌุฏููุฉ

```python
# ุนุฑุถ ุฌููุน ุงูููุงู ุงููุฌุฏููุฉ
jobs = scheduler.get_jobs()

for job in jobs:
    print(f"ุงููููุฉ: {job['name']}")
    print(f"ุงูููุช ุงูุชุงูู: {job['next_run_time']}")
    print(f"ุงููุดุบู: {job['trigger']}")
```

### ๐ ููุงุท ุงูููุงูุฉ (API Endpoints)

#### 1. ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุฏููุฉ
```bash
POST /api/backup/create
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true,
  "backup": {
    "filename": "backup_20251106_153045.sql.gz",
    "size_mb": 12.45,
    "timestamp": "2025-11-06T15:30:45"
  }
}
```

#### 2. ุนุฑุถ ุฌููุน ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
```bash
GET /api/backup/list
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "backups": [
    {
      "filename": "backup_20251106_020000.sql.gz",
      "size_mb": 11.23,
      "timestamp": "2025-11-06T02:00:00",
      "compressed": true
    },
    {
      "filename": "backup_20251105_020000.sql.gz",
      "size_mb": 10.98,
      "timestamp": "2025-11-05T02:00:00",
      "compressed": true
    }
  ]
}
```

#### 3. ุฅุญุตุงุฆูุงุช ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
```bash
GET /api/backup/stats
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "total_backups": 7,
  "total_size_mb": 78.45,
  "oldest_backup": "2025-10-30T02:00:00",
  "newest_backup": "2025-11-06T02:00:00",
  "backups": [
    {
      "filename": "backup_20251106_020000.sql.gz",
      "size_mb": 11.23,
      "timestamp": "2025-11-06T02:00:00"
    }
  ]
}
```

#### 4. ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ
```bash
DELETE /api/backup/delete/<filename>
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "success": true
}
```

### ๐ ุงูุชูุงูู ูุน Flask

ูู ููู `backend/app.py`:

```python
from flask import Flask
from backend.backup import init_backup

app = Flask(__name__)

# ุฅุนุฏุงุฏุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู (ูู config.py)
app.config['DATABASE_URL'] = 'postgresql://user:pass@localhost/noufal_erp'
app.config['BACKUP_DIR'] = 'backups'
app.config['MAX_BACKUPS'] = 7
app.config['ENABLE_BACKUP_SCHEDULER'] = True
app.config['BACKUP_HOUR'] = 2  # ุงูุณุงุนุฉ 2 ุตุจุงุญุงู
app.config['BACKUP_MINUTE'] = 0

# ุชูุนูู ุงููุณุฎ ุงูุงุญุชูุงุทู
backup_manager = init_backup(app)

# ุงููุณุฎ ุงูุงุญุชูุงุทู ูุชุงุญ ุงูุขู ุนุจุฑ:
# - /api/backup/create
# - /api/backup/list
# - /api/backup/stats
# - /api/backup/delete/<filename>
```

### ๐ ูููู ูุฌูุฏ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ

```
backups/
โโโ backup_20251106_020000.sql.gz  # 11.23 MB
โโโ backup_20251105_020000.sql.gz  # 10.98 MB
โโโ backup_20251104_020000.sql.gz  # 10.85 MB
โโโ backup_20251103_020000.sql.gz  # 10.72 MB
โโโ backup_20251102_020000.sql.gz  # 10.65 MB
โโโ backup_20251101_020000.sql.gz  # 10.54 MB
โโโ backup_20251031_020000.sql.gz  # 10.48 MB

Total: 7 backups, 75.45 MB
```

### ๐ง ูุชุทูุจุงุช ุงููุธุงู

#### ููุงุนุฏุฉ ุจูุงูุงุช PostgreSQL:
```bash
# ูุฌุจ ุชุซุจูุช ุฃุฏูุงุช PostgreSQL
sudo apt install postgresql-client

# ุงูุชุญูู ูู ุงูุชุซุจูุช
pg_dump --version
psql --version
```

#### ููุงุนุฏุฉ ุจูุงูุงุช SQLite:
```bash
# ูุฏูุฌ ูู Python - ูุง ุญุงุฌุฉ ูุชุซุจูุช ุดูุก!
```

### โ๏ธ ุงูุชุฎุตูุต

ูู `backend/config.py`:

```python
class Config:
    # ุฅุนุฏุงุฏุงุช ุงููุณุฎ ุงูุงุญุชูุงุทู
    BACKUP_DIR = 'backups'
    MAX_BACKUPS = 7                      # ุงูุงุญุชูุงุธ ุจุขุฎุฑ 7 ูุณุฎ
    ENABLE_BACKUP_SCHEDULER = True       # ุชูุนูู ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ
    BACKUP_HOUR = 2                      # ุงูุณุงุนุฉ 2 ุตุจุงุญุงู
    BACKUP_MINUTE = 0                    # ุงูุฏูููุฉ 0
    
class ProductionConfig(Config):
    MAX_BACKUPS = 30                     # ุงุญุชูุธ ุจู 30 ูุณุฎุฉ ููุฅูุชุงุฌ
    BACKUP_HOUR = 3                      # ูู ููุช ุฃูู ุงุฒุฏุญุงู
```

### ๐ ุงุณุชุฑุงุชูุฌูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู

#### ุงุณุชุฑุงุชูุฌูุฉ ููุตู ุจูุง:

| ุงูุจูุฆุฉ | ุงูุชูุฑุงุฑ | ุงููุฏุฉ | ุงูุญุฌู ุงููุชููุน |
|--------|---------|-------|---------------|
| **ุงูุชุทููุฑ** | ูุฑุฉ ููููุงู | 7 ุฃูุงู | ุตุบูุฑ |
| **ุงูุงุฎุชุจุงุฑ** | ูุฑุฉ ููููุงู | 14 ููู | ูุชูุณุท |
| **ุงูุฅูุชุงุฌ** | ูุฑุชูู ููููุงู | 30 ููู | ูุจูุฑ |
| **Enterprise** | ูู 6 ุณุงุนุงุช | 90 ููู | ูุจูุฑ ุฌุฏุงู |

#### ุงุณุชุฑุงุชูุฌูุฉ 3-2-1:
- **3** ูุณุฎ ูู ุจูุงูุงุชู
- **2** ููุน ูู ูุณุงุฆุท ุงูุชุฎุฒูู
- **1** ูุณุฎุฉ ุฎุงุฑุฌ ุงููููุน (Cloud)

### ๐จ ุงุณุชุนุงุฏุฉ ุงูุทูุงุฑุฆ

#### ุงูุณููุงุฑูู: ููุฏุงู ุงูุจูุงูุงุช

```bash
# 1. ุฅููุงู ุงูุชุทุจูู
sudo systemctl stop noufal-erp

# 2. ุงุณุชุนุงุฏุฉ ูู ุขุฎุฑ ูุณุฎุฉ ุงุญุชูุงุทูุฉ
cd /home/noufal/ahmednagenoufal
python -c "
from backend.backup import DatabaseBackup
backup = DatabaseBackup('postgresql://...', 'backups')
backups = backup.list_backups()
backup.restore_backup(backups[0].filename)
"

# 3. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู
sudo systemctl start noufal-erp

# 4. ุงูุชุญูู ูู ุงูุจูุงูุงุช
curl http://localhost:5000/api/health
```

### โ ูุงุฆูุฉ ุงูุชุญูู ูู ุงููุณุฎ ุงูุงุญุชูุงุทู

- [ ] ุชู ุชูุนูู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู
- [ ] ุชู ุงุฎุชุจุงุฑ ุนูููุฉ ุงูุงุณุชุนุงุฏุฉ
- [ ] ูุชู ุชุฎุฒูู ุงููุณุฎ ูู ููุงู ุขูู
- [ ] ูุชู ูุฑุงูุจุฉ ูุณุงุญุฉ ุงููุฑุต
- [ ] ุชู ุชูุซูู ุฅุฌุฑุงุกุงุช ุงูุงุณุชุนุงุฏุฉ
- [ ] ูุชู ุงุฎุชุจุงุฑ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุฏูุฑูุงู
- [ ] ุชูุฌุฏ ูุณุฎ ุฎุงุฑุฌ ุงูุฎุงุฏู (offsite)

---

## ๐ฆ ุงูุชุซุจูุช ูุงูุฅุนุฏุงุฏ

### 1. ุชุซุจูุช ุงููุชุทูุจุงุช

```bash
cd /home/noufal/ahmednagenoufal

# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
source venv/bin/activate

# ุชุซุจูุช ุงูููุชุจุงุช ุงูุฌุฏูุฏุฉ
pip install -r requirements.txt
```

### 2. ุฅุนุฏุงุฏ Redis (ุงุฎุชูุงุฑู)

```bash
# ุชุซุจูุช Redis
sudo apt install redis-server -y

# ุชุดุบูู Redis
sudo systemctl start redis-server
sudo systemctl enable redis-server

# ุงุฎุชุจุงุฑ
redis-cli ping  # ูุฌุจ ุฃู ุชุฑู: PONG
```

### 3. ุฅุนุฏุงุฏ ุงูุฅุนุฏุงุฏุงุช

ูู ููู `.env`:

```bash
# ูุฑุงูุจุฉ ุงููุธุงู
ENABLE_MONITORING=true
MONITORING_INTERVAL=60
MONITORING_CPU_THRESHOLD=80.0
MONITORING_RAM_THRESHOLD=85.0
MONITORING_DISK_THRESHOLD=90.0

# ุงูุชุฎุฒูู ุงููุคูุช
USE_REDIS_CACHE=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# ุงูุชุณุฌูู
LOG_DIR=logs
LOG_LEVEL=INFO
LOG_JSON_FORMAT=true

# ุงููุณุฎ ุงูุงุญุชูุงุทู
BACKUP_DIR=backups
MAX_BACKUPS=7
ENABLE_BACKUP_SCHEDULER=true
BACKUP_HOUR=2
BACKUP_MINUTE=0
```

### 4. ุชูุนูู ุงูููุฒุงุช ูู Flask

ูู `backend/app.py`:

```python
from flask import Flask
from backend.monitoring import init_monitoring
from backend.caching import init_cache
from backend.logging_config import init_logging
from backend.backup import init_backup

app = Flask(__name__)

# ุชุญููู ุงูุฅุนุฏุงุฏุงุช
app.config.from_object('backend.config.ProductionConfig')

# ุชูุนูู ุงูุชุณุฌูู ุฃููุงู
init_logging(app)

# ุชูุนูู ุงููุฑุงูุจุฉ
init_monitoring(app)

# ุชูุนูู ุงูุชุฎุฒูู ุงููุคูุช
init_cache(app)

# ุชูุนูู ุงููุณุฎ ุงูุงุญุชูุงุทู
init_backup(app)

# ุงูุขู ุฌููุน ุงูููุฒุงุช ูุดุทุฉ!
```

---

## ๐ ููุญุฉ ุงููุฑุงูุจุฉ

### ุฅูุดุงุก ุตูุญุฉ ูุฑุงูุจุฉ ุจุณูุทุฉ

ูููู ุฅุถุงูุฉ ุตูุญุฉ HTML ุจุณูุทุฉ ููุฑุงูุจุฉ ุงููุธุงู:

```html
<!-- ูู ูุฌูุฏ static/monitoring.html -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ููุญุฉ ุงููุฑุงูุจุฉ - NOUFAL ERP</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .card {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .metric {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .metric:last-child { border-bottom: none; }
        .metric-value {
            font-weight: bold;
            color: #2196F3;
        }
        .status-healthy { color: #4CAF50; }
        .status-warning { color: #FF9800; }
        .status-critical { color: #F44336; }
    </style>
</head>
<body>
    <div class="container">
        <h1>๐ฅ๏ธ ููุญุฉ ูุฑุงูุจุฉ ุงููุธุงู</h1>
        
        <div class="card">
            <h2>๐ ุญุงูุฉ ุงููุธุงู</h2>
            <div id="health-status">ุฌุงุฑู ุงูุชุญููู...</div>
        </div>
        
        <div class="card">
            <h2>๐ป ููุงููุณ ุงูุฃุฏุงุก</h2>
            <div id="metrics">ุฌุงุฑู ุงูุชุญููู...</div>
        </div>
        
        <div class="card">
            <h2>๐พ ุงูุชุฎุฒูู ุงููุคูุช</h2>
            <div id="cache-stats">ุฌุงุฑู ุงูุชุญููู...</div>
        </div>
        
        <div class="card">
            <h2>๐ฆ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ</h2>
            <div id="backup-stats">ุฌุงุฑู ุงูุชุญููู...</div>
        </div>
    </div>
    
    <script>
        // ุชุญุฏูุซ ุงูุจูุงูุงุช ูู 5 ุซูุงูู
        setInterval(updateDashboard, 5000);
        updateDashboard();
        
        async function updateDashboard() {
            // ุตุญุฉ ุงููุธุงู
            const health = await fetch('/api/monitoring/health').then(r => r.json());
            document.getElementById('health-status').innerHTML = `
                <div class="metric">
                    <span>ุงูุญุงูุฉ:</span>
                    <span class="status-${health.status}">${health.status}</span>
                </div>
            `;
            
            // ุงูููุงููุณ
            const metrics = await fetch('/api/monitoring/metrics').then(r => r.json());
            document.getElementById('metrics').innerHTML = `
                <div class="metric">
                    <span>ุงููุนุงูุฌ (CPU):</span>
                    <span class="metric-value">${metrics.cpu_percent}%</span>
                </div>
                <div class="metric">
                    <span>ุงูุฐุงูุฑุฉ (RAM):</span>
                    <span class="metric-value">${metrics.ram_percent}%</span>
                </div>
                <div class="metric">
                    <span>ุงููุฑุต ุงูุตูุจ:</span>
                    <span class="metric-value">${metrics.disk_percent}%</span>
                </div>
            `;
            
            // ุงูุชุฎุฒูู ุงููุคูุช
            const cache = await fetch('/api/cache/stats').then(r => r.json());
            document.getElementById('cache-stats').innerHTML = `
                <div class="metric">
                    <span>ูุนุฏู ุงููุฌุงุญ:</span>
                    <span class="metric-value">${cache.hit_rate}%</span>
                </div>
                <div class="metric">
                    <span>ุฅุฌูุงูู ุงูููุงุชูุญ:</span>
                    <span class="metric-value">${cache.total_keys}</span>
                </div>
            `;
            
            // ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
            const backups = await fetch('/api/backup/stats').then(r => r.json());
            document.getElementById('backup-stats').innerHTML = `
                <div class="metric">
                    <span>ุฅุฌูุงูู ุงููุณุฎ:</span>
                    <span class="metric-value">${backups.total_backups}</span>
                </div>
                <div class="metric">
                    <span>ุงูุญุฌู ุงูููู:</span>
                    <span class="metric-value">${backups.total_size_mb} MB</span>
                </div>
            `;
        }
    </script>
</body>
</html>
```

---

## ๐ ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู 4 ููุฒุงุช ุฃุณุงุณูุฉ ูุชุญุณูู ุงูุฃุฏุงุก ูุงููุฑุงูุจุฉ:

| ุงูููุฒุฉ | ุงูุญุงูุฉ | ุงููุงุฆุฏุฉ ุงูุฑุฆูุณูุฉ |
|--------|--------|------------------|
| **ูุฑุงูุจุฉ CPU/RAM** | โ ุฌุงูุฒ | ูุดู ูุดุงูู ุงูุฃุฏุงุก ูุจูุฑุงู |
| **Caching** | โ ุฌุงูุฒ | ุชุณุฑูุน ุงูุชุทุจูู 100-10000x |
| **Logging** | โ ุฌุงูุฒ | ุชุชุจุน ุงูุฃุฎุทุงุก ูุญููุง ุจุณุฑุนุฉ |
| **Backup** | โ ุฌุงูุฒ | ุญูุงูุฉ ุงูุจูุงูุงุช ูู ุงูููุฏุงู |

### ุงูุฎุทูุงุช ุงูุชุงููุฉ:
1. โ ุงุฎุชุจุงุฑ ูู ููุฒุฉ ุจุดูู ูููุตู
2. โ ุฏูุฌ ุงูููุฒุงุช ูุน ุงูุชุทุจูู
3. โ ูุฑุงูุจุฉ ุงูุฃุฏุงุก ูู ุงูุฅูุชุงุฌ
4. โ ุถุจุท ุงูุฅุนุฏุงุฏุงุช ุญุณุจ ุงูุญุงุฌุฉ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-11-06  
**ุงูุฅุตุฏุงุฑ:** 2.0.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ
